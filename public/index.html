<!DOCTYPE html>
<html lang="en" class="dark">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>JWLimited CDN â€¢ Professional Asset Delivery</title>
		<link rel="icon" href="/assets/applications/icons/jwlimited_developer.png" />
		<script src="https://cdn.tailwindcss.com"></script>
		<style>
			/* Loading Animation System */
			.loading-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: linear-gradient(135deg, 
					rgba(14, 20, 73, 0.12) 0%, 
					rgba(51, 10, 45, 0.18) 37%, 
					rgba(14, 20, 73, 0.15) 67%, 
					rgba(0, 0, 0, 0.1) 100%);
				z-index: 9999;
				opacity: 0;
				visibility: hidden;
				transition: all 0.6s cubic-bezier(0.23, 1, 0.32, 1);
			}

			.loading-overlay.active {
				opacity: 1;
				visibility: visible;
			}

			.loading-bar {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 3px;
				z-index: 10000;
				background: #8b5cf6;
				box-shadow: 0 0 15px rgba(139, 92, 246, 0.6);
				transform: translateX(-100%);
				transition: transform 0.4s ease-out;
			}

			.loading-bar.active {
				animation: loadingProgress 1.8s linear infinite;
			}

			.loading-bar.complete {
				transform: translateX(0%);
				transition: transform 0.5s ease-out;
			}

			.loading-pulse {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 3px;
				background: rgba(139, 92, 246, 0.2);
				z-index: 9998;
				opacity: 0;
				animation: pulseGlow 2s ease-in-out infinite;
			}

			.loading-pulse.active {
				opacity: 1;
			}

			@keyframes loadingProgress {
				0% {
					transform: translateX(-100%);
				}
				100% {
					transform: translateX(100%);
				}
			}

			@keyframes pulseGlow {
				0%, 100% {
					opacity: 0.2;
				}
				50% {
					opacity: 0.4;
				}
			}

			/* Organic loading dots for content areas */
			.loading-dots {
				display: inline-flex;
				align-items: center;
				gap: 4px;
			}

			.loading-dot {
				width: 6px;
				height: 6px;
				border-radius: 50%;
				background: #8b5cf6;
				animation: dotPulse 1.5s ease-in-out infinite both;
			}

			.loading-dot:nth-child(1) { animation-delay: -0.3s; }
			.loading-dot:nth-child(2) { animation-delay: -0.15s; }
			.loading-dot:nth-child(3) { animation-delay: 0s; }

			@keyframes dotPulse {
				0%, 100% {
					transform: scale(0.8);
					opacity: 0.5;
				}
				50% {
					transform: scale(1.2);
					opacity: 1;
				}
			}

			/* Skeleton loading for content */
			.skeleton {
				background: linear-gradient(90deg, 
					rgba(14, 20, 73, 0.3) 0%, 
					rgba(139, 92, 246, 0.15) 25%,
					rgba(168, 85, 247, 0.2) 50%,
					rgba(139, 92, 246, 0.15) 75%,
					rgba(14, 20, 73, 0.3) 100%);
				background-size: 300% 100%;
				animation: skeletonLoading 2s cubic-bezier(0.23, 1, 0.32, 1) infinite;
				border-radius: var(--radius);
			}

			@keyframes skeletonLoading {
				0% {
					background-position: 300% 0;
				}
				100% {
					background-position: -300% 0;
				}
			}

			/* Breathing animation for heavy operations */
			.loading-breathe {
				animation: breathe 3s ease-in-out infinite;
			}

			@keyframes breathe {
				0%, 100% {
					opacity: 0.85;
				}
				50% {
					opacity: 1;
				}
			}

			/* Content fade during loading */
			.content-loading {
				transition: all 0.3s ease-out;
			}

			.content-loading.dimmed {
				opacity: 0.7;
				pointer-events: none;
			}

			:root {
				--background: 0 0% 100%;
				--foreground: 240 10% 3.9%;
				--card: 0 0% 100%;
				--card-foreground: 240 10% 3.9%;
				--popover: 0 0% 100%;
				--popover-foreground: 240 10% 3.9%;
				--primary: 240 5.9% 10%;
				--primary-foreground: 0 0% 98%;
				--secondary: 240 4.8% 95.9%;
				--secondary-foreground: 240 5.9% 10%;
				--muted: 240 4.8% 95.9%;
				--muted-foreground: 240 3.8% 46.1%;
				--accent: 240 4.8% 95.9%;
				--accent-foreground: 240 5.9% 10%;
				--destructive: 0 84.2% 60.2%;
				--destructive-foreground: 0 0% 98%;
				--border: 240 5.9% 90%;
				--input: 240 5.9% 90%;
				--ring: 240 5.9% 10%;
				--radius: 0.5rem;
			}

			.dark {
				--background: 240 10% 3.9%;
				--foreground: 0 0% 98%;
				--card: 240 10% 3.9%;
				--card-foreground: 0 0% 98%;
				--popover: 240 10% 3.9%;
				--popover-foreground: 0 0% 98%;
				--primary: 0 0% 98%;
				--primary-foreground: 240 5.9% 10%;
				--secondary: 240 3.7% 15.9%;
				--secondary-foreground: 0 0% 98%;
				--muted: 240 3.7% 15.9%;
				--muted-foreground: 240 5% 64.9%;
				--accent: 240 3.7% 15.9%;
				--accent-foreground: 0 0% 98%;
				--border: 240 3.7% 15.9%;
				--input: 240 3.7% 15.9%;
				--ring: 240 4.9% 83.9%;
			}

			* {
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}

			body {
				font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
				background: radial-gradient(rgba(0, 0, 0, 0), #000),
					linear-gradient(130deg, #000 0%, #0e1449 37%, #330a2d 51%, #0e1449 67%, #000 100%);
				color: hsl(var(--foreground));
				line-height: 1.5;
				overflow-x: hidden;
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}

			canvas {
				position: absolute;
			}

			.container {
				min-height: 100vh;
				display: flex;
				flex-direction: column;
				justify-content: center;
				align-items: center;
				position: relative;
				padding: 2rem;
			}

			.background-grid {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background-image: linear-gradient(hsl(var(--border)) 1px, transparent 1px),
					linear-gradient(90deg, hsl(var(--border)) 1px, transparent 1px);
				background-size: 50px 50px;
				opacity: 0.3;
				z-index: 0;
			}

			.gradient-orb {
				position: fixed;
				width: 400px;
				height: 400px;
				border-radius: 50%;
				background: linear-gradient(45deg, #3b82f6, #8b5cf6, #06b6d4);
				opacity: 0.1;
				filter: blur(100px);
				z-index: -1;
				animation: float 8s ease-in-out infinite;
			}

			.orb-1 {
				top: 10%;
				left: 10%;
				animation-delay: 0s;
			}

			.orb-2 {
				bottom: 10%;
				right: 10%;
				animation-delay: 4s;
			}

			/* Additional floating blobs */
			.blob-1 {
				position: fixed;
				top: 15%;
				right: 25%;
				width: 200px;
				height: 200px;
				background: radial-gradient(circle, hsl(var(--primary) / 0.06) 0%, transparent 60%);
				border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
				animation: morphBlob 15s ease-in-out infinite;
				pointer-events: none;
				z-index: -1;
			}

			.blob-2 {
				position: fixed;
				bottom: 25%;
				left: 15%;
				width: 250px;
				height: 180px;
				background: radial-gradient(circle, hsl(var(--accent) / 0.05) 0%, transparent 65%);
				border-radius: 30% 70% 70% 30% / 30% 30% 70% 70%;
				animation: morphBlob 18s ease-in-out infinite reverse;
				pointer-events: none;
				z-index: -1;
			}

			.blob-3 {
				position: fixed;
				top: 45%;
				right: 8%;
				width: 150px;
				height: 220px;
				background: radial-gradient(circle, hsl(var(--primary) / 0.04) 0%, transparent 70%);
				border-radius: 70% 30% 50% 50% / 60% 60% 40% 40%;
				animation: morphBlob 12s ease-in-out infinite;
				pointer-events: none;
				z-index: -1;
			}

			.blob-4 {
				position: fixed;
				top: 65%;
				left: 45%;
				width: 180px;
				height: 160px;
				background: radial-gradient(circle, hsl(var(--accent) / 0.03) 0%, transparent 75%);
				border-radius: 40% 60% 60% 40% / 70% 30% 70% 30%;
				animation: morphBlob 20s ease-in-out infinite reverse;
				pointer-events: none;
				z-index: -1;
			}

			.blob-5 {
				position: fixed;
				top: 20%;
				left: 55%;
				width: 120px;
				height: 200px;
				background: radial-gradient(circle, hsl(var(--primary) / 0.035) 0%, transparent 80%);
				border-radius: 50% 50% 80% 20% / 60% 40% 60% 40%;
				animation: morphBlob 16s ease-in-out infinite;
				pointer-events: none;
				z-index: -1;
			}

			.blob-6 {
				position: fixed;
				bottom: 35%;
				right: 35%;
				width: 140px;
				height: 140px;
				background: radial-gradient(circle, hsl(var(--accent) / 0.025) 0%, transparent 85%);
				border-radius: 80% 20% 60% 40% / 40% 80% 20% 60%;
				animation: morphBlob 14s ease-in-out infinite;
				pointer-events: none;
				z-index: -1;
			}

			@keyframes morphBlob {
				0%,
				100% {
					border-radius: 60% 40% 30% 70% / 60% 30% 70% 40%;
					transform: translate(0, 0) rotate(0deg) scale(1);
				}
				20% {
					border-radius: 30% 60% 70% 40% / 50% 60% 30% 60%;
					transform: translate(10px, -15px) rotate(5deg) scale(1.05);
				}
				40% {
					border-radius: 70% 30% 50% 50% / 30% 70% 70% 30%;
					transform: translate(-8px, 12px) rotate(-3deg) scale(0.95);
				}
				60% {
					border-radius: 40% 60% 60% 40% / 70% 30% 70% 30%;
					transform: translate(15px, 8px) rotate(8deg) scale(1.08);
				}
				80% {
					border-radius: 50% 50% 80% 20% / 60% 40% 60% 40%;
					transform: translate(-5px, -10px) rotate(-2deg) scale(0.98);
				}
			}

			@keyframes float {
				0%,
				100% {
					transform: translate(0, 0) rotate(0deg);
				}
				25% {
					transform: translate(30px, -30px) rotate(90deg);
				}
				50% {
					transform: translate(-20px, 20px) rotate(180deg);
				}
				75% {
					transform: translate(-30px, -10px) rotate(270deg);
				}
			}

			.header {
				text-align: center;
				margin-bottom: 3rem;
				animation: fade-in-up 0.8s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.logo {
				font-size: 2.5rem;
				font-weight: 700;
				background: linear-gradient(135deg, #3b82f6, #8b5cf6);
				-webkit-background-clip: text;
				-webkit-text-fill-color: transparent;
				background-clip: text;
				margin-bottom: 0.5rem;
				letter-spacing: -0.02em;
			}

			.tagline {
				color: hsl(var(--muted-foreground));
				font-size: 1.1rem;
				font-weight: 400;
				letter-spacing: -0.01em;
			}

			.search-container {
				width: 100%;
				max-width: 600px;
				position: relative;
				animation: fade-in-up 0.8s cubic-bezier(0.4, 0, 0.2, 1) 0.2s both;
			}

			.search-wrapper {
				position: relative;
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.search-wrapper:focus-within {
				border-color: hsl(var(--ring));
				box-shadow: 0 0 0 3px hsl(var(--ring) / 0.1);
				transform: translateY(-1px);
			}

			.search-input {
				width: 100%;
				padding: 1rem 3rem 1rem 3rem;
				font-size: 1.1rem;
				background: transparent;
				border: none;
				outline: none;
				color: hsl(var(--foreground));
				font-weight: 400;
			}

			.search-input::placeholder {
				color: hsl(var(--muted-foreground));
			}

			.search-icon {
				position: absolute;
				left: 1rem;
				top: 50%;
				transform: translateY(-50%);
				width: 1.25rem;
				height: 1.25rem;
				color: hsl(var(--muted-foreground));
				transition: all 0.3s ease;
			}

			.search-wrapper:focus-within .search-icon {
				color: hsl(var(--primary));
				transform: translateY(-50%) scale(1.1);
			}

			.loading-spinner {
				position: absolute;
				right: 1rem;
				top: 50%;
				transform: translateY(-50%);
				width: 1.25rem;
				height: 1.25rem;
				border: 2px solid hsl(var(--border));
				border-top: 2px solid hsl(var(--primary));
				border-radius: 50%;
				animation: spin 1s linear infinite;
				opacity: 0;
				transition: opacity 0.3s ease;
			}

			.loading-spinner.active {
				opacity: 1;
			}

			@keyframes spin {
				0% {
					transform: translateY(-50%) rotate(0deg);
				}
				100% {
					transform: translateY(-50%) rotate(360deg);
				}
			}

			.upload-btn {
				position: absolute;
				right: 0.5rem;
				top: 50%;
				transform: translateY(-50%);
				width: 2.5rem;
				height: 2.5rem;
				border: none;
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border-radius: calc(var(--radius) - 2px);
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
				opacity: 0.8;
				z-index: 3;
			}

			.upload-btn:hover {
				opacity: 1;
				transform: translateY(-50%) scale(1.05);
				background: hsl(var(--primary) / 0.9);
			}

			.upload-btn svg {
				width: 1.25rem;
				height: 1.25rem;
			}

			.document-btn {
				position: absolute;
				right: 3.5rem;
				top: 50%;
				transform: translateY(-50%);
				width: 2.5rem;
				height: 2.5rem;
				border: none;
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border-radius: calc(var(--radius) - 2px);
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
				opacity: 0.8;
				z-index: 3;
			}

			.document-btn:hover {
				opacity: 1;
				transform: translateY(-50%) scale(1.05);
				background: hsl(var(--primary) / 0.9);
			}

			.document-btn svg {
				width: 1.25rem;
				height: 1.25rem;
			}

			.results-container {
				margin-top: 2rem;
				width: 100%;
				max-width: 800px;
				opacity: 0;
				transform: translateY(20px);
				transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.results-container.show {
				opacity: 1;
				transform: translateY(0);
			}

			.results-grid {
				display: grid;
				grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
				gap: 1rem;
			}

			.result-card {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1.5rem;
				transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
				cursor: pointer;
				position: relative;
				overflow: hidden;
			}

			.result-card::before {
				content: '';
				position: absolute;
				top: 0;
				left: -100%;
				width: 100%;
				height: 100%;
				background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
				transition: left 0.5s ease;
			}

			.result-card:hover {
				border-color: hsl(var(--ring));
				transform: translateY(-2px);
				box-shadow: 0 8px 25px -5px rgba(0, 0, 0, 0.1), 0 4px 10px -3px rgba(0, 0, 0, 0.05);
			}

			.result-card:hover::before {
				left: 100%;
			}

			.result-icon {
				width: 2.5rem;
				height: 2.5rem;
				border-radius: var(--radius);
				background: hsl(var(--secondary));
				display: flex;
				align-items: center;
				justify-content: center;
				margin-bottom: 1rem;
				color: hsl(var(--primary));
			}

			.result-title {
				font-size: 1rem;
				font-weight: 600;
				margin-bottom: 0.5rem;
				color: hsl(var(--foreground));
			}

			.result-path {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
				font-family: 'SF Mono', Monaco, 'Cascadia Code', 'Roboto Mono', Consolas, 'Courier New', monospace;
				margin-bottom: 0.5rem;
			}

			.result-meta {
				display: flex;
				gap: 0.5rem;
				flex-wrap: wrap;
			}

			.result-tag {
				padding: 0.125rem 0.5rem;
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
			}

			.footer {
				position: fixed;
				bottom: 2rem;
				left: 50%;
				transform: translateX(-50%);
				text-align: center;
				color: hsl(var(--muted-foreground));
				font-size: 0.875rem;
				animation: fade-in 1s cubic-bezier(0.4, 0, 0.2, 1) 1s both;
			}

			.footer-links {
				display: flex;
				gap: 1rem;
				justify-content: center;
				margin-bottom: 0.5rem;
			}

			.footer-link {
				color: hsl(var(--muted-foreground));
				text-decoration: none;
				transition: color 0.3s ease;
			}

			.footer-link:hover {
				color: hsl(var(--primary));
			}

			/* Top Navigation */
			.top-nav {
				z-index: 100;
				position: fixed;
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1rem 0;
				border-bottom: 1px solid hsl(var(--border) / 0.1);
				margin-bottom: 2rem;
				right: 28px;
				top: 15px;
			}

			.nav-left {
				display: flex;
				align-items: center;
			}

			.nav-right {
				display: flex;
				align-items: center;
			}

			/* Authentication Styles */
			.auth-container {
				display: flex;
				align-items: center;
			}

			.auth-actions {
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.auth-btn {
				display: inline-flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.5rem 1rem;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.875rem;
				font-weight: 500;
				transition: all 0.2s ease;
				cursor: pointer;
				border: none;
				text-decoration: none;
			}

			.auth-btn-ghost {
				background: transparent;
				color: hsl(var(--foreground));
				border: 1px solid transparent;
			}

			.auth-btn-ghost:hover {
				background: hsl(var(--accent));
				color: hsl(var(--accent-foreground));
			}

			.auth-btn-primary {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.auth-btn-primary:hover {
				background: hsl(var(--primary) / 0.9);
			}

			/* User Menu */
			.user-menu {
				position: relative;
			}

			.user-trigger {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.5rem;
				border-radius: calc(var(--radius) - 2px);
				background: transparent;
				border: 1px solid transparent;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.user-trigger:hover {
				background: hsl(var(--accent));
			}

			.user-avatar {
				width: 2rem;
				height: 2rem;
				border-radius: 50%;
				background: hsl(var(--primary));
				display: flex;
				align-items: center;
				justify-content: center;
				font-weight: 600;
				font-size: 0.75rem;
				color: hsl(var(--primary-foreground));
			}

			.user-info {
				display: flex;
				flex-direction: column;
				align-items: flex-start;
				gap: 0.125rem;
			}

			.username {
				font-weight: 500;
				color: hsl(var(--foreground));
				font-size: 0.875rem;
				line-height: 1;
			}

			.user-role {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				text-transform: capitalize;
				line-height: 1;
			}

			.user-dropdown {
				position: absolute;
				top: 100%;
				right: 0;
				margin-top: 0.5rem;
				background: hsl(var(--popover));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
				min-width: 200px;
				opacity: 0;
				visibility: hidden;
				transform: translateY(-8px);
				transition: all 0.2s ease;
				z-index: 50;
			}

			.user-dropdown.show {
				opacity: 1;
				visibility: visible;
				transform: translateY(0);
			}

			.dropdown-item {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.75rem 1rem;
				font-size: 0.875rem;
				color: hsl(var(--foreground));
				cursor: pointer;
				transition: background-color 0.2s ease;
			}

			.dropdown-item:hover {
				background: hsl(var(--accent));
			}

			.dropdown-divider {
				height: 1px;
				background: hsl(var(--border));
				margin: 0.25rem 0;
			}

			/* Auth Modal Styles */
			.auth-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1000;
				opacity: 0;
				visibility: hidden;
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				pointer-events: none;
			}

			.auth-modal.show {
				opacity: 1;
				visibility: visible;
				pointer-events: all;
			}

			.auth-modal .modal-backdrop {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				backdrop-filter: blur(0px);
			}

			.auth-modal.show .modal-backdrop {
				background: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(8px);
			}

			.auth-modal .modal-background-content {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				transform: scale(1) translateY(0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				border-radius: 0;
				overflow: hidden;
			}

			.auth-modal.show .modal-background-content {
				transform: scale(0.92) translateY(-20px);
				border-radius: 16px;
				filter: brightness(0.7);
			}

			.auth-modal-content {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				height: 92%;
				background: hsl(var(--background));
				border-radius: 20px 20px 0 0;
				transform: translateY(100%);
				transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				display: flex;
				flex-direction: column;
				box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.3);
			}

			.auth-modal.show .auth-modal-content {
				transform: translateY(0);
			}

			.auth-modal-wrapper {
				flex: 1;
				overflow-y: auto;
				padding: 2rem;
				max-width: 400px;
				margin: 0 auto;
				width: 100%;
			}

			.auth-modal-header {
				position: relative;
				text-align: center;
				margin-bottom: 3rem;
			}

			.auth-close-btn {
				position: absolute;
				top: -0.5rem;
				right: -0.5rem;
				width: 2.5rem;
				height: 2.5rem;
				border-radius: 50%;
				background: hsl(var(--secondary));
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
			}

			.auth-close-btn:hover {
				background: hsl(var(--secondary) / 0.8);
				color: hsl(var(--foreground));
			}

			.auth-header-content {
				margin-top: 1rem;
			}

			.auth-modal-title {
				font-size: 2rem;
				font-weight: 700;
				color: hsl(var(--foreground));
				margin-bottom: 0.5rem;
				letter-spacing: -0.025em;
			}

			.auth-modal-subtitle {
				color: hsl(var(--muted-foreground));
				font-size: 1rem;
			}

			.auth-modal-body {
				flex: 1;
			}

			.auth-form {
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
			}

			.auth-form-group {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
			}

			.auth-form-label {
				font-weight: 500;
				color: hsl(var(--foreground));
				font-size: 0.875rem;
			}

			.auth-form-input {
				padding: 0.875rem 1rem;
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--background));
				color: hsl(var(--foreground));
				font-size: 1rem;
				transition: all 0.2s ease;
			}

			.auth-form-input:focus {
				outline: none;
				border-color: hsl(var(--ring));
				box-shadow: 0 0 0 3px hsl(var(--ring) / 0.1);
			}

			.auth-form-input::placeholder {
				color: hsl(var(--muted-foreground));
			}

			.auth-form-actions {
				margin-top: 1rem;
			}

			.auth-submit-btn {
				width: 100%;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.5rem;
				padding: 0.875rem 1rem;
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 1rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.auth-submit-btn:hover:not(:disabled) {
				background: hsl(var(--primary) / 0.9);
			}

			.auth-submit-btn:disabled {
				opacity: 0.6;
				cursor: not-allowed;
			}

			.auth-btn-loading svg {
				animation: spin 1s linear infinite;
			}

			@keyframes spin {
				from { transform: rotate(0deg); }
				to { transform: rotate(360deg); }
			}

			.auth-form-switch {
				text-align: center;
				margin-top: 2rem;
				padding-top: 2rem;
				border-top: 1px solid hsl(var(--border));
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.auth-switch-btn {
				background: none;
				border: none;
				color: hsl(var(--primary));
				cursor: pointer;
				font-weight: 500;
				text-decoration: none;
				transition: color 0.2s ease;
			}

			.auth-switch-btn:hover {
				color: hsl(var(--primary) / 0.8);
			}

			.auth-error {
				color: hsl(var(--destructive));
				font-size: 0.875rem;
				padding: 0.75rem;
				background: hsl(var(--destructive) / 0.1);
				border: 1px solid hsl(var(--destructive) / 0.2);
				border-radius: calc(var(--radius) - 2px);
				margin-bottom: 1rem;
			}

			.auth-success {
				color: hsl(var(--primary));
				font-size: 0.875rem;
				padding: 0.75rem;
				background: hsl(var(--primary) / 0.1);
				border: 1px solid hsl(var(--primary) / 0.2);
				border-radius: calc(var(--radius) - 2px);
				margin-bottom: 1rem;
			}

			/* User Dashboard Modal */
			.dashboard-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1000;
				opacity: 0;
				visibility: hidden;
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				pointer-events: none;
			}

			.dashboard-modal.show {
				opacity: 1;
				visibility: visible;
				pointer-events: all;
			}

			.dashboard-modal .modal-backdrop {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				backdrop-filter: blur(0px);
			}

			.dashboard-modal.show .modal-backdrop {
				background: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(8px);
			}

			.dashboard-modal .modal-background-content {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				transform: scale(1) translateY(0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				border-radius: 0;
				overflow: hidden;
			}

			.dashboard-modal.show .modal-background-content {
				transform: scale(0.92) translateY(-20px);
				border-radius: 16px;
				filter: brightness(0.7);
			}

			.dashboard-modal-content {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				height: 92%;
				background: hsl(var(--background));
				border-radius: 20px 20px 0 0;
				transform: translateY(100%);
				transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				display: flex;
				flex-direction: column;
				box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.3);
			}

			.dashboard-modal.show .dashboard-modal-content {
				transform: translateY(0);
			}

			.modal-handle {
				width: 2rem;
				height: 0.25rem;
				background: hsl(var(--muted-foreground) / 0.3);
				border-radius: 0.125rem;
				margin: 0.75rem auto 0;
				flex-shrink: 0;
			}

			.dashboard-wrapper {
				flex: 1;
				overflow: hidden;
				display: flex;
				flex-direction: column;
			}

			.dashboard-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 2rem 2rem 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				flex-shrink: 0;
			}

			.dashboard-header-left {
				display: flex;
				align-items: center;
				gap: 1rem;
			}

			.dashboard-title-section {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
			}

			.dashboard-title {
				font-size: 2rem;
				font-weight: 700;
				color: hsl(var(--foreground));
				line-height: 1.2;
				letter-spacing: -0.025em;
			}

			.dashboard-subtitle {
				color: hsl(var(--muted-foreground));
				font-size: 0.875rem;
			}

			.dashboard-header-right {
				display: flex;
				align-items: center;
				gap: 1rem;
			}

			.dashboard-close-btn {
				width: 2.5rem;
				height: 2.5rem;
				border-radius: 50%;
				background: hsl(var(--secondary));
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
			}

			.dashboard-close-btn:hover {
				background: hsl(var(--secondary) / 0.8);
				color: hsl(var(--foreground));
			}

			.dashboard-content {
				flex: 1;
				overflow-y: auto;
				padding: 2rem 2rem;
				display: flex;
				flex-direction: column;
				gap: 2rem;
			}

			.dashboard-section {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.section-header {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
			}

			.section-title {
				font-size: 1.125rem;
				font-weight: 600;
				color: hsl(var(--foreground));
			}

			.section-subtitle {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.dashboard-stats {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
				gap: 1rem;
			}

			.stat-card {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				padding: 1.5rem;
				transition: all 0.2s ease;
			}

			.stat-card:hover {
				border-color: hsl(var(--border) / 0.8);
				box-shadow: 0 2px 8px hsl(var(--foreground) / 0.04);
			}

			.stat-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 0.75rem;
			}

			.stat-title {
				font-size: 0.875rem;
				font-weight: 500;
				color: hsl(var(--muted-foreground));
			}

			.stat-icon {
				width: 1rem;
				height: 1rem;
				color: hsl(var(--muted-foreground));
			}

			.stat-value {
				font-size: 2rem;
				font-weight: 700;
				color: hsl(var(--foreground));
				line-height: 1;
				margin-bottom: 0.5rem;
			}

			.stat-description {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				margin-bottom: 0.75rem;
			}

			.quota-bar {
				width: 100%;
				height: 6px;
				background: hsl(var(--secondary));
				border-radius: 3px;
				overflow: hidden;
			}

			.quota-fill {
				height: 100%;
				background: hsl(var(--primary));
				transition: width 0.3s ease;
				border-radius: 3px;
			}

			.quota-fill.warning {
				background: hsl(var(--destructive));
			}

			.quota-fill.success {
				background: hsl(var(--primary));
			}

			/* Storage Visualization Styles */
			.storage-visualization {
				margin-top: 0.75rem;
			}

			.storage-breakdown {
				display: flex;
				flex-direction: column;
				gap: 0.5rem;
				margin-bottom: 0.5rem;
			}

			.storage-breakdown-item {
				display: flex;
				justify-content: space-between;
				align-items: center;
				font-size: 0.75rem;
			}

			.storage-label {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				font-weight: 500;
			}

			.storage-color-dot {
				width: 8px;
				height: 8px;
				border-radius: 50%;
				flex-shrink: 0;
			}

			.storage-amount {
				font-weight: 600;
				color: hsl(var(--foreground));
			}

			.storage-bar {
				width: 100%;
				height: 6px;
				background: hsl(var(--muted));
				border-radius: 3px;
				overflow: hidden;
				display: flex;
				margin-bottom: 0.5rem;
			}

			.storage-segment {
				height: 100%;
				transition: width 0.3s ease;
			}

			.storage-summary {
				display: flex;
				justify-content: space-between;
				font-size: 0.625rem;
				color: hsl(var(--muted-foreground));
			}

			.storage-used {
				font-weight: 600;
			}

			.storage-available {
				opacity: 0.8;
			}

			/* Dashboard Table */
			.dashboard-table-container {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				overflow: hidden;
			}

			.dashboard-table {
				width: 100%;
			}

			.table-header {
				display: grid;
				grid-template-columns: 1fr auto auto auto;
				gap: 1rem;
				padding: 1rem 1.5rem;
				background: hsl(var(--muted) / 0.3);
				border-bottom: 1px solid hsl(var(--border));
				font-size: 0.75rem;
				font-weight: 600;
				color: hsl(var(--muted-foreground));
				text-transform: uppercase;
				letter-spacing: 0.05em;
			}

			.table-row {
				display: grid;
				grid-template-columns: 1fr auto auto auto;
				gap: 1rem;
				padding: 1rem 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				transition: background-color 0.2s ease;
				align-items: center;
			}

			.table-row:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.table-row:last-child {
				border-bottom: none;
			}

			.table-cell {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 1rem;
			}

			.file-info {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
				min-width: 0;
			}

			.file-name {
				font-size: 0.875rem;
				font-weight: 500;
				color: hsl(var(--foreground));
				truncate: true;
			}

			.file-path {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				font-family: monospace;
				truncate: true;
			}

			.file-size {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
				font-weight: 500;
			}

			.file-date {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.file-actions {
				display: flex;
				gap: 0.5rem;
			}

			.action-btn {
				display: inline-flex;
				align-items: center;
				justify-content: center;
				width: 32px;
				height: 32px;
				border: none;
				border-radius: calc(var(--radius) - 2px);
				cursor: pointer;
				transition: all 0.2s ease;
				font-size: 0;
			}

			.action-btn svg {
				width: 16px;
				height: 16px;
			}

			.action-btn-secondary {
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
			}

			.action-btn-secondary:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.action-btn-primary {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.action-btn-primary:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.action-btn-danger {
				background: hsl(var(--destructive));
				color: hsl(var(--destructive-foreground));
			}

			.action-btn-danger:hover {
				background: hsl(var(--destructive) / 0.9);
			}

			/* File Info Modal */
			.file-info-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 10000;
				display: flex;
				align-items: center;
				justify-content: center;
				opacity: 0;
				visibility: hidden;
				transition: all 0.3s ease;
			}

			.file-info-modal.show {
				opacity: 1;
				visibility: visible;
			}

			.file-info-modal .modal-backdrop {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				backdrop-filter: blur(4px);
			}

			.file-info-modal .modal-content {
				position: relative;
				background: hsl(var(--background));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				max-width: 500px;
				width: 90%;
				max-height: 80vh;
				overflow-y: auto;
				box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
			}

			.file-info-modal .modal-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.file-info-modal .modal-header h3 {
				margin: 0;
				font-size: 1.25rem;
				font-weight: 600;
				color: hsl(var(--foreground));
			}

			.file-info-modal .modal-close {
				background: none;
				border: none;
				color: hsl(var(--muted-foreground));
				cursor: pointer;
				padding: 0.5rem;
				border-radius: calc(var(--radius) - 2px);
				transition: all 0.2s ease;
			}

			.file-info-modal .modal-close:hover {
				background: hsl(var(--muted) / 0.1);
				color: hsl(var(--foreground));
			}

			.file-info-modal .modal-body {
				padding: 1.5rem;
			}

			.file-details {
				margin-bottom: 1.5rem;
			}

			.detail-row {
				display: flex;
				justify-content: space-between;
				align-items: flex-start;
				padding: 0.75rem 0;
				border-bottom: 1px solid hsl(var(--border));
			}

			.detail-row:last-child {
				border-bottom: none;
			}

			.detail-label {
				font-weight: 500;
				color: hsl(var(--muted-foreground));
				min-width: 100px;
			}

			.detail-value {
				color: hsl(var(--foreground));
				text-align: right;
				flex: 1;
				margin-left: 1rem;
			}

			.action-btn {
				padding: 0.375rem 0.75rem;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
				border: none;
				text-decoration: none;
			}

			.action-btn-primary {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.action-btn-primary:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.action-btn-secondary {
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
			}

			.action-btn-secondary:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.empty-state {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				padding: 3rem 1rem;
				text-align: center;
				color: hsl(var(--muted-foreground));
			}

			.empty-state-icon {
				width: 3rem;
				height: 3rem;
				margin-bottom: 1rem;
				opacity: 0.5;
			}

			.empty-state-title {
				font-size: 1rem;
				font-weight: 500;
				margin-bottom: 0.5rem;
				color: hsl(var(--foreground));
			}

			.empty-state-description {
				font-size: 0.875rem;
			}

			/* Status Modal Styles */
			.status-grid {
				display: grid;
				grid-template-columns: 1fr 1fr;
				gap: 2rem;
				height: 100%;
			}

			.status-section {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.network-map-container {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				padding: 1.5rem;
				height: 400px;
				position: relative;
				overflow: hidden;
			}

			.network-map {
				width: 100%;
				height: 100%;
				background:
					radial-gradient(circle at 30% 40%, hsl(var(--primary) / 0.15) 0%, transparent 50%),
					radial-gradient(circle at 70% 60%, hsl(var(--primary) / 0.1) 0%, transparent 50%),
					linear-gradient(180deg, hsl(var(--muted) / 0.1) 0%, hsl(var(--card)) 100%);
				position: relative;
				border-radius: var(--radius);
				overflow: hidden;
			}

			.world-map-svg {
				position: absolute;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%);
				width: 90%;
				height: 80%;
				opacity: 0.3;
				fill: hsl(var(--muted-foreground) / 0.2);
				stroke: hsl(var(--border));
				stroke-width: 0.5;
			}

			.network-point {
				position: absolute;
				width: 8px;
				height: 8px;
				background: hsl(var(--primary));
				border-radius: 50%;
				animation: pulse 2s infinite;
				cursor: pointer;
			}

			.network-point::before {
				content: '';
				position: absolute;
				top: -4px;
				left: -4px;
				width: 16px;
				height: 16px;
				background: hsl(var(--primary) / 0.3);
				border-radius: 50%;
				animation: ping 2s infinite;
			}

			.network-point.online {
				background: hsl(142, 76%, 36%);
			}

			.network-point.degraded {
				background: hsl(48, 96%, 53%);
			}

			.network-point.offline {
				background: hsl(var(--destructive));
			}

			.network-tooltip {
				position: absolute;
				background: hsl(var(--popover));
				color: hsl(var(--popover-foreground));
				padding: 0.5rem 0.75rem;
				border-radius: var(--radius);
				font-size: 0.75rem;
				border: 1px solid hsl(var(--border));
				box-shadow: 0 4px 12px hsl(var(--foreground) / 0.1);
				z-index: 10;
				pointer-events: none;
				opacity: 0;
				transition: opacity 0.2s ease;
			}

			.network-point:hover + .network-tooltip {
				opacity: 1;
			}

			@keyframes pulse {
				0%, 100% { opacity: 1; }
				50% { opacity: 0.5; }
			}

			@keyframes ping {
				0% { transform: scale(1); opacity: 1; }
				75%, 100% { transform: scale(2); opacity: 0; }
			}

			/* API Modal Styles */
			.api-sections {
				display: flex;
				flex-direction: column;
				gap: 2rem;
			}

			.api-section {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				overflow: hidden;
			}

			.api-section-header {
				padding: 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				background: hsl(var(--muted) / 0.3);
			}

			.api-section-title {
				font-size: 1.125rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin-bottom: 0.25rem;
			}

			.api-section-description {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.api-endpoints {
				padding: 0;
			}

			.api-endpoint {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1rem 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				transition: background-color 0.2s ease;
			}

			.api-endpoint:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.api-endpoint:last-child {
				border-bottom: none;
			}

			.api-endpoint-info {
				display: flex;
				align-items: center;
				gap: 1rem;
				flex: 1;
			}

			.api-method {
				padding: 0.25rem 0.5rem;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 600;
				text-transform: uppercase;
				min-width: 60px;
				text-align: center;
			}

			.api-method.get {
				background: hsl(142, 76%, 36% / 0.1);
				color: hsl(142, 76%, 36%);
			}

			.api-method.post {
				background: hsl(221, 83%, 53% / 0.1);
				color: hsl(221, 83%, 53%);
			}

			.api-method.put {
				background: hsl(48, 96%, 53% / 0.1);
				color: hsl(48, 96%, 53%);
			}

			.api-method.delete {
				background: hsl(var(--destructive) / 0.1);
				color: hsl(var(--destructive));
			}

			.api-endpoint-details {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
				flex: 1;
			}

			.api-endpoint-path {
				font-family: monospace;
				font-size: 0.875rem;
				color: hsl(var(--foreground));
				font-weight: 500;
			}

			.api-endpoint-description {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
			}

			.api-endpoint-actions {
				display: flex;
				gap: 0.5rem;
			}

			.api-try-btn {
				padding: 0.375rem 0.75rem;
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.api-try-btn:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.api-copy-btn {
				padding: 0.375rem 0.75rem;
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.api-copy-btn:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			/* Dev Tools Styles */
			.devtools-sections {
				display: flex;
				flex-direction: column;
				gap: 2rem;
			}

			.devtools-section {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				overflow: hidden;
			}

			.devtools-section-header {
				padding: 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				background: hsl(var(--muted) / 0.3);
				display: flex;
				align-items: center;
				justify-content: space-between;
			}

			.devtools-section-title {
				font-size: 1.125rem;
				font-weight: 600;
				color: hsl(var(--foreground));
			}

			.devtools-refresh-btn {
				padding: 0.375rem 0.75rem;
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.devtools-refresh-btn:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.devtools-content {
				padding: 1.5rem;
			}

			.devtools-json {
				background: hsl(var(--muted) / 0.3);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
				font-family: monospace;
				font-size: 0.875rem;
				max-height: 300px;
				overflow-y: auto;
				white-space: pre-wrap;
				word-break: break-all;
			}

			.json-key {
				color: hsl(221, 83%, 53%);
				font-weight: 600;
			}

			.json-string {
				color: hsl(142, 76%, 36%);
			}

			.json-number {
				color: hsl(48, 96%, 53%);
			}

			.json-boolean {
				color: hsl(var(--destructive));
			}

			.json-null {
				color: hsl(var(--muted-foreground));
				font-style: italic;
			}

			.devtools-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
				gap: 1rem;
			}

			.devtools-metric {
				background: hsl(var(--muted) / 0.1);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
			}

			.devtools-metric-title {
				font-size: 0.875rem;
				font-weight: 500;
				color: hsl(var(--muted-foreground));
				margin-bottom: 0.5rem;
			}

			.devtools-metric-value {
				font-size: 1.25rem;
				font-weight: 700;
				color: hsl(var(--foreground));
			}

			/* DevTools Console Styles */
			.devtools-tabs {
				display: flex;
				gap: 0.5rem;
			}

			.devtools-tab {
				padding: 0.375rem 0.75rem;
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.devtools-tab:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.devtools-tab.active {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.devtools-panel {
				display: none;
				height: 400px;
				overflow: hidden;
			}

			.devtools-panel.active {
				display: block;
			}

			.console-output {
				height: 350px;
				overflow-y: auto;
				background: hsl(var(--muted) / 0.1);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
				font-family: monospace;
				font-size: 0.875rem;
				margin-bottom: 1rem;
			}

			.console-line {
				display: flex;
				gap: 0.5rem;
				margin-bottom: 0.25rem;
				align-items: flex-start;
			}

			.console-timestamp {
				color: hsl(var(--muted-foreground));
				font-size: 0.75rem;
				min-width: 80px;
			}

			.console-message {
				flex: 1;
				white-space: pre-wrap;
				word-break: break-all;
			}

			.console-line.console-command .console-message {
				color: hsl(var(--foreground));
				font-weight: 500;
			}

			.console-line.console-result .console-message {
				color: hsl(142, 76%, 36%);
			}

			.console-line.console-error .console-message {
				color: hsl(var(--destructive));
			}

			.console-line.console-warn .console-message {
				color: hsl(48, 96%, 53%);
			}

			.console-line.console-info .console-message {
				color: hsl(221, 83%, 53%);
			}

			.console-input-container {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 0.5rem;
			}

			.console-prompt {
				color: hsl(var(--muted-foreground));
				font-family: monospace;
				font-weight: 600;
			}

			.console-input {
				flex: 1;
				background: transparent;
				border: none;
				outline: none;
				font-family: monospace;
				font-size: 0.875rem;
				color: hsl(var(--foreground));
			}

			/* Network Panel Styles */
			.network-requests {
				height: 400px;
				overflow-y: auto;
			}

			.network-header, .network-row {
				display: grid;
				grid-template-columns: 2fr 80px 120px 80px 80px;
				gap: 1rem;
				padding: 0.5rem 1rem;
				border-bottom: 1px solid hsl(var(--border));
				align-items: center;
			}

			.network-header {
				background: hsl(var(--muted) / 0.3);
				font-weight: 600;
				font-size: 0.75rem;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: hsl(var(--muted-foreground));
			}

			.network-row:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.network-col {
				font-size: 0.875rem;
				color: hsl(var(--foreground));
			}

			.network-status-2 {
				color: hsl(142, 76%, 36%);
				font-weight: 600;
			}

			.network-status-3 {
				color: hsl(221, 83%, 53%);
				font-weight: 600;
			}

			.network-status-4, .network-status-5 {
				color: hsl(var(--destructive));
				font-weight: 600;
			}

			.network-status-error {
				color: hsl(var(--destructive));
				font-weight: 600;
			}

			/* Storage Panel Styles */
			.storage-sections {
				height: 400px;
				overflow-y: auto;
				display: flex;
				flex-direction: column;
				gap: 1.5rem;
			}

			.storage-section h3 {
				font-size: 1rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin-bottom: 0.75rem;
			}

			.storage-table {
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				overflow: hidden;
			}

			.storage-header, .storage-row {
				display: grid;
				grid-template-columns: 200px 1fr 100px;
				gap: 1rem;
				padding: 0.75rem 1rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.storage-header {
				background: hsl(var(--muted) / 0.3);
				font-weight: 600;
				font-size: 0.75rem;
				text-transform: uppercase;
				letter-spacing: 0.05em;
				color: hsl(var(--muted-foreground));
			}

			.storage-row:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.storage-row:last-child {
				border-bottom: none;
			}

			.storage-key {
				font-family: monospace;
				font-weight: 500;
				color: hsl(var(--foreground));
			}

			.storage-value {
				font-family: monospace;
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
				word-break: break-all;
			}

			.storage-size {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			/* CDN Trace Details Styles */
			.trace-details {
				grid-column: 1 / -1;
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 2px);
				overflow: hidden;
				margin-top: 1rem;
			}

			.trace-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1rem 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				background: hsl(var(--muted) / 0.3);
			}

			.trace-title {
				font-size: 1rem;
				font-weight: 600;
				color: hsl(var(--foreground));
			}

			.trace-refresh-btn {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				padding: 0.375rem 0.75rem;
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border: none;
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.trace-refresh-btn:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.trace-grid {
				display: grid;
				grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
				gap: 1px;
				background: hsl(var(--border));
			}

			.trace-item {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
				padding: 0.75rem 1rem;
				background: hsl(var(--card));
			}

			.trace-key {
				font-size: 0.75rem;
				font-weight: 500;
				color: hsl(var(--muted-foreground));
				text-transform: uppercase;
				letter-spacing: 0.05em;
			}

			.trace-value {
				font-family: monospace;
				font-size: 0.875rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				word-break: break-all;
			}

			/* Mobile Responsive Dashboard */
			@media (max-width: 768px) {
				.dashboard-header {
					padding: 1.5rem 1rem 1rem;
				}

				.dashboard-title {
					font-size: 1.5rem;
				}

				.dashboard-content {
					padding: 1rem 1rem;
				}

				.dashboard-stats {
					grid-template-columns: 1fr;
				}

				.status-grid {
					grid-template-columns: 1fr;
				}

				.network-map-container {
					height: 300px;
				}

				.table-header {
					display: none;
				}

				.table-row {
					grid-template-columns: 1fr;
					gap: 0.5rem;
					padding: 1rem;
					border-radius: calc(var(--radius) + 2px);
					margin-bottom: 0.5rem;
					background: hsl(var(--muted) / 0.1);
				}

				.table-row:hover {
					background: hsl(var(--muted) / 0.2);
				}

				.table-cell {
					justify-content: space-between;
				}

				.file-info {
					flex: 1;
				}

				.file-actions {
					flex-wrap: wrap;
					gap: 0.25rem;
				}

				.action-btn {
					padding: 0.25rem 0.5rem;
					font-size: 0.6875rem;
				}

				.api-endpoint {
					flex-direction: column;
					align-items: flex-start;
					gap: 1rem;
				}

				.api-endpoint-info {
					flex-direction: column;
					align-items: flex-start;
					gap: 0.5rem;
				}

				.devtools-grid {
					grid-template-columns: 1fr;
				}
			}

			.no-results {
				text-align: center;
				padding: 3rem 1rem;
				color: hsl(var(--muted-foreground));
			}

			.no-results-icon {
				width: 4rem;
				height: 4rem;
				margin: 0 auto 1rem;
				opacity: 0.5;
			}

			.upload-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1000;
				opacity: 0;
				visibility: hidden;
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				pointer-events: none;
			}

			.upload-modal.show {
				opacity: 1;
				visibility: visible;
				pointer-events: all;
			}

			.modal-backdrop {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				backdrop-filter: blur(0px);
			}

			.upload-modal.show .modal-backdrop {
				background: rgba(0, 0, 0, 0.4);
				backdrop-filter: blur(8px);
			}

			.modal-background-content {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				transform: scale(1) translateY(0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				border-radius: 0;
				overflow: hidden;
			}

			.upload-modal.show .modal-background-content {
				transform: scale(0.92) translateY(-20px);
				border-radius: 16px;
				filter: brightness(0.7);
			}

			.upload-modal-content {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				height: 92%;
				background: hsl(var(--background));
				border-radius: 20px 20px 0 0;
				transform: translateY(100%);
				transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				display: flex;
				flex-direction: column;
				box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.3);
			}

			.upload-modal.show .upload-modal-content {
				transform: translateY(0);
			}

			.modal-handle {
				width: 36px;
				height: 4px;
				background: hsl(var(--muted-foreground) / 0.3);
				border-radius: 2px;
				margin: 12px auto 8px;
				flex-shrink: 0;
			}

			.modal-content-wrapper {
				flex: 1;
				display: flex;
				overflow: hidden;
			}

			.upload-left-panel {
				flex: 1;
				overflow-y: auto;
				background: hsl(var(--card));
				border-right: 1px solid hsl(var(--border));
			}
			.needs-scrolling {
				overflow-y: auto !important;
				scroll-behavior: smooth;
				overscroll-behavior: contain;
				-webkit-overflow-scrolling: touch;
				transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.needs-scrolling::-webkit-scrollbar {
				width: 6px;
			}

			.needs-scrolling::-webkit-scrollbar-track {
				background: transparent;
				border-radius: 3px;
			}

			.needs-scrolling::-webkit-scrollbar-thumb {
				background: hsl(var(--muted-foreground) / 0.2);
				border-radius: 3px;
				transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
				border: 1px solid transparent;
				background-clip: content-box;
			}

			.needs-scrolling:hover::-webkit-scrollbar-thumb {
				background: hsl(var(--muted-foreground) / 0.4);
				border-radius: 3px;
			}

			.needs-scrolling::-webkit-scrollbar-thumb:hover {
				background: hsl(var(--muted-foreground) / 0.6);
				border-radius: 3px;
			}

			.needs-scrolling::-webkit-scrollbar-thumb:active {
				background: hsl(var(--muted-foreground) / 0.8);
				border-radius: 3px;
			}

			/* Firefox scrollbar styling */
			.needs-scrolling {
				scrollbar-width: thin;
				scrollbar-color: hsl(var(--muted-foreground) / 0.2) transparent;
			}


			.upload-left-panel::-webkit-scrollbar {
				width: 8px;
			}

			.upload-left-panel::-webkit-scrollbar-track {
				background: transparent;
			}

			.upload-left-panel::-webkit-scrollbar-thumb {
				background: hsl(var(--muted-foreground) / 0.15);
				border-radius: 4px;
				transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
				position: relative;
			}

			.upload-left-panel:hover::-webkit-scrollbar-thumb {
				background: hsl(var(--muted-foreground) / 0.3);
				width: 10px;
				transform: scaleX(1.25);
			}

			.upload-left-panel::-webkit-scrollbar-thumb:hover {
				background: hsl(var(--muted-foreground) / 0.5);
				transform: scaleX(1.5);
				box-shadow: 0 0 8px hsl(var(--muted-foreground) / 0.2);
			}

			.upload-left-panel::-webkit-scrollbar-thumb:active {
				background: hsl(var(--muted-foreground) / 0.7);
				transform: scaleX(1.75);
				box-shadow: 0 0 12px hsl(var(--muted-foreground) / 0.3);
			}

			.upload-left-panel::-webkit-scrollbar-thumb::before {
				content: '';
				position: absolute;
				top: 0;
				left: 0;
				right: 0;
				bottom: 0;
				background: linear-gradient(
					180deg,
					hsl(var(--muted-foreground) / 0.1) 0%,
					transparent 50%,
					hsl(var(--muted-foreground) / 0.1) 100%
				);
				border-radius: inherit;
				opacity: 0;
				transition: opacity 0.2s ease;
			}

			.upload-left-panel:hover::-webkit-scrollbar-thumb::before {
				opacity: 1;
			}

			@media (max-width: 1024px) {
				.upload-left-panel {
					flex: 2 !important;
				}
			}

			@media (max-width: 768px) {
				.upload-right-panel {
					display: none !important;
				}
			}

			.upload-right-panel {
				flex: 2;
				display: flex;
				align-items: center;
				justify-content: center;
				background: hsl(var(--muted) / 0.3);
				position: relative;
				overflow: hidden;
			}

			.upload-icon-display {
				width: 300px;
				height: 300px;
				display: flex;
				align-items: center;
				justify-content: center;
				background: hsl(var(--card));
				border: 2px dashed hsl(var(--border));
				border-radius: 2rem;
				transition: all 0.3s ease;
				position: relative;
			}

			.upload-icon-display.active {
				border-color: hsl(var(--primary));
				background: hsl(var(--primary) / 0.05);
				transform: scale(1.05);
			}

			.upload-icon-display svg {
				width: 120px;
				height: 120px;
				color: hsl(var(--muted-foreground));
				transition: all 0.3s ease;
			}

			.upload-icon-display.active svg {
				color: hsl(var(--primary));
				transform: scale(1.1);
			}

			.upload-background-pattern {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				opacity: 0.2;
				background: radial-gradient(circle at 15% 15%, hsl(var(--primary) / 0.4) 0%, transparent 30%),
					radial-gradient(circle at 85% 20%, hsl(var(--accent) / 0.35) 0%, transparent 35%),
					radial-gradient(circle at 25% 75%, hsl(var(--primary) / 0.3) 0%, transparent 40%),
					radial-gradient(circle at 75% 85%, hsl(var(--accent) / 0.4) 0%, transparent 32%),
					radial-gradient(circle at 50% 30%, hsl(var(--primary) / 0.25) 0%, transparent 45%),
					radial-gradient(circle at 60% 70%, hsl(var(--accent) / 0.3) 0%, transparent 38%),
					radial-gradient(circle at 35% 45%, hsl(var(--primary) / 0.2) 0%, transparent 50%),
					radial-gradient(circle at 80% 55%, hsl(var(--accent) / 0.25) 0%, transparent 42%);
				animation: blobFlow 12s ease-in-out infinite;
			}

			@keyframes blobFlow {
				0%,
				100% {
					background: radial-gradient(circle at 15% 15%, hsl(var(--primary) / 0.4) 0%, transparent 30%),
						radial-gradient(circle at 85% 20%, hsl(var(--accent) / 0.35) 0%, transparent 35%),
						radial-gradient(circle at 25% 75%, hsl(var(--primary) / 0.3) 0%, transparent 40%),
						radial-gradient(circle at 75% 85%, hsl(var(--accent) / 0.4) 0%, transparent 32%),
						radial-gradient(circle at 50% 30%, hsl(var(--primary) / 0.25) 0%, transparent 45%),
						radial-gradient(circle at 60% 70%, hsl(var(--accent) / 0.3) 0%, transparent 38%),
						radial-gradient(circle at 35% 45%, hsl(var(--primary) / 0.2) 0%, transparent 50%),
						radial-gradient(circle at 80% 55%, hsl(var(--accent) / 0.25) 0%, transparent 42%);
					transform: scale(1) rotate(0deg);
				}
				16% {
					background: radial-gradient(circle at 25% 10%, hsl(var(--primary) / 0.45) 0%, transparent 28%),
						radial-gradient(circle at 90% 30%, hsl(var(--accent) / 0.4) 0%, transparent 33%),
						radial-gradient(circle at 20% 80%, hsl(var(--primary) / 0.35) 0%, transparent 38%),
						radial-gradient(circle at 70% 90%, hsl(var(--accent) / 0.45) 0%, transparent 30%),
						radial-gradient(circle at 45% 25%, hsl(var(--primary) / 0.3) 0%, transparent 43%),
						radial-gradient(circle at 65% 75%, hsl(var(--accent) / 0.35) 0%, transparent 36%),
						radial-gradient(circle at 30% 50%, hsl(var(--primary) / 0.25) 0%, transparent 48%),
						radial-gradient(circle at 85% 60%, hsl(var(--accent) / 0.3) 0%, transparent 40%);
					transform: scale(1.02) rotate(0.5deg);
				}
				33% {
					background: radial-gradient(circle at 35% 5%, hsl(var(--primary) / 0.5) 0%, transparent 26%),
						radial-gradient(circle at 95% 40%, hsl(var(--accent) / 0.45) 0%, transparent 31%),
						radial-gradient(circle at 15% 85%, hsl(var(--primary) / 0.4) 0%, transparent 36%),
						radial-gradient(circle at 65% 95%, hsl(var(--accent) / 0.5) 0%, transparent 28%),
						radial-gradient(circle at 40% 20%, hsl(var(--primary) / 0.35) 0%, transparent 41%),
						radial-gradient(circle at 70% 80%, hsl(var(--accent) / 0.4) 0%, transparent 34%),
						radial-gradient(circle at 25% 55%, hsl(var(--primary) / 0.3) 0%, transparent 46%),
						radial-gradient(circle at 90% 65%, hsl(var(--accent) / 0.35) 0%, transparent 38%);
					transform: scale(1.05) rotate(-0.5deg);
				}
				50% {
					background: radial-gradient(circle at 85% 15%, hsl(var(--primary) / 0.4) 0%, transparent 32%),
						radial-gradient(circle at 15% 25%, hsl(var(--accent) / 0.35) 0%, transparent 37%),
						radial-gradient(circle at 75% 75%, hsl(var(--primary) / 0.3) 0%, transparent 42%),
						radial-gradient(circle at 25% 85%, hsl(var(--accent) / 0.4) 0%, transparent 34%),
						radial-gradient(circle at 55% 35%, hsl(var(--primary) / 0.25) 0%, transparent 47%),
						radial-gradient(circle at 40% 65%, hsl(var(--accent) / 0.3) 0%, transparent 40%),
						radial-gradient(circle at 65% 45%, hsl(var(--primary) / 0.2) 0%, transparent 52%),
						radial-gradient(circle at 20% 55%, hsl(var(--accent) / 0.25) 0%, transparent 44%);
					transform: scale(1.03) rotate(1deg);
				}
				66% {
					background: radial-gradient(circle at 75% 25%, hsl(var(--primary) / 0.35) 0%, transparent 34%),
						radial-gradient(circle at 25% 15%, hsl(var(--accent) / 0.3) 0%, transparent 39%),
						radial-gradient(circle at 85% 65%, hsl(var(--primary) / 0.25) 0%, transparent 44%),
						radial-gradient(circle at 35% 75%, hsl(var(--accent) / 0.35) 0%, transparent 36%),
						radial-gradient(circle at 50% 45%, hsl(var(--primary) / 0.2) 0%, transparent 49%),
						radial-gradient(circle at 30% 55%, hsl(var(--accent) / 0.25) 0%, transparent 42%),
						radial-gradient(circle at 70% 35%, hsl(var(--primary) / 0.15) 0%, transparent 54%),
						radial-gradient(circle at 10% 65%, hsl(var(--accent) / 0.2) 0%, transparent 46%);
					transform: scale(1.01) rotate(-0.8deg);
				}
				83% {
					background: radial-gradient(circle at 20% 35%, hsl(var(--primary) / 0.3) 0%, transparent 36%),
						radial-gradient(circle at 80% 10%, hsl(var(--accent) / 0.25) 0%, transparent 41%),
						radial-gradient(circle at 30% 85%, hsl(var(--primary) / 0.2) 0%, transparent 46%),
						radial-gradient(circle at 90% 70%, hsl(var(--accent) / 0.3) 0%, transparent 38%),
						radial-gradient(circle at 45% 55%, hsl(var(--primary) / 0.15) 0%, transparent 51%),
						radial-gradient(circle at 55% 25%, hsl(var(--accent) / 0.2) 0%, transparent 44%),
						radial-gradient(circle at 25% 65%, hsl(var(--primary) / 0.1) 0%, transparent 56%),
						radial-gradient(circle at 75% 45%, hsl(var(--accent) / 0.15) 0%, transparent 48%);
					transform: scale(1.04) rotate(0.3deg);
				}
			}

			.modal-header {
				display: flex;
				padding: 1rem 1.5rem;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 2rem;
				padding-bottom: 1rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.modal-title {
				font-size: 1.5rem;
				font-weight: 700;
				color: hsl(0deg 0% 100%);
				/* background: linear-gradient(135deg, hsl(var(--primary)), hsl(var(--accent))); */
				/* -webkit-background-clip: text; */
				/* -webkit-text-fill-color: transparent; */
				background-clip: text;
			}

			.modal-close {
				background: hsl(var(--secondary));
				border: none;
				color: hsl(var(--foreground));
				cursor: pointer;
				padding: 1rem;
				border-radius: var(--radius);
				transition: all 0.2s ease;
				width: 3rem;
				height: 3rem;
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.modal-close:hover {
				background: hsl(var(--destructive));
				color: hsl(var(--destructive-foreground));
				transform: scale(1.05);
			}

			.modal-close svg {
				width: 1.5rem;
				height: 1.5rem;
			}

			/* Success Modal Styles */
			.success-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				overflow: auto;
				height: 100%;
				background: hsl(var(--background));
				z-index: 2000;
				opacity: 0;
				visibility: hidden;
				transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
				display: flex;
				align-items: center;
				justify-content: center;
			}

			.success-modal.show {
				opacity: 1;
				visibility: visible;
			}

			.success-modal-content {
				text-align: center;
				max-width: 600px;
				padding: 3rem;
				transform: scale(0.8) translateY(50px);
				transition: transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
			}

			.success-modal.show .success-modal-content {
				transform: scale(1) translateY(0);
			}

			.success-checkmark {
				width: 120px;
				height: 120px;
				margin: 11rem auto 2rem;
				border-radius: 50%;
				background: hsl(var(--primary));
				display: flex;
				align-items: center;
				justify-content: center;
				position: relative;
				animation: checkmarkPulse 0.6s ease-out;
			}

			.success-checkmark svg {
				width: 60px;
				height: 60px;
				color: hsl(var(--primary-foreground));
				animation: checkmarkDraw 0.8s ease-out 0.3s both;
			}

			.success-checkmark::before {
				content: '';
				position: absolute;
				width: 100%;
				height: 100%;
				border-radius: 50%;
				background: hsl(var(--primary) / 0.2);
				animation: ripple 1s ease-out;
			}

			.success-title {
				font-size: 2.5rem;
				font-weight: 700;
				color: hsl(var(--foreground));
				margin-bottom: 1rem;
				animation: fadeInUp 0.6s ease-out 0.5s both;
			}

			.success-subtitle {
				font-size: 1.25rem;
				color: hsl(var(--muted-foreground));
				margin-bottom: 2rem;
				animation: fadeInUp 0.6s ease-out 0.7s both;
			}

			.server-details {
				background: hsl(var(--card));
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 2rem;
				margin: 2rem 0;
				text-align: left;
				animation: fadeInUp 0.6s ease-out 0.9s both;
			}

			.server-details h3 {
				font-size: 1.25rem;
				font-weight: 600;
				margin-bottom: 1rem;
				color: hsl(var(--foreground));
			}

			.detail-row {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.75rem 0;
				border-bottom: 1px solid hsl(var(--border));
			}

			.detail-row:last-child {
				border-bottom: none;
			}

			.detail-label {
				font-weight: 500;
				color: hsl(var(--muted-foreground));
			}

			.detail-value {
				font-family: monospace;
				color: hsl(var(--foreground));
				background: hsl(var(--secondary));
				padding: 0.25rem 0.5rem;
				border-radius: calc(var(--radius) - 2px);
			}

			.success-actions {
				display: flex;
				gap: 1rem;
				justify-content: center;
				margin-top: 2rem;
				animation: fadeInUp 0.6s ease-out 1.1s both;
			}

			.upload-tabs {
				display: flex;
				padding-left: 1.7rem;
				padding-right: 1.7rem;
				margin-bottom: 1.5rem;
			}

			.upload-tab {
				flex: 1;
				padding: 0.4rem 1rem;
				background: none;
				border-radius: 12px;
				border: none;
				color: hsl(var(--muted-foreground));
				cursor: pointer;
				transition: all 0.2s ease;
				border: 2px solid transparent;
			}

			.upload-tab.active {
				background: #eee;
				font-weight: 600;
				color: hsl(0deg 0% 6.93%);
				border-color: hsl(var(--primary));
			}

			.upload-tab:hover {
				color: hsl(var(--foreground));
			}

			.upload-content {
				display: none;
			}

			.upload-content.active {
				display: block;
				padding-left: 1.7rem;
				padding-right: 1.7rem;
			}

			.file-drop-zone {
				border: 2px dashed hsl(var(--border));
				border-radius: var(--radius);
				padding: 2rem;
				text-align: center;
				transition: all 0.3s ease;
				cursor: pointer;
				margin-bottom: 1rem;
			}

			.file-drop-zone:hover,
			.file-drop-zone.dragover {
				border-color: hsl(var(--primary));
				background: hsl(var(--primary) / 0.05);
			}

			.file-drop-zone.dragover {
				transform: scale(1.02);
			}

			.drop-zone-icon {
				width: 3rem;
				height: 3rem;
				margin: 0 auto 1rem;
				color: hsl(var(--muted-foreground));
			}

			.form-group {
				margin-bottom: 1rem;
			}

			.form-label {
				display: block;
				margin-bottom: 0.5rem;
				font-weight: 500;
				color: hsl(var(--foreground));
			}

			.form-input,
			.form-select,
			.form-textarea {
				width: 100%;
				padding: 0.75rem;
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--background));
				color: hsl(var(--foreground));
				transition: border-color 0.2s ease;
			}

			.form-input:focus,
			.form-select:focus,
			.form-textarea:focus {
				outline: none;
				border-color: hsl(var(--primary));
			}

			.form-textarea {
				resize: vertical;
				min-height: 80px;
			}

			.upload-progress {
				display: none;
				margin: 1rem 0;
			}

			.progress-bar {
				width: 100%;
				height: 8px;
				background: hsl(var(--secondary));
				border-radius: 4px;
				overflow: hidden;
			}

			.progress-fill {
				height: 100%;
				background: hsl(var(--primary));
				transition: width 0.3s ease;
				width: 0%;
			}

			.progress-text {
				text-align: center;
				margin-top: 0.5rem;
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.modal-actions {
				display: flex;
				gap: 0.75rem;
				justify-content: flex-end;
				margin-top: 1.5rem;
				padding-left: 1.7rem;
				padding-right: 1.7rem;
			}

			.btn {
				padding: 0.75rem 1.5rem;
				border-radius: calc(var(--radius) - 2px);
				font-weight: 500;
				cursor: pointer;
				transition: all 0.2s ease;
				border: none;
			}

			.btn-primary {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.btn-primary:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.btn-secondary {
				background: hsl(var(--secondary));
				color: hsl(var(--secondary-foreground));
			}

			.btn-secondary:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.btn:disabled {
				opacity: 0.5;
				cursor: not-allowed;
			}

			.file-preview {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.75rem;
				background: hsl(var(--secondary));
				border-radius: calc(var(--radius) - 2px);
				margin-bottom: 1rem;
			}

			.file-preview-icon {
				width: 2rem;
				height: 2rem;
				color: hsl(var(--primary));
			}

			.file-preview-info {
				flex: 1;
			}

			.file-preview-name {
				font-weight: 500;
				color: hsl(var(--foreground));
			}

			.file-preview-size {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			@keyframes fade-in-up {
				0% {
					opacity: 0;
					transform: translateY(30px);
				}
				100% {
					opacity: 1;
					transform: translateY(0);
				}
			}

			@keyframes slideIn {
				0% {
					opacity: 0;
					transform: translateX(100%);
				}
				100% {
					opacity: 1;
					transform: translateX(0);
				}
			}

			@keyframes slideOut {
				0% {
					opacity: 1;
					transform: translateX(0);
				}
				100% {
					opacity: 0;
					transform: translateX(100%);
				}
			}

			/* File Editor Modal Styles */
			.file-editor-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1000;
				opacity: 0;
				visibility: hidden;
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				pointer-events: none;
			}

			.file-editor-modal.show {
				opacity: 1;
				visibility: visible;
				pointer-events: all;
			}

			.file-editor-modal .modal-background-content {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				transform: scale(1) translateY(0);
				transition: all 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				border-radius: 0;
				overflow: hidden;
			}

			.file-editor-modal.show .modal-background-content {
				transform: scale(0.92) translateY(-20px);
				border-radius: 16px;
				filter: brightness(0.7);
			}

			.file-editor-modal-content {
				position: absolute;
				bottom: 0;
				left: 0;
				width: 100%;
				height: 95%;
				background: hsl(var(--background));
				border-radius: 20px 20px 0 0;
				transform: translateY(100%);
				transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
				display: flex;
				flex-direction: column;
				box-shadow: 0 -10px 40px rgba(0, 0, 0, 0.3);
			}

			.file-editor-modal.show .file-editor-modal-content {
				transform: translateY(0);
			}

			.file-editor-left-panel {
				width: 350px;
				min-width: 350px;
				background: hsl(var(--card));
				border-right: 1px solid hsl(var(--border));
				display: flex;
				flex-direction: column;
				overflow: hidden;
			}

			.file-editor-right-panel {
				flex: 1;
				display: flex;
				flex-direction: column;
				overflow: hidden;
			}

			.editor-header-content {
				display: flex;
				align-items: center;
				gap: 1rem;
			}

			.editor-icon {
				width: 2.5rem;
				height: 2.5rem;
				border-radius: 50%;
				background: hsl(var(--primary) / 0.1);
				display: flex;
				align-items: center;
				justify-content: center;
				color: hsl(var(--primary));
			}

			.editor-icon svg {
				width: 1.25rem;
				height: 1.25rem;
			}

			.editor-title-group {
				flex: 1;
			}

			.modal-subtitle {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
				margin: 0;
			}

			.file-selector-section,
			.current-file-section,
			.save-actions-section {
				padding: 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.section-header {
				display: flex;
				justify-content: space-between;
				margin-bottom: 1rem;
			}

			.section-header h3 {
				font-size: 1rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin: 0;
			}

			.refresh-files-btn,
			.action-btn {
				width: 2rem;
				height: 2rem;
				border-radius: 50%;
				background: hsl(var(--secondary));
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--secondary-foreground));
			}

			.refresh-files-btn:hover,
			.action-btn:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.refresh-files-btn svg,
			.action-btn svg {
				width: 1rem;
				height: 1rem;
			}

			.file-actions-quick {
				display: flex;
				gap: 0.5rem;
			}

			.file-search-container {
				margin-bottom: 1rem;
			}

			.search-input-wrapper {
				position: relative;
			}

			.search-icon-small {
				position: absolute;
				left: 0.75rem;
				top: 50%;
				transform: translateY(-50%);
				width: 1rem;
				height: 1rem;
				color: hsl(var(--muted-foreground));
			}

			.file-search-input {
				width: 100%;
				padding: 0.75rem 0.75rem 0.75rem 2.5rem;
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--background));
				color: hsl(var(--foreground));
				font-size: 0.875rem;
				transition: border-color 0.2s ease;
			}

			.file-search-input:focus {
				outline: none;
				border-color: hsl(var(--primary));
			}

			.file-list-container {
				max-height: 300px;
				overflow-y: auto;
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				background: hsl(var(--background));
			}

			.loading-spinner {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.75rem;
				padding: 2rem;
				color: hsl(var(--muted-foreground));
			}

			.spinner {
				width: 1rem;
				height: 1rem;
				border: 2px solid hsl(var(--border));
				border-top: 2px solid hsl(var(--primary));
				border-radius: 50%;
				animation: spin 1s linear infinite;
			}

			.file-item {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.75rem 1rem;
				border-bottom: 1px solid hsl(var(--border));
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.file-item:last-child {
				border-bottom: none;
			}

			.file-item:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.file-item.selected {
				background: hsl(var(--primary) / 0.1);
				border-color: hsl(var(--primary) / 0.2);
			}

			.file-item-icon {
				width: 1.5rem;
				height: 1.5rem;
				color: hsl(var(--muted-foreground));
			}

			.file-item-info {
				flex: 1;
				min-width: 0;
			}

			.file-item-name {
				font-weight: 500;
				color: hsl(var(--foreground));
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}

			.file-item-meta {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				display: flex;
				gap: 0.5rem;
			}

			.current-file-info {
				background: hsl(var(--muted) / 0.1);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
			}

			.current-file-detail {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.5rem 0;
				border-bottom: 1px solid hsl(var(--border));
			}

			.current-file-detail:last-child {
				border-bottom: none;
			}

			.current-file-label {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
				font-weight: 500;
			}

			.current-file-value {
				font-size: 0.875rem;
				color: hsl(var(--foreground));
				font-family: monospace;
			}

			/* Save Actions */
			.save-options {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.save-buttons {
				display: flex;
				gap: 0.75rem;
			}

			.save-buttons .btn {
				flex: 1;
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.5rem;
			}

			.save-buttons .btn svg {
				width: 1rem;
				height: 1rem;
			}

			/* Editor Container */
			.editor-container {
				flex: 1;
				display: flex;
				flex-direction: column;
				overflow: hidden;
			}

			.editor-tabs {
				display: flex;
				border-bottom: 1px solid hsl(var(--border));
				background: hsl(var(--muted) / 0.3);
			}

			.editor-tab {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				padding: 1rem 1.5rem;
				background: transparent;
				border: none;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
				font-weight: 500;
				border-bottom: 2px solid transparent;
			}

			.editor-tab:hover {
				background: hsl(var(--muted) / 0.1);
				color: hsl(var(--foreground));
			}

			.editor-tab.active {
				background: hsl(var(--background));
				color: hsl(var(--primary));
				border-bottom-color: hsl(var(--primary));
			}

			.editor-tab svg {
				width: 1rem;
				height: 1rem;
			}

			.editor-content-areas {
				flex: 1;
				position: relative;
				overflow: hidden;
			}

			.editor-area {
				position: absolute;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				display: none;
				flex-direction: column;
			}

			.editor-area.active {
				display: flex;
			}

			/* Content Editor */
			.editor-toolbar {
				display: flex;
				align-items: center;
				gap: 1rem;
				padding: 0.75rem 1rem;
				border-bottom: 1px solid hsl(var(--border));
				background: hsl(var(--muted) / 0.1);
			}

			.toolbar-section {
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.toolbar-btn {
				width: 2rem;
				height: 2rem;
				border-radius: calc(var(--radius) - 2px);
				background: transparent;
				border: 1px solid hsl(var(--border));
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
			}

			.toolbar-btn:hover {
				background: hsl(var(--muted) / 0.1);
				color: hsl(var(--foreground));
			}

			.toolbar-btn:active,
			.toolbar-btn.active {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
				border-color: hsl(var(--primary));
			}

			.toolbar-btn svg {
				width: 1rem;
				height: 1rem;
			}

			.language-select {
				padding: 0.375rem 0.75rem;
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--background));
				color: hsl(var(--foreground));
				font-size: 0.875rem;
				cursor: pointer;
			}

			.code-editor-container {
				flex: 1;
				display: flex;
				position: relative;
				overflow: hidden;
			}

			.line-numbers {
				width: 4rem;
				background: hsl(var(--muted) / 0.3);
				border-right: 1px solid hsl(var(--border));
				padding: 1rem 0.5rem;
				font-family: 'Courier New', monospace;
				font-size: 0.875rem;
				line-height: 1.5;
				color: hsl(var(--muted-foreground));
				text-align: right;
				user-select: none;
				overflow: hidden;
			}

			.code-editor {
				flex: 1;
				padding: 1rem;
				border: none;
				outline: none;
				background: hsl(var(--background));
				color: hsl(var(--foreground));
				font-family: 'Courier New', monospace;
				font-size: 0.875rem;
				line-height: 1.5;
				resize: none;
				tab-size: 2;
				white-space: pre;
				overflow-wrap: normal;
			}

			.code-editor::placeholder {
				color: hsl(var(--muted-foreground));
			}

			.editor-status-bar {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.5rem 1rem;
				background: hsl(var(--muted) / 0.3);
				border-top: 1px solid hsl(var(--border));
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
			}

			.status-left,
			.status-right {
				display: flex;
				gap: 1rem;
			}

			.status-item {
				display: flex;
				align-items: center;
				gap: 0.25rem;
			}

			/* Metadata Editor */
			.metadata-form {
				padding: 1.5rem;
				overflow-y: auto;
				height: 100%;
			}

			.form-section {
				margin-bottom: 2rem;
			}

			.form-section h4 {
				font-size: 1rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin-bottom: 1rem;
				padding-bottom: 0.5rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.tags-input-container {
				position: relative;
			}

			.tags-display {
				display: flex;
				flex-wrap: wrap;
				gap: 0.5rem;
				margin-top: 0.5rem;
			}

			.tag-item {
				display: flex;
				align-items: center;
				gap: 0.25rem;
				padding: 0.25rem 0.5rem;
				background: hsl(var(--primary) / 0.1);
				color: hsl(var(--primary));
				border-radius: calc(var(--radius) - 2px);
				font-size: 0.75rem;
			}

			.tag-remove {
				width: 1rem;
				height: 1rem;
				border-radius: 50%;
				background: hsl(var(--primary) / 0.2);
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				color: hsl(var(--primary));
			}

			.tag-remove:hover {
				background: hsl(var(--primary) / 0.3);
			}

			.custom-fields-container {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.add-field-btn {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.5rem;
				padding: 0.75rem;
				border: 2px dashed hsl(var(--border));
				border-radius: var(--radius);
				background: transparent;
				color: hsl(var(--muted-foreground));
				cursor: pointer;
				transition: all 0.2s ease;
			}

			.add-field-btn:hover {
				border-color: hsl(var(--primary));
				color: hsl(var(--primary));
				background: hsl(var(--primary) / 0.05);
			}

			.custom-field {
				display: flex;
				gap: 0.5rem;
				align-items: end;
			}

			.custom-field .form-group {
				flex: 1;
				margin-bottom: 0;
			}

			.remove-field-btn {
				width: 2.5rem;
				height: 2.5rem;
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--destructive) / 0.1);
				border: 1px solid hsl(var(--destructive) / 0.2);
				color: hsl(var(--destructive));
				cursor: pointer;
				display: flex;
				align-items: center;
				justify-content: center;
				transition: all 0.2s ease;
			}

			.remove-field-btn:hover {
				background: hsl(var(--destructive) / 0.2);
			}

			/* Info Area */
			.info-container {
				padding: 1.5rem;
				overflow-y: auto;
				height: 100%;
			}

			.info-section {
				margin-bottom: 2rem;
			}

			.info-section h4 {
				font-size: 1rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin-bottom: 1rem;
				padding-bottom: 0.5rem;
				border-bottom: 1px solid hsl(var(--border));
			}

			.info-section-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 1rem;
			}

			.info-section-header h4 {
				margin-bottom: 0;
				padding-bottom: 0;
				border-bottom: none;
			}

			.refresh-versions-btn {
				width: 2rem;
				height: 2rem;
				border-radius: 50%;
				background: hsl(var(--secondary));
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--secondary-foreground));
			}

			.refresh-versions-btn:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.refresh-versions-btn svg {
				width: 1rem;
				height: 1rem;
			}

			.info-grid {
				display: grid;
				grid-template-columns: 1fr;
				gap: 1rem;
			}

			.info-item {
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0.75rem 1rem;
				background: hsl(var(--muted) / 0.1);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
			}

			.info-label {
				font-weight: 500;
				color: hsl(var(--muted-foreground));
				font-size: 0.875rem;
			}

			.info-value {
				font-family: monospace;
				color: hsl(var(--foreground));
				font-size: 0.875rem;
				word-break: break-all;
				text-align: right;
			}

			.versions-container {
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				background: hsl(var(--background));
				max-height: 400px;
				overflow-y: auto;
			}

			.versions-loading {
				display: flex;
				align-items: center;
				justify-content: center;
				gap: 0.75rem;
				padding: 2rem;
				color: hsl(var(--muted-foreground));
			}

			.version-item {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1rem;
				border-bottom: 1px solid hsl(var(--border));
				transition: all 0.2s ease;
			}

			.version-item:last-child {
				border-bottom: none;
			}

			.version-item:hover {
				background: hsl(var(--muted) / 0.1);
			}

			.version-item.current {
				background: hsl(var(--primary) / 0.1);
				border-color: hsl(var(--primary) / 0.2);
			}

			.version-info {
				flex: 1;
			}

			.version-number {
				font-weight: 600;
				color: hsl(var(--foreground));
				font-size: 0.875rem;
			}

			.version-date {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				margin-top: 0.25rem;
			}

			.version-size {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				font-family: monospace;
			}

			.version-actions {
				display: flex;
				gap: 0.5rem;
			}

			.version-action-btn {
				width: 2rem;
				height: 2rem;
				border-radius: calc(var(--radius) - 2px);
				background: hsl(var(--secondary));
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--secondary-foreground));
			}

			.version-action-btn:hover {
				background: hsl(var(--secondary) / 0.8);
			}

			.version-action-btn.primary {
				background: hsl(var(--primary));
				color: hsl(var(--primary-foreground));
			}

			.version-action-btn.primary:hover {
				background: hsl(var(--primary) / 0.9);
			}

			.version-action-btn svg {
				width: 1rem;
				height: 1rem;
			}

			.versions-empty {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				padding: 3rem 1rem;
				color: hsl(var(--muted-foreground));
				text-align: center;
			}

			.versions-empty svg {
				width: 2.5rem;
				height: 2.5rem;
				margin-bottom: 1rem;
			}

			/* Preview Area */
			.preview-container {
				height: 100%;
				overflow: auto;
				padding: 1.5rem;
			}

			.preview-placeholder {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				height: 100%;
				color: hsl(var(--muted-foreground));
				text-align: center;
			}

			.preview-placeholder svg {
				width: 4rem;
				height: 4rem;
				margin-bottom: 1rem;
			}

			.preview-placeholder h3 {
				font-size: 1.25rem;
				font-weight: 600;
				margin-bottom: 0.5rem;
			}

			.preview-content {
				width: 100%;
				height: 100%;
			}

			.preview-image {
				max-width: 100%;
				height: auto;
				border-radius: var(--radius);
				box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
			}

			.preview-code {
				background: hsl(var(--muted) / 0.1);
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
				font-family: 'Courier New', monospace;
				font-size: 0.875rem;
				line-height: 1.5;
				overflow: auto;
				white-space: pre;
			}

			.preview-video,
			.preview-audio {
				width: 100%;
				border-radius: var(--radius);
			}

			/* Version History Modal */
			.version-history-modal {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				z-index: 1100;
				display: flex;
				align-items: center;
				justify-content: center;
				background: rgba(0, 0, 0, 0.5);
				backdrop-filter: blur(8px);
			}

			.version-history-modal .modal-content {
				background: hsl(var(--background));
				border-radius: calc(var(--radius) + 4px);
				box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3);
				border: 1px solid hsl(var(--border));
			}

			.version-list {
				display: flex;
				flex-direction: column;
				gap: 1rem;
			}

			.version-item {
				border: 1px solid hsl(var(--border));
				border-radius: var(--radius);
				padding: 1rem;
				background: hsl(var(--card));
			}

			.version-header {
				display: flex;
				justify-content: space-between;
				align-items: center;
				margin-bottom: 0.5rem;
			}

			.version-info {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
			}

			.version-date {
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.version-details {
				display: flex;
				flex-direction: column;
				gap: 0.25rem;
				font-size: 0.875rem;
				color: hsl(var(--muted-foreground));
			}

			.btn-sm {
				padding: 0.375rem 0.75rem;
				font-size: 0.75rem;
			}

			/* Responsive Design */
			@media (max-width: 1200px) {
				.file-editor-left-panel {
					width: 300px;
					min-width: 300px;
				}
			}

			@media (max-width: 768px) {
				.file-editor-modal-content {
					height: 100%;
					border-radius: 0;
				}

				.modal-content-wrapper {
					flex-direction: column;
				}

				.file-editor-left-panel {
					width: 100%;
					min-width: unset;
					height: 40%;
					border-right: none;
					border-bottom: 1px solid hsl(var(--border));
				}

				.file-editor-right-panel {
					height: 60%;
				}

				.editor-tabs {
					font-size: 0.875rem;
				}

				.editor-tab {
					padding: 0.75rem 1rem;
				}

				.toolbar-section {
					gap: 0.25rem;
				}

				.line-numbers {
					width: 3rem;
					padding: 0.75rem 0.25rem;
				}

				.code-editor {
					padding: 0.75rem;
				}
			}

			@keyframes checkmarkPulse {
				0% {
					transform: scale(0);
					opacity: 0;
				}
				50% {
					transform: scale(1.1);
				}
				100% {
					transform: scale(1);
					opacity: 1;
				}
			}

			@keyframes checkmarkDraw {
				0% {
					stroke-dasharray: 0 100;
					opacity: 0;
				}
				100% {
					stroke-dasharray: 100 0;
					opacity: 1;
				}
			}

			@keyframes ripple {
				0% {
					transform: scale(1);
					opacity: 0.3;
				}
				100% {
					transform: scale(2);
					opacity: 0;
				}
			}

			@keyframes fadeInUp {
				0% {
					opacity: 0;
					transform: translateY(30px);
				}
				100% {
					opacity: 1;
					transform: translateY(0);
				}
			}

			@keyframes float {
				0%,
				100% {
					transform: translateY(0px) rotate(0deg);
				}
				50% {
					transform: translateY(-20px) rotate(180deg);
				}
			}

			@keyframes fade-in {
				0% {
					opacity: 0;
				}
				100% {
					opacity: 1;
				}
			}

			/* File Viewer Panel */
			.file-viewer-panel {
				position: fixed;
				top: 50%;
				right: -400px;
				width: 380px;
				height: 600px;
				max-height: 80vh;
				background: hsl(var(--background));
				border: 1px solid hsl(var(--border));
				border-radius: calc(var(--radius) + 4px);
				box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
				transform: translateY(-50%);
				transition: all 0.3s cubic-bezier(0.32, 0.72, 0, 1);
				z-index: 100;
				display: flex;
				flex-direction: column;
				backdrop-filter: blur(20px);
				opacity: 0;
				visibility: hidden;
			}

			.file-viewer-panel.show {
				right: 2rem;
				opacity: 1;
				visibility: visible;
			}

			.file-viewer-header {
				display: flex;
				align-items: center;
				justify-content: space-between;
				padding: 1.5rem 1.5rem 1rem;
				border-bottom: 1px solid hsl(var(--border));
				flex-shrink: 0;
			}

			.file-viewer-title-section {
				display: flex;
				align-items: center;
				gap: 0.75rem;
			}

			.file-viewer-icon {
				width: 2.5rem;
				height: 2.5rem;
				border-radius: calc(var(--radius) + 2px);
				background: hsl(var(--primary) / 0.1);
				display: flex;
				align-items: center;
				justify-content: center;
				color: hsl(var(--primary));
			}

			.file-viewer-title-text {
				display: flex;
				flex-direction: column;
				gap: 0.125rem;
			}

			.file-viewer-title {
				font-size: 1.125rem;
				font-weight: 600;
				color: hsl(var(--foreground));
				margin: 0;
				line-height: 1.2;
			}

			.file-viewer-subtitle {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				margin: 0;
				line-height: 1.2;
			}

			.file-viewer-actions {
				display: flex;
				align-items: center;
				gap: 0.5rem;
			}

			.file-viewer-refresh,
			.file-viewer-close {
				width: 2rem;
				height: 2rem;
				border-radius: calc(var(--radius) - 2px);
				background: transparent;
				border: 1px solid hsl(var(--border));
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
			}

			.file-viewer-refresh:hover,
			.file-viewer-close:hover {
				background: hsl(var(--accent));
				color: hsl(var(--accent-foreground));
				border-color: hsl(var(--border) / 0.8);
			}

			.file-viewer-content {
				flex: 1;
				overflow: hidden;
				display: flex;
				flex-direction: column;
			}

			.file-viewer-stats {
				display: flex;
				align-items: center;
				gap: 2rem;
				padding: 1rem 1.5rem;
				border-bottom: 1px solid hsl(var(--border));
				flex-shrink: 0;
			}

			.file-stat {
				display: flex;
				flex-direction: column;
				align-items: center;
				gap: 0.25rem;
			}

			.file-stat-value {
				font-size: 1.25rem;
				font-weight: 700;
				color: hsl(var(--foreground));
				line-height: 1;
			}

			.file-stat-label {
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
				text-transform: uppercase;
				letter-spacing: 0.025em;
				font-weight: 500;
			}

			.file-viewer-list {
				flex: 1;
				overflow-y: auto;
				padding: 0.5rem;
			}

			.file-item {
				display: flex;
				align-items: center;
				gap: 0.75rem;
				padding: 0.75rem;
				border-radius: calc(var(--radius) - 2px);
				transition: all 0.2s ease;
				cursor: pointer;
				border: 1px solid transparent;
			}

			.file-item:hover {
				background: hsl(var(--accent));
				border-color: hsl(var(--border));
			}

			.file-item-icon {
				width: 2rem;
				height: 2rem;
				border-radius: calc(var(--radius) - 4px);
				background: hsl(var(--secondary));
				display: flex;
				align-items: center;
				justify-content: center;
				color: hsl(var(--muted-foreground));
				flex-shrink: 0;
			}

			.file-item-content {
				flex: 1;
				min-width: 0;
				display: flex;
				flex-direction: column;
				gap: 0.125rem;
			}

			.file-item-name {
				font-size: 0.875rem;
				font-weight: 500;
				color: hsl(var(--foreground));
				white-space: nowrap;
				overflow: hidden;
				text-overflow: ellipsis;
			}

			.file-item-meta {
				display: flex;
				align-items: center;
				gap: 0.5rem;
				font-size: 0.75rem;
				color: hsl(var(--muted-foreground));
			}

			.file-item-size {
				font-family: monospace;
			}

			.file-item-actions {
				display: flex;
				align-items: center;
				gap: 0.25rem;
				opacity: 0;
				transition: opacity 0.2s ease;
			}

			.file-item:hover .file-item-actions {
				opacity: 1;
			}

			.file-action-btn {
				width: 1.5rem;
				height: 1.5rem;
				border-radius: calc(var(--radius) - 4px);
				background: transparent;
				border: none;
				display: flex;
				align-items: center;
				justify-content: center;
				cursor: pointer;
				transition: all 0.2s ease;
				color: hsl(var(--muted-foreground));
			}

			.file-action-btn:hover {
				background: hsl(var(--primary) / 0.1);
				color: hsl(var(--primary));
			}

			.file-action-btn.danger:hover {
				background: hsl(var(--destructive) / 0.1);
				color: hsl(var(--destructive));
			}

			.file-viewer-empty {
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				padding: 3rem 1.5rem;
				text-align: center;
				color: hsl(var(--muted-foreground));
			}

			.file-viewer-empty svg {
				width: 3rem;
				height: 3rem;
				margin-bottom: 1rem;
				opacity: 0.5;
			}

			.file-viewer-empty h4 {
				font-size: 1rem;
				font-weight: 600;
				margin-bottom: 0.5rem;
				color: hsl(var(--foreground));
			}

			.file-viewer-empty p {
				font-size: 0.875rem;
				margin: 0;
			}

			@media (max-width: 768px) {
				.container {
					padding: 1rem;
				}

				.logo {
					font-size: 2rem;
				}

				.search-input {
					padding: 0.875rem 2.5rem 0.875rem 2.5rem;
					font-size: 1rem;
				}

				.results-grid {
					grid-template-columns: 1fr;
				}

				.file-viewer-panel {
					right: -100%;
					width: 100%;
					height: 70vh;
					top: auto;
					bottom: -70vh;
					transform: none;
					border-radius: calc(var(--radius) + 4px) calc(var(--radius) + 4px) 0 0;
				}

				.file-viewer-panel.show {
					right: 0;
					bottom: 0;
				}
			}
		</style>
		<style>
			main {
				transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
				transform-origin: center center;
				will-change: transform, filter, border-radius;
				border: 1px solid #000000 !important;
			}

			body:has(.auth-modal.show) main,
			body:has(.upload-modal.show) main,
			body:has(.file-editor-modal.show) main {
				transform: scale(0.97) translateY(16px) !important;
				filter: brightness(2.5) contrast(0.7) !important;
				overflow: hidden !important;
				border-radius: 32px !important;
			}

			body:has(.auth-modal.show) main .main-content,
			body:has(.upload-modal.show) main .main-content,
			body:has(.file-editor-modal.show) main .main-content {
				filter: blur(10px) saturate(1.5) brightness(0.2) hue-rotate(297deg);
			}

			body:has(.auth-modal.show),
			body:has(.upload-modal.show),
			body:has(.file-editor-modal.show)  {
				overflow: hidden !important;
				background:  radial-gradient(rgba(0, 0, 0, 0), #000),
				linear-gradient(130deg, #000 0%, #000 37%, #000 51%, #000 67%, #000 100%) !important;
			}

			.loading-wrapper{
				transition: all 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
				transform-origin: center center;
				will-change: transform, filter, border-radius;
				
			}
			body:has(.loading-overlay.active) .loading-wrapper{
				transform: scale(0.97);
				overflow: hidden;
				border-radius: 30px;
			}

			.needs-shadow {
				box-shadow: 
					0 -25px 50px -12px rgba(0, 0, 0, 0.4),
					0 -8px 25px -8px rgba(0, 0, 0, 0.3),
					0 -4px 15px -4px rgba(0, 0, 0, 0.2),
					0 -2px 8px -2px rgba(0, 0, 0, 0.1),
					0 0 4px 0 rgba(0, 0, 0, 0.05),
					inset 0 1px 0 rgba(255, 255, 255, 0.1),
					inset 0 -1px 0 rgba(0, 0, 0, 0.1) !important;
			}
		</style>
	</head>
	<body>
		<div class="loading-wrapper">
			<main class="main-wrapper" id="app">
				<div class="main-content">
					<canvas id="canvas" style="filter: blur(100px) saturate(1.5) brightness(0.2) hue-rotate(297deg); z-index: -1"></canvas>
					<script>
						//************** Shader sources **************
						var vertexSource = `
					attribute vec2 position;
					void main() {
					gl_Position = vec4(position, 0, 1.0);
					}
					`;

						var fragmentSource = `
					#define PI 3.14159265358979323846
					precision highp float;

					uniform float width;
					uniform float height;
					vec2 resolution = vec2(width, height);
					uniform float time;

					//from bookofshaders.com
					float random (in vec2 st) {
						return fract(sin(dot(st.xy/PI, vec2(12.9898,78.233))) * 43758.5453123);
					}

					vec2 rotate(vec2 _st, float _angle) {
						_st -= 0.5;
						_st =  mat2(cos(_angle),-sin(_angle), sin(_angle),cos(_angle)) * _st;
						_st.y += 0.5;
							_st.x += .5;
						return _st;
					}

					// https://www.shadertoy.com/view/4dS3Wd Morgan McGuire
					float noise (in vec2 st) {
						vec2 i = floor(st);
						vec2 f = fract(st);

						// Four corners in 2D of a tile
						float a = random(i);
						float b = random(i + vec2(1.0, 0.0));
						float c = random(i + vec2(0.0, 1.0));
						float d = random(i + vec2(1.0, 1.0));

						// Cubic Hermine Curve.  Same as SmoothStep()
						vec2 u = f*f*(3.0-2.0*f);
						// u = smoothstep(0.,1.,f);

						// Mix 4 corners as percentages
						return mix(a, b, u.x) +
								(c - a)* u.y * (1.0 - u.x) +
								(d - b) * u.x * u.y;
					}


					float surface(vec2 pos, float radius, float time) {
						float sphere = length(pos)*3.0;//(distance from center)
						float a = atan(pos.y,pos.x);
						float m = a*time;
						m += noise(pos+time*0.1)*.5;
						a *= 1.+abs(atan(time*0.2))*.1;
						a *= 1.+noise(pos+time*0.1)*0.1;
						float distortion = .002*(1.0-pos.y);
						radius += sin(a*50.)*noise(pos+time*.2)*distortion;
						radius += (sin(a*20.)*.002);
						return 1.-smoothstep(radius,radius+0.015,sphere);
					}

					void main(){

						//translation
					float aspect = width/height;
					vec2 uv = gl_FragCoord.xy/resolution.xy;
					float mini = min(width, height);
					float maxi = max(width, height);
					float factor = width > height ? mini : maxi;
					uv.x = (uv.x * aspect)-(.5*(width-height)/factor);

					//time and distance
					float period = 17.2*PI;
						float t = mod(time, period);
					vec2 pos = uv;//position of sun
					pos = vec2(0.5, 1.0-10.0*sin(t*.003))-pos;
					float ds = length(pos);//distance from sun
					float dc = distance(vec2(.5,.5), uv);//distance from center
						float ids = 1.0 - ds;//inverse distance from sun

					//star field
					float movement = .00;//none
					float rotation = -t*.0000;//none
					float twinkle = (1.0+.2*cos(t*40.0*random(uv)));

					//set up first layer of stars:
					//most distant tiny stars
					vec2 starPos = uv;
					starPos.y -= t*movement;
					starPos = rotate(starPos, rotation);
					float r = random(floor(starPos*500.));
					float brightnessModifier = .3*(fract(r*9.445)+.1);
					r *= step(.97, r);//limit to 3% selection of cells
					vec3 stars = vec3(.5,.7,1.0) * vec3(r)*ds;//a color that's dimmer close to sun
					stars *= 1.0-step(ds,.2);//mask starfield at sun, not really necessary due to previous step.
					vec4 starfield = brightnessModifier*vec4(stars,1.0);

					//and then same thing for three more layers of stars:

					//medium distance white stars
					vec2 starPos2 = uv;
					starPos2.y -= t*movement;
					starPos2 = rotate(starPos2, rotation);
					float r2 = random(floor(starPos2*450.));
					brightnessModifier = fract(r2*14.4548);
					r2 *= step(.99, r2);
					vec3 stars2 = vec3(.5,.5,1.0) * vec3(r2)*ds;
					stars2 *= 1.0-step(ds,.2);
					vec4 starfield2 = (twinkle)*(.77*brightnessModifier)*vec4(stars2,1.0);

					//dimmer, red stars
					vec2 starPos3 = uv;
					starPos3.y -= t*movement;
					starPos3 = rotate(starPos3, rotation);
					float r3 = random(floor(starPos3*470.));
					brightnessModifier = .4*fract(r3*68.7);
					r3 *= step(.9975, r3);
					vec3 stars3 = vec3(1.0,.7,.7) * vec3(r3)*ds;
					stars3 *= 1.0-step(ds,.2);
					vec4 starfield3 = twinkle*(brightnessModifier)*vec4(stars3,1.0);

					//closer/brighter and bluer stars
					vec2 starPos4 = uv;
					starPos4.y -= t*movement;
					starPos4 = rotate(starPos4, rotation);
					float r4 = random(floor(starPos4*400.));
					brightnessModifier = .5+.5*fract(r4*34.5234);
					r4 *= step(.9986, r4);
					vec3 stars4 = vec3(.5,.5,1.0) * vec3(r4)*ds;
					stars4 += vec3(0.0,0.0,.05);//adding tiny bit of overall blue to space here
					stars4 *= 1.0-step(ds,.2);
					vec4 starfield4 = twinkle*brightnessModifier*vec4(stars4,1.0);

					float starfieldBrightness = .8;

					//sun
					vec3 red = -ds + vec3(1.0,0.0,0.1);
					vec3 grn = vec3(0.0,.1/uv.y,0.0);//not used
					vec3 orange = -ds+ vec3(1.0,.4,0.5+dc);
					vec3 yellow = vec3(.9,1.0,.3+.75*ds)*clamp(ids, 0.0, 1.0);
					vec3 lime = vec3(1.0,1.0,.1)*clamp(ids, 0.0, 1.0);
					float surfaceTemp = 1.0;
					float lensing = (1.0-uv.y)-.5;//bigger sun as y goes down to 0
					vec3 colorz = (yellow)*(lime)*(lensing+.9*(lime+yellow+orange+red));
					float sunsetFactor = 2.0*uv.y;//less white color as sun goes down

					gl_FragColor = starfieldBrightness*(starfield2+starfield+starfield3+starfield4)+vec4(colorz+(sunsetFactor*(surfaceTemp*surface(pos,.6+.5*lensing,t))),1.0);

					}
					`;

						//************** Utility functions **************

						function onWindowResize() {
							canvas.width = window.innerWidth; //Math.min(window.innerWidth, window.innerHeight);
							canvas.height = window.innerHeight;
							gl.viewport(0, 0, canvas.width, canvas.height);
							gl.uniform1f(widthHandle, canvas.width);
							gl.uniform1f(heightHandle, canvas.height);
						}

						//Compile shader and combine with source
						function compileShader(shaderSource, shaderType) {
							var shader = gl.createShader(shaderType);
							gl.shaderSource(shader, shaderSource);
							gl.compileShader(shader);
							if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {
								throw 'Shader compile failed with: ' + gl.getShaderInfoLog(shader);
							}
							return shader;
						}

						function getAttribLocation(program, name) {
							var attributeLocation = gl.getAttribLocation(program, name);
							if (attributeLocation === -1) {
								throw 'Cannot find attribute ' + name + '.';
							}
							return attributeLocation;
						}

						function getUniformLocation(program, name) {
							var attributeLocation = gl.getUniformLocation(program, name);
							if (attributeLocation === -1) {
								throw 'Cannot find uniform ' + name + '.';
							}
							return attributeLocation;
						}

						//=============== Create shaders ==============

						var canvas = document.getElementById('canvas');
						var gl = canvas.getContext('webgl');
						window.onload = onWindowResize;
						window.addEventListener('resize', onWindowResize, false);

						//Create vertex and fragment shaders
						var vertexShader = compileShader(vertexSource, gl.VERTEX_SHADER);
						var fragmentShader = compileShader(fragmentSource, gl.FRAGMENT_SHADER);

						//Create shader programs
						var program = gl.createProgram();
						gl.attachShader(program, vertexShader);
						gl.attachShader(program, fragmentShader);
						gl.linkProgram(program);
						gl.useProgram(program);

						//Set up rectangle covering entire canvas
						var vertexData = new Float32Array([
							-1.0,
							1.0, // top left
							-1.0,
							-1.0, // bottom left
							1.0,
							1.0, // top right
							1.0,
							-1.0, // bottom right
						]);

						//Create vertex buffer
						var vertexDataBuffer = gl.createBuffer();
						gl.bindBuffer(gl.ARRAY_BUFFER, vertexDataBuffer);
						gl.bufferData(gl.ARRAY_BUFFER, vertexData, gl.STATIC_DRAW);

						// Layout of our data in the vertex buffer
						var positionHandle = getAttribLocation(program, 'position');

						gl.enableVertexAttribArray(positionHandle);
						gl.vertexAttribPointer(
							positionHandle,
							2, // position is a vec2 (2 values per component)
							gl.FLOAT, // each component is a float
							false, // don't normalize values
							2 * 4, // two 4 byte float components per vertex (32 bit float is 4 bytes) (stride)
							0 // how many bytes inside the buffer to start from (offset)
						);

						//Set uniform handle
						var timeHandle = getUniformLocation(program, 'time');
						var widthHandle = getUniformLocation(program, 'width');
						var heightHandle = getUniformLocation(program, 'height');

						//================= initialize! ============================
						//Time
						var dt = 0.0;
						var time = 39.0;

						function draw() {
							time += dt;

							gl.uniform1f(timeHandle, time);
							//Draw a triangle strip connecting vertices 0-4
							gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);

							requestAnimationFrame(draw);
						}

						draw();
					</script>
					<div class="background-grid"></div>
					<div class="gradient-orb orb-1"></div>
					<div class="gradient-orb orb-2"></div>
					<div class="top-nav">
						<div class="nav-left">

						</div>
						<div class="nav-right">
							<div class="auth-container" id="authContainer">
								<div class="auth-logged-out" id="authLoggedOut">
									<div class="auth-actions">
										<button class="auth-btn auth-btn-ghost" id="loginBtn">
											<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"/>
												<polyline points="10,17 15,12 10,7"/>
												<line x1="15" y1="12" x2="3" y2="12"/>
											</svg>
											Sign in
										</button>
										<button class="auth-btn auth-btn-primary" id="registerBtn">
											Get started
										</button>
									</div>
								</div>
								<div class="auth-logged-in" id="authLoggedIn" style="display: none;">
									<div class="user-menu">
										<button class="user-trigger" id="userMenuTrigger">
											<div class="user-avatar">
												<span class="user-initials" id="userInitials">U</span>
											</div>
											<div class="user-info">
												<span class="username" id="username">Loading...</span>
												<span class="user-role" id="userRole">user</span>
											</div>
											<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<polyline points="6,9 12,15 18,9"/>
											</svg>
										</button>
										<div class="user-dropdown" id="userDropdown">
											<div class="dropdown-item" id="dashboardBtn">
												<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
													<rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
													<line x1="9" y1="9" x2="15" y2="9"/>
													<line x1="9" y1="15" x2="15" y2="15"/>
												</svg>
												Dashboard
											</div>
											<div class="dropdown-item" id="fileViewerBtn">
												<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
													<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
												</svg>
												Files
											</div>
											<div class="dropdown-divider"></div>
											<div class="dropdown-item" id="logoutBtn">
												<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
													<path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
													<polyline points="16,17 21,12 16,7"/>
													<line x1="21" y1="12" x2="9" y2="12"/>
												</svg>
												Sign out
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="container mx-auto" id="main-area">
						<div class="header">
							<h1 class="logo">JWLimited CDN</h1>
							<p class="tagline">Professional Asset Delivery Network</p>
						</div>

						<div class="search-container">
							<button class="upload-btn" id="uploadBtn" title="Upload Asset">
								<svg
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								>
									<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
									<polyline points="17,8 12,3 7,8" />
									<line x1="12" y1="3" x2="12" y2="15" />
								</svg>
							</button>
							<div class="search-wrapper">
								<svg
									class="search-icon"
									xmlns="http://www.w3.org/2000/svg"
									viewBox="0 0 24 24"
									fill="none"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								>
									<circle cx="11" cy="11" r="8" />
									<path d="m21 21-4.35-4.35" />
								</svg>

								<div class="loading-spinner" id="loadingSpinner"></div>
								<input
									type="text"
									class="search-input"
									placeholder="Search assets, images, fonts, styles..."
									id="searchInput"
									autocomplete="off"
									spellcheck="false"
								/>
							</div>
						</div>

						<div class="results-container" id="resultsContainer">
							<div class="results-grid" id="resultsGrid"></div>
						</div>
					</div>

					<div class="footer" id="footer">
						<div class="footer-links">
							<a href="#" class="footer-link" id="statusLink">Status</a>
							<a href="#" class="footer-link" id="apiLink">API</a>
							<a href="#" class="footer-link" id="devToolsLink">DevTools</a>
						</div>
						<p>Powered by Cloudflare Workers â€¢ Global Edge Network</p>
					</div>
				</div>
			</main>

			<div class="modal-wrapper" id="modalWrapper">
				<div class="auth-modal needs-shadow" modal-animate="true" id="authModal">
					<div class="modal-backdrop"></div>
					<div class="modal-background-content">
					</div>
					<div class="auth-modal-content">
						<div class="modal-handle"></div>
						<div class="auth-modal-wrapper">
							<div class="auth-modal-header">
								<button class="auth-close-btn" id="authCloseBtn">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<line x1="18" y1="6" x2="6" y2="18"/>
										<line x1="6" y1="6" x2="18" y2="18"/>
									</svg>
								</button>
								<div class="auth-header-content">
									<h2 class="auth-modal-title" id="authModalTitle">Sign in</h2>
									<p class="auth-modal-subtitle" id="authModalSubtitle">Welcome back to JWLimited CDN</p>
								</div>
							</div>
		
							<div class="auth-modal-body">
								<form class="auth-form" id="authForm">
									<div class="auth-form-group" id="usernameGroup">
										<label class="auth-form-label" for="authUsername">Username</label>
										<input type="text" class="auth-form-input" id="authUsername" required placeholder="Enter your username">
									</div>
									<div class="auth-form-group" id="emailGroup" style="display: none;">
										<label class="auth-form-label" for="authEmail">Email</label>
										<input type="email" class="auth-form-input" id="authEmail" placeholder="Enter your email">
									</div>
									<div class="auth-form-group">
										<label class="auth-form-label" for="authPassword">Password</label>
										<input type="password" class="auth-form-input" id="authPassword" required placeholder="Enter your password">
									</div>
									<div class="auth-form-group" id="totpGroup" style="display: none;">
										<label class="auth-form-label" for="authTotp">2FA Code</label>
										<input type="text" class="auth-form-input" id="authTotp" placeholder="Enter 6-digit code" maxlength="6">
									</div>
		
									<div id="authMessage"></div>
		
									<div class="auth-form-actions">
										<button type="submit" class="auth-submit-btn" id="authSubmit">
											<span class="auth-btn-text">Sign in</span>
											<div class="auth-btn-loading" style="display: none;">
												<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
													<path d="M21 12a9 9 0 11-6.219-8.56"/>
												</svg>
											</div>
										</button>
									</div>
								</form>
		
								<div class="auth-form-switch">
									<span id="authSwitchText">Don't have an account?</span>
									<button type="button" class="auth-switch-btn" id="authSwitchBtn">Get started</button>
								</div>
							</div>
						</div>
					</div>
				</div>
		
				<div class="dashboard-modal needs-shadow" modal-animate="true" id="dashboardModal">
					<div class="modal-backdrop"></div>
					<div class="modal-background-content">
					</div>
					<div class="dashboard-modal-content">
						<div class="modal-handle"></div>
						<div class="dashboard-wrapper">
							<!-- Dashboard Header -->
							<div class="dashboard-header">
								<div class="dashboard-header-left">
									<div class="dashboard-title-section">
										<h1 class="dashboard-title">Dashboard</h1>
										<p class="dashboard-subtitle">Welcome back, <span id="dashboardUsername">User</span></p>
									</div>
								</div>
								<div class="dashboard-header-right">
									<button class="dashboard-close-btn" id="dashboardClose">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<line x1="18" y1="6" x2="6" y2="18"/>
											<line x1="6" y1="6" x2="18" y2="18"/>
										</svg>
									</button>
								</div>
							</div>
		
							<!-- Dashboard Content -->
							<div class="dashboard-content">
								<!-- Stats Grid -->
								<div class="dashboard-section">
									<div class="section-header">
										<h3 class="section-title">Overview</h3>
										<p class="section-subtitle">Your account usage and statistics</p>
									</div>
									<div class="dashboard-stats" id="dashboardStats">
										<!-- Stats will be loaded dynamically -->
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
		
				<div class="dashboard-modal needs-shadow" modal-animate="true" id="statusModal">
					<div class="modal-backdrop"></div>
					<div class="modal-background-content">
					</div>
					<div class="dashboard-modal-content">
						<div class="modal-handle"></div>
						<div class="dashboard-wrapper">
							<div class="dashboard-header">
								<div class="dashboard-header-left">
									<div class="dashboard-title-section">
										<h1 class="dashboard-title">System Status</h1>
										<p class="dashboard-subtitle">Real-time CDN performance and global network status</p>
									</div>
								</div>
								<div class="dashboard-header-right">
									<button class="dashboard-close-btn" id="statusClose">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<line x1="18" y1="6" x2="6" y2="18"/>
											<line x1="6" y1="6" x2="18" y2="18"/>
										</svg>
									</button>
								</div>
							</div>
		
							<!-- Status Content -->
							<div class="dashboard-content">
								<div class="status-grid">
									<!-- System Stats -->
									<div class="status-section">
										<div class="section-header">
											<h3 class="section-title">Performance Metrics</h3>
											<p class="section-subtitle">Current system performance indicators</p>
										</div>
										<div class="dashboard-stats" id="systemStats">
											<!-- System stats will be loaded dynamically -->
										</div>
									</div>
		
									<!-- Global Network Map -->
									<div class="status-section">
										<div class="section-header">
											<h3 class="section-title">Global Network</h3>
											<p class="section-subtitle">Cloudflare CDN edge locations worldwide</p>
										</div>
										<div class="network-map-container">
											<div class="network-map" id="networkMap">
												<!-- Network map will be loaded here -->
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
		
				<div class="dashboard-modal needs-shadow" modal-animate="true" id="apiModal">
					<div class="modal-backdrop"></div>
					<div class="modal-background-content">
						<!-- Background content will be copied here -->
					</div>
					<div class="dashboard-modal-content">
						<div class="modal-handle"></div>
						<div class="dashboard-wrapper">
							<!-- API Header -->
							<div class="dashboard-header">
								<div class="dashboard-header-left">
									<div class="dashboard-title-section">
										<h1 class="dashboard-title">API Documentation</h1>
										<p class="dashboard-subtitle">Developer resources and API endpoints</p>
									</div>
								</div>
								<div class="dashboard-header-right">
									<button class="dashboard-close-btn" id="apiClose">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<line x1="18" y1="6" x2="6" y2="18"/>
											<line x1="6" y1="6" x2="18" y2="18"/>
										</svg>
									</button>
								</div>
							</div>
		
							<!-- API Content -->
							<div class="dashboard-content">
								<div class="api-sections" id="apiSections">
									<!-- API endpoints will be loaded dynamically -->
								</div>
							</div>
						</div>
					</div>
				</div>
		
				<div class="dashboard-modal needs-shadow" modal-animate="true" id="devToolsModal">
					<div class="modal-backdrop"></div>
					<div class="modal-background-content">
					</div>
					<div class="dashboard-modal-content">
						<div class="modal-handle"></div>
						<div class="dashboard-wrapper">
							<div class="dashboard-header">
								<div class="dashboard-header-left">
									<div class="dashboard-title-section">
										<h1 class="dashboard-title">Developer Tools</h1>
										<p class="dashboard-subtitle">Advanced debugging and development utilities</p>
									</div>
								</div>
								<div class="dashboard-header-right">
									<button class="dashboard-close-btn" id="devToolsClose">
										<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<line x1="18" y1="6" x2="6" y2="18"/>
											<line x1="6" y1="6" x2="18" y2="18"/>
										</svg>
									</button>
								</div>
							</div>
		
							<!-- Dev Tools Content -->
							<div class="dashboard-content">
								<div class="devtools-sections" id="devToolsSections">
									<!-- Dev tools will be loaded dynamically -->
								</div>
							</div>
						</div>
					</div>
				</div>
		
				<div class="upload-modal needs-shadow" modal-animate="true" id="uploadModal">
					<div class="modal-background-content">
						<div class="container">
							<div class="search-container">
								<div class="search-wrapper">
									<svg
										class="search-icon"
										xmlns="http://www.w3.org/2000/svg"
										viewBox="0 0 24 24"
										fill="none"
										stroke="currentColor"
										stroke-width="2"
									>
										<circle cx="11" cy="11" r="8" />
										<path d="m21 21-4.35-4.35" />
									</svg>
									<input type="text" id="searchInputBg" placeholder="Search assets..." class="search-input" disabled />
									<button class="upload-btn" disabled>
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
											<polyline points="17,8 12,3 7,8" />
											<line x1="12" y1="3" x2="12" y2="15" />
										</svg>
									</button>
								</div>
							</div>
						</div>
					</div>
					<div class="upload-modal-content">
						<div class="modal-handle"></div>
						<div class="modal-content-wrapper">
							<div class="upload-left-panel">
								<div class="modal-header">
									<h2 class="modal-title">Upload Asset</h2>
									<button class="modal-close" id="modalClose">
										<svg
											xmlns="http://www.w3.org/2000/svg"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
											stroke-linecap="round"
											stroke-linejoin="round"
										>
											<line x1="18" y1="6" x2="6" y2="18"></line>
											<line x1="6" y1="6" x2="18" y2="18"></line>
										</svg>
									</button>
								</div>
		
								<div class="upload-tabs">
									<button class="upload-tab active" data-tab="direct">Direct Upload</button>
									<button class="upload-tab" data-tab="database">Database Storage</button>
								</div>
		
								<div class="upload-content active" id="directTab">
									<div class="file-drop-zone" id="dropZone">
										<svg
											class="drop-zone-icon"
											xmlns="http://www.w3.org/2000/svg"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
											<polyline points="17,8 12,3 7,8" />
											<line x1="12" y1="3" x2="12" y2="15" />
										</svg>
										<h3>Drop files here or click to browse</h3>
										<p>Supports images, videos, audio, fonts, and documents</p>
										<input
											type="file"
											id="fileInput"
											style="display: none"
											multiple
											accept="image/*,video/*,audio/*,.css,.js,.json,.html,.woff,.woff2,.ttf,.eot,.otf,.pdf"
										/>
									</div>
		
									<div id="filePreview"></div>
		
									<div class="form-group">
										<label class="form-label">Upload Path Hint (Optional)</label>
										<input type="text" class="form-input" id="uploadPath" placeholder="Leave empty for auto-obfuscation" value="" />
										<small style="color: hsl(var(--muted-foreground)); font-size: 0.8rem; margin-top: 0.5rem; display: block">
											Files will be stored with cryptographically obfuscated paths regardless of this setting
										</small>
									</div>
		
									<div class="upload-progress" id="uploadProgress">
										<div class="progress-bar">
											<div class="progress-fill" id="progressFill"></div>
										</div>
										<div class="progress-text" id="progressText">Uploading...</div>
									</div>
								</div>
		
								<!-- Database Storage Tab -->
								<div class="upload-content" id="databaseTab">
									<div class="file-drop-zone" id="dropZoneDb">
										<svg
											class="drop-zone-icon"
											xmlns="http://www.w3.org/2000/svg"
											viewBox="0 0 24 24"
											fill="none"
											stroke="currentColor"
											stroke-width="2"
										>
											<ellipse cx="12" cy="5" rx="9" ry="3" />
											<path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3" />
											<path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5" />
										</svg>
										<h3>Store in D1 Database</h3>
										<p>Metadata stored in D1, files in CDN</p>
										<input
											type="file"
											id="fileInputDb"
											style="display: none"
											multiple
											accept="image/*,video/*,audio/*,.css,.js,.json,.html,.woff,.woff2,.ttf,.eot,.otf,.pdf"
										/>
									</div>
		
									<div id="filePreviewDb"></div>
		
									<div class="form-group">
										<label class="form-label">Asset Name</label>
										<input type="text" class="form-input" id="assetName" placeholder="Enter asset name" />
									</div>
		
									<div class="form-group">
										<label class="form-label">Category</label>
										<select class="form-select" id="assetCategory">
											<option value="icons">Icons</option>
											<option value="images">Images</option>
											<option value="media">Media</option>
											<option value="sounds">Sounds</option>
											<option value="backgrounds">Backgrounds</option>
											<option value="placeholders">Placeholders</option>
											<option value="styles">Styles</option>
											<option value="scripts">Scripts</option>
											<option value="fonts">Fonts</option>
											<option value="documents">Documents</option>
											<option value="custom">Custom</option>
										</select>
									</div>
		
									<div class="form-group">
										<label class="form-label">Description</label>
										<textarea class="form-textarea" id="assetDescription" placeholder="Optional description"></textarea>
									</div>
		
									<div class="form-group">
										<label class="form-label">Tags (comma-separated)</label>
										<input type="text" class="form-input" id="assetTags" placeholder="tag1, tag2, tag3" />
									</div>
		
									<div class="upload-progress" id="uploadProgressDb">
										<div class="progress-bar">
											<div class="progress-fill" id="progressFillDb"></div>
										</div>
										<div class="progress-text" id="progressTextDb">Uploading...</div>
									</div>
								</div>
		
								<div class="modal-actions">
									<button class="btn btn-secondary" id="cancelBtn">Cancel</button>
									<button class="btn btn-primary" id="uploadSubmit">Upload</button>
								</div>
							</div>
		
							<!-- Right Panel -->
							<div class="upload-right-panel">
								<div class="upload-background-pattern"></div>
								<div class="upload-icon-display" id="uploadIconDisplay">
									<svg
										xmlns="http://www.w3.org/2000/svg"
										viewBox="0 0 24 24"
										fill="none"
										stroke="currentColor"
										stroke-width="2"
										stroke-linecap="round"
										stroke-linejoin="round"
									>
										<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
										<polyline points="17,8 12,3 7,8" />
										<line x1="12" y1="3" x2="12" y2="15" />
									</svg>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="file-editor-modal" id="fileEditorModal">
				<div class="modal-background-content">
					<div class="container">
						<div class="search-container">
							<div class="search-wrapper">
								<svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<circle cx="11" cy="11" r="8" />
									<path d="m21 21-4.35-4.35" />
								</svg>
								<input type="text" id="searchInputEditor" placeholder="Search files..." class="search-input" disabled />
								<button class="upload-btn" disabled>
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" />
										<polyline points="17,8 12,3 7,8" />
										<line x1="12" y1="3" x2="12" y2="15" />
									</svg>
								</button>
							</div>
						</div>
					</div>
				</div>
				<div class="file-editor-modal-content">
					<div class="modal-handle"></div>
					<div class="modal-content-wrapper">
						<div class="file-editor-left-panel needs-scrolling">
							<div class="modal-header" style="padding: 0rem 1.5rem  20px 1.5rem; margin-bottom: 0px !important;">
								<div class="editor-header-content">
									<div class="editor-title-group">
										<h2 class="modal-title">Editor</h2>
										<p class="modal-subtitle">Edit files with version control</p>
									</div>
								</div>
								<button class="modal-close" id="fileEditorClose">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<line x1="18" y1="6" x2="6" y2="18"></line>
										<line x1="6" y1="6" x2="18" y2="18"></line>
									</svg>
								</button>
							</div>

							<div class="file-selector-section" style="padding: 0.5rem !important;">
								<div class="file-search-container" style="margin-bottom: 1rem; display: inline-flex; width: 100%; justify-content: space-between; align-items: center; gap: 0.5rem;">
									<div class="search-input-wrapper" style="width: 100%;">
										<svg class="search-icon-small" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<circle cx="11" cy="11" r="8" />
											<path d="m21 21-4.35-4.35" />
										</svg>
										<input type="text" id="fileSearchInput" placeholder="Search your files..." class="file-search-input" />
									</div>
									<button style="width: 3rem; height: 3rem; border-radius: 18%;" class="refresh-files-btn" id="refreshFilesBtn" title="Refresh file list">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
											<path d="M21 3v5h-5" />
											<path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" />
											<path d="M3 21v-5h5" />
										</svg>
									</button>
								</div>
								<div class="file-list-container needs-scrolling" id="fileListContainer">
									<div class="loading-spinner">
										<div class="spinner"></div>
										<span>Loading files...</span>
									</div>
								</div>
							</div>
							<div class="current-file-section" id="currentFileSection" style="display: none;">
								<div class="section-header">
									<h3>Current File</h3>
									<div class="file-actions-quick">
										<button class="action-btn" id="viewVersionsBtn" title="View version history">
											<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" />
												<path d="M3 3v5h5" />
											</svg>
										</button>
										<button class="action-btn" id="downloadFileBtn" title="Download file">
											<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-15" />
												<polyline points="7,10 12,15 17,10" />
												<line x1="12" y1="15" x2="12" y2="3" />
											</svg>
										</button>
									</div>
								</div>
								<div class="current-file-info" id="currentFileInfo">
									<!-- File info will be populated here -->
								</div>
							</div>

							<!-- Save Actions -->
							<div class="save-actions-section" id="saveActionsSection" style="display: none;">
								<div class="section-header">
									<h3>Save Changes</h3>
								</div>
								<div class="save-options">
									<div class="form-group">
										<label class="form-label">Change Description</label>
										<textarea class="form-textarea" id="changeDescription" placeholder="Describe your changes..." rows="3"></textarea>
									</div>
									<div class="save-buttons">
										<button class="btn btn-secondary" id="discardChangesBtn">
											<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<path d="M3 6h18" />
												<path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
												<path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
											</svg>
											Discard
										</button>
										<button class="btn btn-primary" id="saveChangesBtn">
											<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
												<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z" />
												<polyline points="17,21 17,13 7,13 7,21" />
												<polyline points="7,3 7,8 15,8" />
											</svg>
											Save Changes
										</button>
									</div>
								</div>
							</div>
						</div>

						<!-- Right Panel - Editor -->
						<div class="file-editor-right-panel">
							<div class="editor-container">
								<!-- Editor Tabs -->
								<div class="editor-tabs" id="editorTabs">
									<div class="editor-tab active" data-tab="content">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
											<polyline points="14,2 14,8 20,8" />
										</svg>
										Content
									</div>
									<div class="editor-tab" data-tab="info">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<circle cx="12" cy="12" r="10" />
											<line x1="12" y1="16" x2="12" y2="12" />
											<line x1="12" y1="8" x2="12.01" y2="8" />
										</svg>
										Info
									</div>
									<div class="editor-tab" data-tab="metadata">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<path d="M12.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L12.5 2z" />
											<path d="M14 2v6h6" />
											<path d="M16 13H8" />
											<path d="M16 17H8" />
											<path d="M10 9H8" />
										</svg>
										Metadata
									</div>
									<div class="editor-tab" data-tab="preview">
										<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
											<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" />
											<circle cx="12" cy="12" r="3" />
										</svg>
										Preview
									</div>
								</div>

								<!-- Editor Content Areas -->
								<div class="editor-content-areas">
									<!-- Content Editor -->
									<div class="editor-area active" id="contentEditor">
										<div class="editor-toolbar">
											<div class="toolbar-section">
												<button class="toolbar-btn" id="undoBtn" title="Undo (Ctrl+Z)">
													<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
														<path d="M3 7v6h6" />
														<path d="M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13" />
													</svg>
												</button>
												<button class="toolbar-btn" id="redoBtn" title="Redo (Ctrl+Y)">
													<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
														<path d="M21 7v6h-6" />
														<path d="M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7" />
													</svg>
												</button>
											</div>
											<div class="toolbar-section">
												<button class="toolbar-btn" id="formatBtn" title="Format Code (Ctrl+Shift+F)">
													<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
														<polyline points="16,3 21,3 21,8" />
														<line x1="4" y1="20" x2="21" y2="3" />
														<polyline points="21,16 21,21 16,21" />
														<line x1="15" y1="15" x2="21" y2="21" />
														<line x1="4" y1="4" x2="9" y2="9" />
													</svg>
												</button>
												<button class="toolbar-btn" id="wrapBtn" title="Toggle Word Wrap">
													<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
														<polyline points="3,6 21,6" />
														<polyline points="3,12 15,12" />
														<polyline points="3,18 12,18" />
													</svg>
												</button>
											</div>
											<div class="toolbar-section">
												<select class="language-select" id="languageSelect">
													<option value="auto">Auto-detect</option>
													<option value="javascript">JavaScript</option>
													<option value="typescript">TypeScript</option>
													<option value="html">HTML</option>
													<option value="css">CSS</option>
													<option value="json">JSON</option>
													<option value="markdown">Markdown</option>
													<option value="text">Plain Text</option>
												</select>
											</div>
										</div>
										<div class="code-editor-container">
											<div class="line-numbers" id="lineNumbers"></div>
											<textarea class="code-editor" id="codeEditor" placeholder="Select a file to start editing..."></textarea>
										</div>
										<div class="editor-status-bar">
											<div class="status-left">
												<span class="status-item" id="cursorPosition">Line 1, Column 1</span>
												<span class="status-item" id="fileSize">0 bytes</span>
												<span class="status-item" id="changeStatus">No changes</span>
											</div>
											<div class="status-right">
												<span class="status-item" id="encoding">UTF-8</span>
												<span class="status-item" id="fileType">Plain Text</span>
											</div>
										</div>
									</div>

									<!-- Info Area -->
									<div class="editor-area" id="infoArea">
										<div class="info-container">
											<div class="info-section">
												<h4>File Information</h4>
												<div class="info-grid">
													<div class="info-item">
														<span class="info-label">File Name:</span>
														<span class="info-value" id="infoFileName">-</span>
													</div>
													<div class="info-item">
														<span class="info-label">File Size:</span>
														<span class="info-value" id="infoFileSize">-</span>
													</div>
													<div class="info-item">
														<span class="info-label">MIME Type:</span>
														<span class="info-value" id="infoMimeType">-</span>
													</div>
													<div class="info-item">
														<span class="info-label">Created:</span>
														<span class="info-value" id="infoCreated">-</span>
													</div>
													<div class="info-item">
														<span class="info-label">Modified:</span>
														<span class="info-value" id="infoModified">-</span>
													</div>
													<div class="info-item">
														<span class="info-label">File ID:</span>
														<span class="info-value" id="infoFileId">-</span>
													</div>
												</div>
											</div>

											<div class="info-section">
												<div class="info-section-header">
													<h4>Version History</h4>
													<button class="refresh-versions-btn" id="refreshVersionsBtn" title="Refresh versions">
														<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
															<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" />
															<path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" />
														</svg>
													</button>
												</div>
												<div class="versions-container" id="versionsContainer">
													<div class="versions-loading">
														<div class="spinner"></div>
														<span>Loading versions...</span>
													</div>
												</div>
											</div>
										</div>
									</div>

									<!-- Metadata Editor -->
									<div class="editor-area" id="metadataEditor">
										<div class="metadata-form">
											<div class="form-section">
												<h4>Basic Information</h4>
												<div class="form-group">
													<label class="form-label">File Name</label>
													<input type="text" class="form-input" id="metaFileName" placeholder="Enter file name" />
												</div>
												<div class="form-group">
													<label class="form-label">Description</label>
													<textarea class="form-textarea" id="metaDescription" placeholder="Describe this file..." rows="3"></textarea>
												</div>
											</div>

											<div class="form-section">
												<h4>Organization</h4>
												<div class="form-group">
													<label class="form-label">Category</label>
													<select class="form-select" id="metaCategory">
														<option value="">Select category</option>
														<option value="icons">Icons</option>
														<option value="images">Images</option>
														<option value="media">Media</option>
														<option value="sounds">Sounds</option>
														<option value="backgrounds">Backgrounds</option>
														<option value="styles">Styles</option>
														<option value="scripts">Scripts</option>
														<option value="fonts">Fonts</option>
														<option value="documents">Documents</option>
														<option value="custom">Custom</option>
													</select>
												</div>
												<div class="form-group">
													<label class="form-label">Tags</label>
													<div class="tags-input-container">
														<input type="text" class="form-input" id="metaTags" placeholder="Add tags (press Enter)" />
														<div class="tags-display" id="tagsDisplay"></div>
													</div>
												</div>
											</div>

											<div class="form-section">
												<h4>Custom Fields</h4>
												<div class="custom-fields-container" id="customFieldsContainer">
													<button class="add-field-btn" id="addCustomFieldBtn">
														<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
															<line x1="12" y1="5" x2="12" y2="19" />
															<line x1="5" y1="12" x2="19" y2="12" />
														</svg>
														Add Custom Field
													</button>
												</div>
											</div>
										</div>
									</div>

									<!-- Preview Area -->
									<div class="editor-area" id="previewArea">
										<div class="preview-container" id="previewContainer">
											<div class="preview-placeholder">
												<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
													<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z" />
													<circle cx="12" cy="12" r="3" />
												</svg>
												<h3>File Preview</h3>
												<p>Select a file to see its preview</p>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="success-modal" id="successModal">
				<div class="success-modal-content">
					<div class="success-checkmark">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="3"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<polyline points="20,6 9,17 4,12" />
						</svg>
					</div>

					<h1 class="success-title">Upload Successful!</h1>
					<p class="success-subtitle">Your asset has been uploaded and is now available on the CDN</p>

					<div class="server-details">
						<h3>Server & Service Details</h3>
						<div class="detail-row">
							<span class="detail-label">CDN Service</span>
							<span class="detail-value">JWLimited Professional CDN</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Edge Network</span>
							<span class="detail-value">Cloudflare Global</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Storage Method</span>
							<span class="detail-value" id="storageMethod">Direct Upload</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Obfuscated URL</span>
							<span class="detail-value" id="assetUrl" style="font-family: monospace; font-size: 0.85rem; word-break: break-all"
								>Processing...</span
							>
						</div>
						<div class="detail-row" id="originalPathRow" style="display: none">
							<span class="detail-label">Original Path Hint</span>
							<span class="detail-value" id="originalPath" style="font-family: monospace; font-size: 0.85rem">-</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">File Size</span>
							<span class="detail-value" id="fileSize">0 bytes</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Upload Time</span>
							<span class="detail-value" id="uploadTime">Just now</span>
						</div>
						<div class="detail-row">
							<span class="detail-label">Cache Status</span>
							<span class="detail-value">Cached & Optimized</span>
						</div>
					</div>

					<div class="success-actions">
						<button class="btn btn-primary" id="copyUrlBtn">Copy URL</button>
						<button class="btn btn-secondary" id="viewAssetBtn">View Asset</button>
						<button class="btn btn-secondary" id="closeSuccessBtn">Close</button>
					</div>
				</div>
			</div>

			<div class="file-viewer-panel" id="fileViewerPanel">
				<div class="file-viewer-header">
					<div class="file-viewer-title-section">
						<div class="file-viewer-icon">
							<svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
							</svg>
						</div>
						<div class="file-viewer-title-text">
							<h3 class="file-viewer-title">Files</h3>
							<p class="file-viewer-subtitle">Your uploaded assets</p>
						</div>
					</div>
					<div class="file-viewer-actions">
						<button class="file-viewer-refresh" id="fileViewerRefresh" title="Refresh">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
								<path d="M21 3v5h-5"/>
								<path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
								<path d="M3 21v-5h5"/>
							</svg>
						</button>
						<button class="file-viewer-close" id="fileViewerClose" title="Close">
							<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="18" y1="6" x2="6" y2="18"/>
								<line x1="6" y1="6" x2="18" y2="18"/>
							</svg>
						</button>
					</div>
				</div>
				<div class="file-viewer-content">
					<div class="file-viewer-stats">
						<div class="file-stat">
							<span class="file-stat-value" id="fileStatCount">0</span>
							<span class="file-stat-label">Files</span>
						</div>
						<div class="file-stat">
							<span class="file-stat-value" id="fileStatSize">0 B</span>
							<span class="file-stat-label">Used</span>
						</div>
					</div>
					<div class="file-viewer-list" id="fileViewerList">
						<!-- Files will be loaded here -->
					</div>
				</div>
			</div>
		</div>
		<script>
			class AssetSearch {
				constructor() {
					this.searchInput = document.getElementById('searchInput');
					this.loadingSpinner = document.getElementById('loadingSpinner');
					this.resultsContainer = document.getElementById('resultsContainer');
					this.resultsGrid = document.getElementById('resultsGrid');

					this.debounceTimer = null;
					this.cache = new Map();

					// Upload modal elements
					this.uploadBtn = document.getElementById('uploadBtn');
					this.uploadModal = document.getElementById('uploadModal');
					this.modalClose = document.getElementById('modalClose');
					this.cancelBtn = document.getElementById('cancelBtn');
					this.uploadSubmit = document.getElementById('uploadSubmit');
					this.uploadIconDisplay = document.getElementById('uploadIconDisplay');

					// Success modal elements
					this.successModal = document.getElementById('successModal');
					this.copyUrlBtn = document.getElementById('copyUrlBtn');
					this.viewAssetBtn = document.getElementById('viewAssetBtn');
					this.closeSuccessBtn = document.getElementById('closeSuccessBtn');

					this.currentTab = 'direct';
					this.selectedFiles = [];
					this.lastUploadResult = null;

					this.init();
					this.initUpload();
				}

				init() {
					this.searchInput.addEventListener('input', (e) => {
						this.handleSearch(e.target.value);
					});

					this.searchInput.addEventListener('keydown', (e) => {
						if (e.key === 'Enter') {
							e.preventDefault();
							this.handleSearch(e.target.value, true);
						}
					});

					// Focus search on load
					this.searchInput.focus();

					// Keyboard shortcuts
					document.addEventListener('keydown', (e) => {
						if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
							e.preventDefault();
							this.searchInput.focus();
							this.searchInput.select();
						}
					});
				}

				handleSearch(query, immediate = false) {
					clearTimeout(this.debounceTimer);

					if (!query.trim()) {
						this.hideResults();
						return;
					}

					const delay = immediate ? 0 : 300;

					this.debounceTimer = setTimeout(() => {
						this.performSearch(query.trim());
					}, delay);
				}

				async performSearch(query) {
					if (this.cache.has(query)) {
						this.displayResults(this.cache.get(query), query);
						return;
					}

					this.showLoading();

					try {
						const response = await fetch(`/api/search?q=${encodeURIComponent(query)}&limit=12`);
						const data = await response.json();

						if (response.ok) {
							this.cache.set(query, data.results || []);
							this.displayResults(data.results || [], query);
						} else {
							this.displayError(data.error || 'Search failed');
						}
					} catch (error) {
						console.error('Search error:', error);
						this.displayError('Network error occurred');
					} finally {
						this.hideLoading();
					}
				}

				displayResults(results, query) {
					this.resultsGrid.innerHTML = '';

					if (results.length === 0) {
						this.displayNoResults(query);
						return;
					}

					results.forEach((result, index) => {
						const card = this.createResultCard(result, index);
						this.resultsGrid.appendChild(card);
					});

					this.showResults();
				}

				createResultCard(result, index) {
					const card = document.createElement('div');
					card.className = 'result-card';
					card.style.animationDelay = `${index * 50}ms`;

					const icon = this.getFileIcon(result.type);
					const size = result.size ? this.formatFileSize(result.size) : '';
					const modified = result.lastModified ? this.formatDate(result.lastModified) : '';

					card.innerHTML = `
                    <div class="result-icon">${icon}</div>
                    <div class="result-title">${this.escapeHtml(result.name)}</div>
                    <div class="result-path">${this.escapeHtml(result.path)}</div>
                    <div class="result-meta">
                        <span class="result-tag">${result.type}</span>
                        ${size ? `<span class="result-tag">${size}</span>` : ''}
                        ${modified ? `<span class="result-tag">${modified}</span>` : ''}
                    </div>
                `;

					card.addEventListener('click', () => {
						this.openAsset(result.path);
					});

					return card;
				}

				getFileIcon(type) {
					const icons = {
						image: 'ðŸ–¼ï¸',
						font: 'ðŸ”¤',
						css: 'ðŸŽ¨',
						js: 'âš¡',
						json: 'ðŸ“‹',
						html: 'ðŸŒ',
						video: 'ðŸŽ¬',
						audio: 'ðŸŽµ',
						document: 'ðŸ“„',
						archive: 'ðŸ“¦',
					};
					return icons[type] || 'ðŸ“„';
				}

				formatFileSize(bytes) {
					if (bytes === 0) return '0 B';
					const k = 1024;
					const sizes = ['B', 'KB', 'MB', 'GB'];
					const i = Math.floor(Math.log(bytes) / Math.log(k));
					return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
				}

				formatDate(timestamp) {
					const date = new Date(timestamp);
					const now = new Date();
					const diff = now - date;
					const days = Math.floor(diff / (1000 * 60 * 60 * 24));

					if (days === 0) return 'Today';
					if (days === 1) return 'Yesterday';
					if (days < 7) return `${days}d ago`;
					return date.toLocaleDateString();
				}

				displayNoResults(query) {
					this.resultsGrid.innerHTML = `
                    <div class="no-results">
                        <svg class="no-results-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <path d="m21 21-4.35-4.35"/>
                            <path d="M11 8v3"/>
                            <path d="M11 14h.01"/>
                        </svg>
                        <p>No assets found for "${this.escapeHtml(query)}"</p>
                        <p style="font-size: 0.8rem; margin-top: 0.5rem; opacity: 0.7;">Try different keywords or browse our asset categories</p>
                    </div>
                `;
					this.showResults();
				}

				displayError(message) {
					this.resultsGrid.innerHTML = `
                    <div class="no-results">
                        <p style="color: hsl(var(--destructive));">âš ï¸ ${this.escapeHtml(message)}</p>
                    </div>
                `;
					this.showResults();
				}

				openAsset(path) {
					// Create a temporary link and click it to open/download the asset
					const link = document.createElement('a');
					link.href = path;
					link.target = '_blank';
					link.rel = 'noopener noreferrer';
					document.body.appendChild(link);
					link.click();
					document.body.removeChild(link);
				}

				showLoading() {
					this.loadingSpinner.classList.add('active');
				}

				hideLoading() {
					this.loadingSpinner.classList.remove('active');
				}

				showResults() {
					this.resultsContainer.classList.add('show');
				}

				hideResults() {
					this.resultsContainer.classList.remove('show');
				}

				escapeHtml(text) {
					const div = document.createElement('div');
					div.textContent = text;
					return div.innerHTML;
				}

				// Upload functionality
				initUpload() {
					// Upload button click
					this.uploadBtn.addEventListener('click', () => {
						this.showUploadModal();
					});

					// Modal close events
					this.modalClose.addEventListener('click', () => {
						this.hideUploadModal();
					});

					this.cancelBtn.addEventListener('click', () => {
						this.hideUploadModal();
					});

					// Click outside modal to close
					this.uploadModal.addEventListener('click', (e) => {
						if (e.target === this.uploadModal) {
							this.hideUploadModal();
						}
					});

					// Tab switching
					document.querySelectorAll('.upload-tab').forEach((tab) => {
						tab.addEventListener('click', (e) => {
							this.switchTab(e.target.dataset.tab);
						});
					});

					// File drop zones
					this.initDropZone('dropZone', 'fileInput', 'filePreview');
					this.initDropZone('dropZoneDb', 'fileInputDb', 'filePreviewDb');

					// Upload submit
					this.uploadSubmit.addEventListener('click', () => {
						this.handleUpload();
					});

					// ESC key to close modal
					document.addEventListener('keydown', (e) => {
						if (e.key === 'Escape') {
							if (this.successModal.classList.contains('show')) {
								this.hideSuccessModal();
							} else if (this.uploadModal.classList.contains('show')) {
								this.hideUploadModal();
							}
						}
					});

					// Success modal events
					this.copyUrlBtn.addEventListener('click', () => {
						this.copyAssetUrl();
					});

					this.viewAssetBtn.addEventListener('click', () => {
						this.viewAsset();
					});

					this.closeSuccessBtn.addEventListener('click', () => {
						this.hideSuccessModal();
					});
				}

				initDropZone(dropZoneId, fileInputId, previewId) {
					const dropZone = document.getElementById(dropZoneId);
					const fileInput = document.getElementById(fileInputId);
					const preview = document.getElementById(previewId);

					// Click to browse
					dropZone.addEventListener('click', () => {
						fileInput.click();
					});

					// File input change
					fileInput.addEventListener('change', (e) => {
						this.handleFiles(e.target.files, previewId);
					});

					// Drag and drop
					dropZone.addEventListener('dragover', (e) => {
						e.preventDefault();
						dropZone.classList.add('dragover');
					});

					dropZone.addEventListener('dragleave', () => {
						dropZone.classList.remove('dragover');
					});

					dropZone.addEventListener('drop', (e) => {
						e.preventDefault();
						dropZone.classList.remove('dragover');
						this.handleFiles(e.dataTransfer.files, previewId);
					});
				}

				showUploadModal() {
					this.uploadModal.classList.add('show');
					document.body.style.overflow = 'hidden';
				}

				hideUploadModal() {
					this.uploadModal.classList.remove('show');
					document.body.style.overflow = '';
					this.resetUploadForm();
				}

				switchTab(tab) {
					this.currentTab = tab;

					// Update tab buttons
					document.querySelectorAll('.upload-tab').forEach((t) => {
						t.classList.remove('active');
					});
					document.querySelector(`[data-tab="${tab}"]`).classList.add('active');

					// Update content
					document.querySelectorAll('.upload-content').forEach((content) => {
						content.classList.remove('active');
					});
					document.getElementById(tab === 'direct' ? 'directTab' : 'databaseTab').classList.add('active');

					// Update right panel icon
					this.updateUploadIcon(tab);

					this.resetUploadForm();
				}

				updateUploadIcon(tab) {
					const iconDisplay = this.uploadIconDisplay;

					if (tab === 'direct') {
						iconDisplay.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                            <polyline points="17,8 12,3 7,8"/>
                            <line x1="12" y1="3" x2="12" y2="15"/>
                        </svg>
                    `;
					} else {
						iconDisplay.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <ellipse cx="12" cy="5" rx="9" ry="3"/>
                            <path d="M21 12c0 1.66-4 3-9 3s-9-1.34-9-3"/>
                            <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"/>
                        </svg>
                    `;
					}
				}

				handleFiles(files, previewId) {
					this.selectedFiles = Array.from(files);
					this.updateFilePreview(previewId);

					// Auto-populate fields for database tab
					if (this.currentTab === 'database' && files.length > 0) {
						const firstFile = files[0];
						const nameInput = document.getElementById('assetName');
						if (!nameInput.value) {
							nameInput.value = firstFile.name.replace(/\.[^/.]+$/, '');
						}
					}

					// Activate right panel icon
					this.uploadIconDisplay.classList.add('active');
				}

				updateFilePreview(previewId) {
					const preview = document.getElementById(previewId);
					preview.innerHTML = '';

					this.selectedFiles.forEach((file) => {
						const fileDiv = document.createElement('div');
						fileDiv.className = 'file-preview';

						const icon = this.getFileIconSvg(file.type);
						const size = this.formatFileSize(file.size);

						fileDiv.innerHTML = `
                        <div class="file-preview-icon">${icon}</div>
                        <div class="file-preview-info">
                            <div class="file-preview-name">${this.escapeHtml(file.name)}</div>
                            <div class="file-preview-size">${size}</div>
                        </div>
                    `;

						preview.appendChild(fileDiv);
					});
				}

				getFileIconSvg(mimeType) {
					if (mimeType.startsWith('image/')) {
						return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21,15 16,10 5,21"/></svg>';
					} else if (mimeType.startsWith('video/')) {
						return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="23 7 16 12 23 17 23 7"/><rect x="1" y="5" width="15" height="14" rx="2" ry="2"/></svg>';
					} else if (mimeType.startsWith('audio/')) {
						return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>';
					} else if (mimeType.includes('css')) {
						return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>';
					} else if (mimeType.includes('javascript')) {
						return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>';
					}
					return '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14,2 14,8 20,8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10,9 9,9 8,9"/></svg>';
				}

				async handleUpload() {
					if (this.selectedFiles.length === 0) {
						alert('Please select files to upload');
						return;
					}

					this.uploadSubmit.disabled = true;

					try {
						if (this.currentTab === 'direct') {
							await this.handleDirectUpload();
						} else {
							await this.handleDatabaseUpload();
						}

						// Success - close modal and show success
						this.hideUploadModal();
						this.cache.clear(); // Clear search cache

						// Show success modal with details
						this.showSuccessModal(this.lastUploadResult);
					} catch (error) {
						console.error('Upload error:', error);
						alert('Upload failed: ' + error.message);
					} finally {
						this.uploadSubmit.disabled = false;
					}
				}

				async handleDirectUpload() {
					const uploadPathHint = document.getElementById('uploadPath').value || '';
					const progressEl = document.getElementById('uploadProgress');
					const progressFill = document.getElementById('progressFill');
					const progressText = document.getElementById('progressText');

					progressEl.style.display = 'block';

					for (let i = 0; i < this.selectedFiles.length; i++) {
						const file = this.selectedFiles[i];
						const fileName = file.name;

						progressText.textContent = `Uploading ${fileName} with obfuscated naming (${i + 1}/${this.selectedFiles.length})`;

						const formData = new FormData();
						formData.append('file', file);
						formData.append('path', uploadPathHint); // Optional hint for path generation

						const response = await fetch('/api/upload/direct', {
							method: 'POST',
							body: formData,
						});

						if (!response.ok) {
							throw new Error(`Failed to upload ${fileName}: ${response.statusText}`);
						}

						const result = await response.json();
						this.lastUploadResult = {
							...result,
							method: 'Direct Upload (Obfuscated)',
							fileName: fileName,
							obfuscatedPath: result.path,
							originalPathHint: result.originalPath || uploadPathHint,
						};

						const progress = ((i + 1) / this.selectedFiles.length) * 100;
						progressFill.style.width = `${progress}%`;
					}

					progressEl.style.display = 'none';
				}

				async handleDatabaseUpload() {
					const assetName = document.getElementById('assetName').value;
					const category = document.getElementById('assetCategory').value;
					const description = document.getElementById('assetDescription').value;
					const tags = document.getElementById('assetTags').value;

					if (!assetName.trim()) {
						throw new Error('Asset name is required');
					}

					const progressEl = document.getElementById('uploadProgressDb');
					const progressFill = document.getElementById('progressFillDb');
					const progressText = document.getElementById('progressTextDb');

					progressEl.style.display = 'block';

					for (let i = 0; i < this.selectedFiles.length; i++) {
						const file = this.selectedFiles[i];

						progressText.textContent = `Uploading ${file.name} to database (${i + 1}/${this.selectedFiles.length})`;

						const formData = new FormData();
						formData.append('file', file);
						formData.append('name', assetName);
						formData.append('category', category);
						formData.append('description', description);
						formData.append('tags', tags);

						const response = await fetch('/api/upload/database', {
							method: 'POST',
							body: formData,
						});

						if (!response.ok) {
							throw new Error(`Failed to upload ${file.name}: ${response.statusText}`);
						}

						const result = await response.json();
						this.lastUploadResult = {
							...result,
							method: 'Database Storage (Obfuscated)',
							fileName: file.name,
							obfuscatedPath: result.path,
							originalCategory: result.originalCategory,
						};

						const progress = ((i + 1) / this.selectedFiles.length) * 100;
						progressFill.style.width = `${progress}%`;
					}

					progressEl.style.display = 'none';
				}

				showSuccessModal(uploadResult) {
					if (!uploadResult) return;

					// Update success modal content
					document.getElementById('storageMethod').textContent = uploadResult.method || uploadResult.file?.method || 'Upload';
					document.getElementById('assetUrl').textContent =
						uploadResult.file?.path || uploadResult.obfuscatedPath || uploadResult.path || uploadResult.url || 'Processing...';
					document.getElementById('fileSize').textContent = this.formatFileSize(uploadResult.file?.size || uploadResult.size || 0);
					document.getElementById('uploadTime').textContent = new Date().toLocaleTimeString();

					// Show original path hint if available
					const originalPathRow = document.getElementById('originalPathRow');
					const originalPathElement = document.getElementById('originalPath');
					if (uploadResult.originalPathHint || uploadResult.originalCategory) {
						const originalInfo = uploadResult.originalPathHint || `/assets/uploads/${uploadResult.originalCategory}/`;
						originalPathElement.textContent = originalInfo;
						originalPathRow.style.display = 'flex';
					} else {
						originalPathRow.style.display = 'none';
					}

					// Show success modal
					this.successModal.classList.add('show');
					document.body.style.overflow = 'hidden';
				}

				hideSuccessModal() {
					this.successModal.classList.remove('show');
					document.body.style.overflow = '';
				}

				copyAssetUrl() {
					const urlElement = document.getElementById('assetUrl');
					const url = urlElement.textContent;

					if (url && url !== 'Processing...') {
						const fullUrl = url.startsWith('http') ? url : `${window.location.origin}${url}`;
						navigator.clipboard
							.writeText(fullUrl)
							.then(() => {
								// Temporarily change button text
								const originalText = this.copyUrlBtn.textContent;
								this.copyUrlBtn.textContent = 'Copied!';
								setTimeout(() => {
									this.copyUrlBtn.textContent = originalText;
								}, 2000);
							})
							.catch(() => {
								alert('Failed to copy URL to clipboard');
							});
					}
				}

				viewAsset() {
					const urlElement = document.getElementById('assetUrl');
					const url = urlElement.textContent;

					if (url && url !== 'Processing...') {
						const fullUrl = url.startsWith('http') ? url : `${window.location.origin}${url}`;
						window.open(fullUrl, '_blank');
					}
				}

				resetUploadForm() {
					this.selectedFiles = [];
					document.getElementById('filePreview').innerHTML = '';
					document.getElementById('filePreviewDb').innerHTML = '';
					document.getElementById('uploadPath').value = '/assets/custom/';
					document.getElementById('assetName').value = '';
					document.getElementById('assetDescription').value = '';
					document.getElementById('assetTags').value = '';
					document.getElementById('uploadProgress').style.display = 'none';
					document.getElementById('uploadProgressDb').style.display = 'none';
					document.getElementById('progressFill').style.width = '0%';
					document.getElementById('progressFillDb').style.width = '0%';
					this.uploadIconDisplay.classList.remove('active');
				}
			}

					// SXAP Authentication Class
		class SXAPAuth {
			constructor() {
				this.baseUrl = window.location.origin;
				this.token = null;
				this.user = null;
				this.isLoginMode = true;
				this.verificationToken = null;

				this.initializeElements();
				this.setupEventListeners();
				this.loadSession();
				this.updateUI();
			}

			initializeElements() {
				// Auth UI elements
				this.authLoggedOut = document.getElementById('authLoggedOut');
				this.authLoggedIn = document.getElementById('authLoggedIn');
				this.loginBtn = document.getElementById('loginBtn');
				this.registerBtn = document.getElementById('registerBtn');
				this.logoutBtn = document.getElementById('logoutBtn');
				this.dashboardBtn = document.getElementById('dashboardBtn');
				this.fileViewerBtn = document.getElementById('fileViewerBtn');
				this.usernameEl = document.getElementById('username');
				this.userRoleEl = document.getElementById('userRole');
				this.userInitialsEl = document.getElementById('userInitials');
				this.userMenuTrigger = document.getElementById('userMenuTrigger');
				this.userDropdown = document.getElementById('userDropdown');

				// Auth modal elements
				this.authModal = document.getElementById('authModal');
				this.authForm = document.getElementById('authForm');
				this.authModalTitle = document.getElementById('authModalTitle');
				this.authModalSubtitle = document.getElementById('authModalSubtitle');
				this.authUsername = document.getElementById('authUsername');
				this.authEmail = document.getElementById('authEmail');
				this.authPassword = document.getElementById('authPassword');
				this.authTotp = document.getElementById('authTotp');
				this.authSubmit = document.getElementById('authSubmit');
				this.authCloseBtn = document.getElementById('authCloseBtn');
				this.authMessage = document.getElementById('authMessage');
				this.authSwitchText = document.getElementById('authSwitchText');
				this.authSwitchBtn = document.getElementById('authSwitchBtn');
				this.emailGroup = document.getElementById('emailGroup');
				this.totpGroup = document.getElementById('totpGroup');
				this.authBtnText = this.authSubmit.querySelector('.auth-btn-text');
				this.authBtnLoading = this.authSubmit.querySelector('.auth-btn-loading');

				// Dashboard modal elements
				this.dashboardModal = document.getElementById('dashboardModal');
				this.dashboardClose = document.getElementById('dashboardClose');
				this.dashboardStats = document.getElementById('dashboardStats');
				this.userUploads = document.getElementById('userUploads');

				// File viewer elements
				this.fileViewerPanel = document.getElementById('fileViewerPanel');
				this.fileViewerClose = document.getElementById('fileViewerClose');
				this.fileViewerRefresh = document.getElementById('fileViewerRefresh');
				this.fileViewerList = document.getElementById('fileViewerList');
				this.fileStatCount = document.getElementById('fileStatCount');
				this.fileStatSize = document.getElementById('fileStatSize');
			}

			setupEventListeners() {
				this.loginBtn.addEventListener('click', () => this.showAuthModal(true));
				this.registerBtn.addEventListener('click', () => this.showAuthModal(false));
				this.logoutBtn.addEventListener('click', () => this.logout());
				this.dashboardBtn.addEventListener('click', () => this.showDashboard());
				this.fileViewerBtn.addEventListener('click', () => this.showFileViewer());

				// User menu dropdown
				this.userMenuTrigger.addEventListener('click', (e) => {
					e.stopPropagation();
					this.toggleUserDropdown();
				});

				this.authCloseBtn.addEventListener('click', () => this.hideAuthModal());
				this.authSwitchBtn.addEventListener('click', () => this.toggleAuthMode());
				this.authForm.addEventListener('submit', (e) => this.handleAuthSubmit(e));

				this.dashboardClose.addEventListener('click', () => this.hideDashboard());
				this.fileViewerClose.addEventListener('click', () => this.hideFileViewer());
				this.fileViewerRefresh.addEventListener('click', () => this.refreshFileViewer());

				// Close modals on backdrop click
				this.authModal.addEventListener('click', (e) => {
					if (e.target === this.authModal || e.target.classList.contains('modal-backdrop')) {
						this.hideAuthModal();
					}
				});
				this.dashboardModal.addEventListener('click', (e) => {
					if (e.target === this.dashboardModal) this.hideDashboard();
				});

				// Close dropdown when clicking outside
				document.addEventListener('click', () => {
					this.hideUserDropdown();
				});
			}

			toggleUserDropdown() {
				this.userDropdown.classList.toggle('show');
			}

			hideUserDropdown() {
				this.userDropdown.classList.remove('show');
			}

			showAuthModal(isLogin = true) {
				this.isLoginMode = isLogin;
				this.updateAuthModal();
				this.copyBackgroundContent();
				this.authModal.classList.add('show');
				this.clearAuthForm();
				document.body.style.overflow = 'hidden';
			}

			hideAuthModal() {
				this.authModal.classList.remove('show');
				this.clearAuthForm();
				this.totpGroup.style.display = 'none';
				this.verificationToken = null;
				document.body.style.overflow = '';
			}

			copyBackgroundContent() {
				const backgroundContent = this.authModal.querySelector('.modal-background-content');
				const mainContent = document.querySelector('.container');
				if (backgroundContent && mainContent) {
					backgroundContent.innerHTML = mainContent.outerHTML;
				}
			}

			updateAuthModal() {
				if (this.isLoginMode) {
					this.authModalTitle.textContent = 'Sign in';
					this.authModalSubtitle.textContent = 'Welcome back to JWLimited CDN';
					this.authBtnText.textContent = 'Sign in';
					this.emailGroup.style.display = 'none';
					this.authSwitchText.textContent = "Don't have an account?";
					this.authSwitchBtn.textContent = 'Get started';
					this.authEmail.required = false;
				} else {
					this.authModalTitle.textContent = 'Get started';
					this.authModalSubtitle.textContent = 'Create your JWLimited CDN account';
					this.authBtnText.textContent = 'Create account';
					this.emailGroup.style.display = 'flex';
					this.authSwitchText.textContent = 'Already have an account?';
					this.authSwitchBtn.textContent = 'Sign in';
					this.authEmail.required = true;
				}
			}

			toggleAuthMode() {
				this.isLoginMode = !this.isLoginMode;
				this.updateAuthModal();
				this.clearAuthForm();
			}

			clearAuthForm() {
				this.authUsername.value = '';
				this.authEmail.value = '';
				this.authPassword.value = '';
				this.authTotp.value = '';
				this.authMessage.innerHTML = '';
			}

			async handleAuthSubmit(e) {
				e.preventDefault();
				this.authSubmit.disabled = true;
				this.authMessage.innerHTML = '';
				this.setLoadingState(true);

				try {
					if (this.verificationToken) {
						await this.verify2FA();
					} else if (this.isLoginMode) {
						await this.login();
					} else {
						await this.register();
					}
				} catch (error) {
					this.showAuthError(error.message);
				} finally {
					this.authSubmit.disabled = false;
					this.setLoadingState(false);
				}
			}

			setLoadingState(loading) {
				if (loading) {
					this.authBtnText.style.display = 'none';
					this.authBtnLoading.style.display = 'flex';
				} else {
					this.authBtnText.style.display = 'block';
					this.authBtnLoading.style.display = 'none';
				}
			}

			async login() {
				const credentials = {
					username: this.authUsername.value,
					password: this.authPassword.value,
					deviceInfo: {
						userAgent: navigator.userAgent,
						platform: navigator.platform
					}
				};

				const response = await fetch(`${this.baseUrl}/api/auth/v2/auth?op=auth&mode=strict&sec=2`, {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify(credentials)
				});

				const result = await response.json();

				if (result.requiresTOTP) {
					this.verificationToken = result.verificationToken;
					this.totpGroup.style.display = 'block';
					this.authBtnText.textContent = 'Verify 2FA';
					this.showAuthMessage('Please enter your 2FA code', 'success');
					return;
				}

				if (result.message === "Login successful") {
					this.token = result.sxap_token;
					this.user = result.user;
					this.saveSession();
					this.updateUI();
					this.hideAuthModal();
					this.showAuthMessage('Login successful!', 'success');
				} else {
					throw new Error(result.message || 'Login failed');
				}
			}

			async register() {
				const userData = {
					username: this.authUsername.value,
					email: this.authEmail.value,
					password: this.authPassword.value
				};

				const response = await fetch(`${this.baseUrl}/api/auth/v2/auth?op=register&mode=strict&sec=2`, {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify(userData)
				});

				const result = await response.json();

				if (result.success) {
					this.token = result.sxap_token;
					this.user = result.user;
					this.saveSession();
					this.updateUI();
					this.hideAuthModal();
					this.showAuthMessage('Registration successful!', 'success');
				} else {
					throw new Error(result.message || 'Registration failed');
				}
			}

			async verify2FA() {
				const totpCode = this.authTotp.value;

				const response = await fetch(`${this.baseUrl}/api/auth/v2/auth?op=verify2fa&mode=strict&sec=2`, {
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({
						totpCode,
						verificationToken: this.verificationToken
					})
				});

				const result = await response.json();

				if (result.protocol === 'SXAP') {
					this.token = result.sxap_token;
					this.user = result.user;
					this.saveSession();
					this.updateUI();
					this.hideAuthModal();
					this.showAuthMessage('2FA verification successful!', 'success');
				} else {
					throw new Error(result.message || '2FA verification failed');
				}
			}

			async showDashboard() {
				if (!this.token) {
					this.showAuthModal(true);
					return;
				}

				try {
					// Copy background content
					const backgroundContent = document.querySelector('.dashboard-modal .modal-background-content');
					const mainContent = document.querySelector('.container');
					if (backgroundContent && mainContent) {
						backgroundContent.innerHTML = mainContent.outerHTML;
					}

					// Update username in dashboard
					const usernameSpan = document.getElementById('dashboardUsername');
					if (usernameSpan && this.user) {
						usernameSpan.textContent = this.user.username || 'User';
					}

					// Load user stats only
					await this.loadUserStats();

					this.dashboardModal.classList.add('show');
				} catch (error) {
					console.error('Dashboard error:', error);
					this.showAuthError('Failed to load dashboard');
				}
			}

			hideDashboard() {
				this.dashboardModal.classList.remove('show');
			}

			async showFileViewer() {
				if (!this.token) {
					this.showAuthModal(true);
					return;
				}

				try {
					await this.loadFileViewerData();
					this.fileViewerPanel.classList.add('show');
				} catch (error) {
					console.error('File viewer error:', error);
					this.showAuthError('Failed to load files');
				}
			}

			hideFileViewer() {
				this.fileViewerPanel.classList.remove('show');
			}

			async refreshFileViewer() {
				if (this.fileViewerPanel.classList.contains('show')) {
					await this.loadFileViewerData();
				}
			}

			async loadFileViewerData() {
				const response = await fetch(`${this.baseUrl}/api/user/uploads?limit=50`, {
					headers: { 'Authorization': `Bearer ${this.token}` }
				});

				if (!response.ok) throw new Error('Failed to load user files');

				const result = await response.json();
				const uploads = result.uploads || [];

				// Update stats
				const totalSize = uploads.reduce((sum, upload) => sum + (upload.size || upload.fileSize || 0), 0);
				this.fileStatCount.textContent = uploads.length;
				this.fileStatSize.textContent = this.formatFileSize(totalSize);

				// Render file list
				if (uploads.length === 0) {
					this.fileViewerList.innerHTML = `
						<div class="file-viewer-empty">
							<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
							</svg>
							<h4>No files yet</h4>
							<p>Upload your first file to get started</p>
						</div>
					`;
				} else {
					this.fileViewerList.innerHTML = uploads.map(upload => {
						const fileName = upload.name || upload.originalName || 'Unnamed';
						const fileSize = this.formatFileSize(upload.size || upload.fileSize || 0);
						const uploadDate = new Date(upload.createdAt || upload.uploadedAt).toLocaleDateString();
						const fileId = upload.id || upload.path || upload.filePath;
						const filePath = upload.path || upload.filePath;

						return `
							<div class="file-item" onclick="window.open('${filePath}', '_blank')">
								<div class="file-item-icon">
									${this.getFileIcon(fileName)}
								</div>
								<div class="file-item-content">
									<div class="file-item-name" title="${fileName}">${fileName}</div>
									<div class="file-item-meta">
										<span class="file-item-size">${fileSize}</span>
										<span>â€¢</span>
										<span>${uploadDate}</span>
									</div>
								</div>
								<div class="file-item-actions">
									<button class="file-action-btn" onclick="event.stopPropagation(); cdnApp.fileEditor.selectFileById('${fileId}')" title="Edit file">
										<svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
											<polyline points="14,2 14,8 20,8"/>
										</svg>
									</button>
									<button class="file-action-btn" onclick="event.stopPropagation(); cdnApp.auth.showFileInfo('${fileId}')" title="File info">
										<svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
										</svg>
									</button>
									<button class="file-action-btn danger" onclick="event.stopPropagation(); cdnApp.auth.deleteFile('${fileId}', '${fileName}')" title="Delete">
										<svg width="12" height="12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
											<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
										</svg>
									</button>
								</div>
							</div>
						`;
					}).join('');
				}
			}

			getFileIcon(fileName) {
				const ext = fileName.split('.').pop().toLowerCase();

				if (['jpg', 'jpeg', 'png', 'gif', 'svg', 'webp'].includes(ext)) {
					return `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
						<circle cx="8.5" cy="8.5" r="1.5"/>
						<polyline points="21,15 16,10 5,21"/>
					</svg>`;
				} else if (['mp4', 'avi', 'mov', 'wmv'].includes(ext)) {
					return `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<polygon points="23 7 16 12 23 17 23 7"/>
						<rect x="1" y="5" width="15" height="14" rx="2" ry="2"/>
					</svg>`;
				} else if (['mp3', 'wav', 'ogg', 'flac'].includes(ext)) {
					return `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path d="M9 18V5l12-2v13"/>
						<circle cx="6" cy="18" r="3"/>
						<circle cx="18" cy="16" r="3"/>
					</svg>`;
				} else if (['pdf'].includes(ext)) {
					return `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"/>
					</svg>`;
				} else {
					return `<svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
					</svg>`;
				}
			}

			async loadUserStats() {
				const response = await fetch(`${this.baseUrl}/api/user/quota`, {
					headers: { 'Authorization': `Bearer ${this.token}` }
				});

				if (!response.ok) throw new Error('Failed to load user stats');

				const result = await response.json();
				const quota = result.quota;

				this.dashboardStats.innerHTML = `
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Storage Used</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4"/>
							</svg>
						</div>
						<div class="stat-value">${this.formatFileSize(quota.usage?.storageBreakdown?.total || quota.currentStorage || 0)}</div>
						<div class="stat-description">of ${quota.limits?.maxStorage > 0 ? this.formatFileSize(quota.limits.maxStorage) : 'unlimited'} used</div>
						${quota.limits?.maxStorage > 0 ? this.renderStorageVisualization(quota.storageVisualization) : ''}
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Files</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
							</svg>
						</div>
						<div class="stat-value">${quota.usage?.files || quota.currentFiles || 0}</div>
						<div class="stat-description">files uploaded</div>
						${quota.limits?.maxFiles > 0 ? `<div class="quota-bar"><div class="quota-fill ${quota.percentage?.files > 90 ? 'warning' : 'success'}" style="width: ${Math.min(quota.percentage?.files || 0, 100)}%"></div></div>` : ''}
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Storage Limit</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
							</svg>
						</div>
						<div class="stat-value">${quota.limits?.maxStorage > 0 ? this.formatFileSize(quota.limits.maxStorage) : 'âˆž'}</div>
						<div class="stat-description">total available</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Account Type</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
							</svg>
						</div>
						<div class="stat-value" style="font-size: 1.25rem; text-transform: capitalize;">${this.user?.role || 'user'}</div>
						<div class="stat-description">membership level</div>
					</div>
				`;
			}



			formatFileSize(bytes) {
				if (bytes === 0) return '0 B';
				const k = 1024;
				const sizes = ['B', 'KB', 'MB', 'GB'];
				const i = Math.floor(Math.log(bytes) / Math.log(k));
				return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
			}

			renderStorageVisualization(visualization) {
				if (!visualization) return '';

				const { fileStorage, versionStorage, totalUsed, available } = visualization;

				return `
					<div class="storage-visualization">
						<div class="storage-breakdown">
							<div class="storage-breakdown-item">
								<div class="storage-label" style="color: ${fileStorage.color};">
									<div class="storage-color-dot" style="background-color: ${fileStorage.color};"></div>
									${fileStorage.label}
								</div>
								<div class="storage-amount">${this.formatFileSize(fileStorage.bytes)}</div>
							</div>
							<div class="storage-breakdown-item">
								<div class="storage-label" style="color: ${versionStorage.color};">
									<div class="storage-color-dot" style="background-color: ${versionStorage.color};"></div>
									${versionStorage.label}
								</div>
								<div class="storage-amount">${this.formatFileSize(versionStorage.bytes)}</div>
							</div>
						</div>
						<div class="storage-bar">
							<div class="storage-segment"
								 style="width: ${fileStorage.percentage}%; background-color: ${fileStorage.color};"
								 title="${fileStorage.label}: ${this.formatFileSize(fileStorage.bytes)}"></div>
							<div class="storage-segment"
								 style="width: ${versionStorage.percentage}%; background-color: ${versionStorage.color};"
								 title="${versionStorage.label}: ${this.formatFileSize(versionStorage.bytes)}"></div>
						</div>
						<div class="storage-summary">
							<span class="storage-used">${this.formatFileSize(totalUsed.bytes)} used</span>
							<span class="storage-available">${this.formatFileSize(available.bytes)} available</span>
						</div>
					</div>
				`;
			}

			logout() {
				this.token = null;
				this.user = null;
				this.clearSession();
				this.updateUI();
				this.showAuthMessage('Logged out successfully', 'success');
			}

			updateUI() {
				if (this.token && this.user) {
					this.authLoggedOut.style.display = 'none';
					this.authLoggedIn.style.display = 'block';
					this.usernameEl.textContent = this.user.username;
					this.userRoleEl.textContent = this.user.role || 'user';

					// Set user initials
					const initials = this.user.username.substring(0, 2).toUpperCase();
					this.userInitialsEl.textContent = initials;
				} else {
					this.authLoggedOut.style.display = 'block';
					this.authLoggedIn.style.display = 'none';
				}
			}

			saveSession() {
				if (this.token && this.user) {
					localStorage.setItem('sxap_session', JSON.stringify({
						token: this.token,
						user: this.user,
						timestamp: Date.now()
					}));
				}
			}

			loadSession() {
				try {
					const session = localStorage.getItem('sxap_session');
					if (session) {
						const data = JSON.parse(session);
						// Check if session is less than 24 hours old
						if (Date.now() - data.timestamp < 24 * 60 * 60 * 1000) {
							this.token = data.token;
							this.user = data.user;
							return true;
						} else {
							this.clearSession();
						}
					}
				} catch (error) {
					console.error('Failed to load session:', error);
					this.clearSession();
				}
				return false;
			}

			clearSession() {
				localStorage.removeItem('sxap_session');
			}

			showAuthMessage(message, type = 'error') {
				this.authMessage.innerHTML = `<div class="auth-${type}">${message}</div>`;
			}

			showAuthError(message) {
				this.showAuthMessage(message, 'error');
			}

			// Get authorization header for API requests
			getAuthHeader() {
				return this.token ? { 'Authorization': `Bearer ${this.token}` } : {};
			}

			// Check if user is authenticated
			isAuthenticated() {
				return !!this.token;
			}

			// Show file information modal
			async showFileInfo(fileId) {
				if (!this.token) {
					this.showAuthModal(true);
					return;
				}

				try {
					const response = await fetch(`${this.baseUrl}/api/files/${fileId}`, {
						headers: { 'Authorization': `Bearer ${this.token}` }
					});

					if (!response.ok) {
						if (response.status === 401) {
							this.showAuthModal(true);
							return;
						}
						throw new Error('Failed to load file information');
					}

					const result = await response.json();
					const file = result.file;

					// Create and show file info modal
					const modal = document.createElement('div');
					modal.className = 'file-info-modal';
					modal.innerHTML = `
						<div class="modal-backdrop"></div>
						<div class="modal-content">
							<div class="modal-header">
								<h3>File Information</h3>
								<button class="modal-close" onclick="this.closest('.file-info-modal').remove()">
									<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<line x1="18" y1="6" x2="6" y2="18"/>
										<line x1="6" y1="6" x2="18" y2="18"/>
									</svg>
								</button>
							</div>
							<div class="modal-body">
								<div class="file-details">
									<div class="detail-row">
										<span class="detail-label">Name:</span>
										<span class="detail-value">${file.name}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Original Name:</span>
										<span class="detail-value">${file.originalName}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Path:</span>
										<span class="detail-value" style="font-family: monospace; word-break: break-all;">${file.path}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Size:</span>
										<span class="detail-value">${this.formatFileSize(file.size)}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Type:</span>
										<span class="detail-value">${file.mimeType}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Upload Type:</span>
										<span class="detail-value">${file.type}</span>
									</div>
									<div class="detail-row">
										<span class="detail-label">Uploaded:</span>
										<span class="detail-value">${new Date(file.uploadedAt).toLocaleString()}</span>
									</div>
									${file.category ? `
									<div class="detail-row">
										<span class="detail-label">Category:</span>
										<span class="detail-value">${file.category}</span>
									</div>
									` : ''}
									${file.description ? `
									<div class="detail-row">
										<span class="detail-label">Description:</span>
										<span class="detail-value">${file.description}</span>
									</div>
									` : ''}
									${file.tags && file.tags.length > 0 ? `
									<div class="detail-row">
										<span class="detail-label">Tags:</span>
										<span class="detail-value">${file.tags.join(', ')}</span>
									</div>
									` : ''}
								</div>
								<div class="file-actions">
									<button onclick="window.open('${file.path}', '_blank')" class="btn btn-primary">View File</button>
									<button onclick="navigator.clipboard.writeText('${window.location.origin}${file.path}'); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy URL', 2000)" class="btn btn-secondary">Copy URL</button>
								</div>
							</div>
						</div>
					`;

					document.body.appendChild(modal);
					modal.classList.add('show');

					// Close on backdrop click
					modal.querySelector('.modal-backdrop').addEventListener('click', () => {
						modal.remove();
					});

				} catch (error) {
					console.error('File info error:', error);
					alert('Failed to load file information: ' + error.message);
				}
			}

			// Delete file
			async deleteFile(fileId, fileName) {
				if (!this.token) {
					this.showAuthModal(true);
					return;
				}

				if (!confirm(`Are you sure you want to delete "${fileName}"? This action cannot be undone.`)) {
					return;
				}

				try {
					const response = await fetch(`${this.baseUrl}/api/files/${fileId}`, {
						method: 'DELETE',
						headers: { 'Authorization': `Bearer ${this.token}` }
					});

					if (!response.ok) {
						if (response.status === 401) {
							this.showAuthModal(true);
							return;
						}
						throw new Error('Failed to delete file');
					}

					const result = await response.json();

					// Show success message
					this.showAuthMessage(`File "${fileName}" deleted successfully`, 'success');

					// Refresh file viewer if open
					if (this.fileViewerPanel.classList.contains('show')) {
						await this.loadFileViewerData();
					}

					// Refresh dashboard if open
					if (this.dashboardModal.classList.contains('show')) {
						await this.loadUserStats(); // Refresh quota info
					}

				} catch (error) {
					console.error('Delete file error:', error);
					alert('Failed to delete file: ' + error.message);
				}
			}
		}

		// Status Modal Class
		class StatusModal {
			constructor() {
				this.modal = document.getElementById('statusModal');
				this.closeBtn = document.getElementById('statusClose');
				this.systemStats = document.getElementById('systemStats');
				this.networkMap = document.getElementById('networkMap');

				this.setupEventListeners();
			}

			setupEventListeners() {
				this.closeBtn.addEventListener('click', () => this.hide());
				this.modal.addEventListener('click', (e) => {
					if (e.target === this.modal) this.hide();
				});
			}

			async show() {
				// Copy background content
				const backgroundContent = document.querySelector('#statusModal .modal-background-content');
				const mainContent = document.querySelector('.container');
				if (backgroundContent && mainContent) {
					backgroundContent.innerHTML = mainContent.outerHTML;
				}

				await this.loadSystemStats();
				this.renderNetworkMap();
				this.modal.classList.add('show');
			}

			hide() {
				this.modal.classList.remove('show');
			}

			async loadSystemStats() {
				try {
					const [healthResponse, traceResponse] = await Promise.all([
						fetch('/api/health'),
						fetch('/cdn-cgi/trace')
					]);

					const healthData = await healthResponse.json();
					const traceText = await traceResponse.text();
					const traceData = this.parseTraceData(traceText);

					this.renderSystemStats(healthData, traceData);
				} catch (error) {
					console.error('Failed to load system stats:', error);
					this.systemStats.innerHTML = '<div class="empty-state"><div class="empty-state-title">Unable to load system stats</div></div>';
				}
			}

			parseTraceData(traceText) {
				const data = {};
				const lines = traceText.trim().split('\n');

				lines.forEach(line => {
					const [key, value] = line.split('=');
					if (key && value) {
						data[key] = value;
					}
				});

				return data;
			}

			getLocationName(colo) {
				const locations = {
					'FRA': 'Frankfurt, Germany',
					'LHR': 'London, UK',
					'CDG': 'Paris, France',
					'AMS': 'Amsterdam, Netherlands',
					'SJC': 'San Jose, CA',
					'LAX': 'Los Angeles, CA',
					'DFW': 'Dallas, TX',
					'ORD': 'Chicago, IL',
					'ATL': 'Atlanta, GA',
					'IAD': 'Washington, DC',
					'NRT': 'Tokyo, Japan',
					'HKG': 'Hong Kong',
					'SIN': 'Singapore',
					'SYD': 'Sydney, Australia',
					'GRU': 'SÃ£o Paulo, Brazil',
					'YYZ': 'Toronto, Canada',
					'BOM': 'Mumbai, India'
				};
				return locations[colo] || colo;
			}

			getCountryFlag(loc) {
				const flags = {
					'DE': 'ðŸ‡©ðŸ‡ª', 'GB': 'ðŸ‡¬ðŸ‡§', 'FR': 'ðŸ‡«ðŸ‡·', 'NL': 'ðŸ‡³ðŸ‡±',
					'US': 'ðŸ‡ºðŸ‡¸', 'JP': 'ðŸ‡¯ðŸ‡µ', 'HK': 'ðŸ‡­ðŸ‡°', 'SG': 'ðŸ‡¸ðŸ‡¬',
					'AU': 'ðŸ‡¦ðŸ‡º', 'BR': 'ðŸ‡§ðŸ‡·', 'CA': 'ðŸ‡¨ðŸ‡¦', 'IN': 'ðŸ‡®ðŸ‡³'
				};
				return flags[loc] || 'ðŸŒ';
			}

			renderSystemStats(healthData, traceData) {
				const coloLocation = this.getLocationName(traceData.colo);
				const countryFlag = this.getCountryFlag(traceData.loc);
				const timestamp = traceData.ts ? new Date(parseFloat(traceData.ts) * 1000).toLocaleString() : 'Unknown';

				this.systemStats.innerHTML = `
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">System Status</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
							</svg>
						</div>
						<div class="stat-value" style="color: hsl(142, 76%, 36%);">Operational</div>
						<div class="stat-description">All systems running normally</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Your Location</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
							</svg>
						</div>
						<div class="stat-value">${countryFlag} ${traceData.ip || 'Unknown'}</div>
						<div class="stat-description">${coloLocation}</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Edge Server</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M5 12a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v4a2 2 0 01-2 2M5 12a2 2 0 00-2 2v4a2 2 0 002 2h14a2 2 0 002-2v-4a2 2 0 00-2-2"/>
							</svg>
						</div>
						<div class="stat-value">${traceData.colo || 'Unknown'}</div>
						<div class="stat-description">Cloudflare datacenter</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Protocol</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/>
							</svg>
						</div>
						<div class="stat-value">${traceData.tls || 'Unknown'}</div>
						<div class="stat-description">${traceData.http || 'HTTP/1.1'}</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Connection</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/>
							</svg>
						</div>
						<div class="stat-value">${traceData.visit_scheme?.toUpperCase() || 'HTTPS'}</div>
						<div class="stat-description">Secure connection</div>
					</div>
					<div class="stat-card">
						<div class="stat-header">
							<span class="stat-title">Request Time</span>
							<svg class="stat-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
							</svg>
						</div>
						<div class="stat-value">${healthData.responseTime || '< 100'}ms</div>
						<div class="stat-description">${timestamp}</div>
					</div>
					<div class="trace-details">
						<div class="trace-header">
							<span class="trace-title">CDN Trace Details</span>
							<button class="trace-refresh-btn" onclick="window.statusModal.loadSystemStats()">
								<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<path d="M23 4v6h-6"/>
									<path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/>
								</svg>
								Refresh
							</button>
						</div>
						<div class="trace-grid">
							${Object.entries(traceData).map(([key, value]) => `
								<div class="trace-item">
									<div class="trace-key">${key}</div>
									<div class="trace-value">${value}</div>
								</div>
							`).join('')}
						</div>
					</div>
				`;
			}

			renderNetworkMap() {
				const locations = [
					{ name: 'San Francisco', lat: 37.7749, lng: -122.4194, status: 'online' },
					{ name: 'New York', lat: 40.7128, lng: -74.0060, status: 'online' },
					{ name: 'London', lat: 51.5074, lng: -0.1278, status: 'online' },
					{ name: 'Tokyo', lat: 35.6762, lng: 139.6503, status: 'online' },
					{ name: 'Sydney', lat: -33.8688, lng: 151.2093, status: 'online' },
					{ name: 'Frankfurt', lat: 50.1109, lng: 8.6821, status: 'online' },
					{ name: 'Singapore', lat: 1.3521, lng: 103.8198, status: 'online' },
					{ name: 'SÃ£o Paulo', lat: -23.5505, lng: -46.6333, status: 'online' },
					{ name: 'Mumbai', lat: 19.0760, lng: 72.8777, status: 'online' },
					{ name: 'Toronto', lat: 43.6532, lng: -79.3832, status: 'online' }
				];

				// Create world map SVG background
				const worldMapSVG = `
					<svg class="world-map-svg" viewBox="0 0 800 400" xmlns="http://www.w3.org/2000/svg">
						<!-- World map continents -->
						<!-- North America -->
						<path d="M 50,80 C 50,70 60,60 80,55 C 120,50 160,55 180,70 C 200,85 210,110 215,130 C 220,150 215,170 200,180 C 180,190 160,185 140,180 C 120,175 100,165 85,150 C 70,135 55,120 50,100 Z" />
						<!-- South America -->
						<path d="M 120,200 C 130,190 140,185 150,190 C 160,195 165,210 170,230 C 175,250 180,270 175,290 C 170,310 160,325 145,330 C 130,335 115,330 105,315 C 95,300 100,280 105,260 C 110,240 115,220 120,200 Z" />
						<!-- Europe -->
						<path d="M 280,70 C 290,65 310,60 330,65 C 350,70 365,80 375,95 C 385,110 380,125 370,135 C 360,145 345,150 330,145 C 315,140 305,130 295,115 C 285,100 280,85 280,70 Z" />
						<!-- Africa -->
						<path d="M 300,140 C 315,135 330,140 340,155 C 350,170 355,190 360,210 C 365,230 370,250 365,270 C 360,290 350,305 335,310 C 320,315 305,310 295,295 C 285,280 290,260 295,240 C 300,220 300,200 305,180 C 305,160 300,150 300,140 Z" />
						<!-- Asia -->
						<path d="M 400,60 C 430,55 460,60 490,70 C 520,80 545,95 570,115 C 595,135 615,160 625,185 C 635,210 630,235 615,250 C 600,265 580,270 560,265 C 540,260 525,245 515,225 C 505,205 500,180 495,155 C 490,130 485,105 475,85 C 465,65 450,55 430,55 C 415,55 405,60 400,60 Z" />
						<!-- Australia -->
						<path d="M 580,280 C 595,275 610,280 620,295 C 630,310 625,325 615,335 C 605,345 590,350 575,345 C 560,340 550,325 555,310 C 560,295 570,285 580,280 Z" />
						<!-- Antarctica -->
						<path d="M 100,350 C 200,345 300,345 400,350 C 500,355 600,360 700,365 C 650,375 550,380 450,375 C 350,370 250,365 150,360 C 125,358 112,354 100,350 Z" />
					</svg>
				`;

				this.networkMap.innerHTML = worldMapSVG + locations.map(location => {
					const x = ((location.lng + 180) / 360) * 100;
					const y = ((90 - location.lat) / 180) * 100;

					return `
						<div class="network-point ${location.status}"
							 style="left: ${x}%; top: ${y}%;"
							 data-location="${location.name}">
						</div>
						<div class="network-tooltip" style="left: ${x}%; top: ${y - 10}%;">
							<strong>${location.name}</strong><br>
							Status: ${location.status}<br>
							Latency: ${Math.floor(Math.random() * 50 + 10)}ms
						</div>
					`;
				}).join('');
			}
		}

		// API Modal Class
		class APIModal {
			constructor() {
				this.modal = document.getElementById('apiModal');
				this.closeBtn = document.getElementById('apiClose');
				this.apiSections = document.getElementById('apiSections');

				this.setupEventListeners();
			}

			setupEventListeners() {
				this.closeBtn.addEventListener('click', () => this.hide());
				this.modal.addEventListener('click', (e) => {
					if (e.target === this.modal) this.hide();
				});
			}

			show() {
				// Copy background content
				const backgroundContent = document.querySelector('#apiModal .modal-background-content');
				const mainContent = document.querySelector('.container');
				if (backgroundContent && mainContent) {
					backgroundContent.innerHTML = mainContent.outerHTML;
				}

				this.renderAPIDocumentation();
				this.modal.classList.add('show');
			}

			hide() {
				this.modal.classList.remove('show');
			}

			renderAPIDocumentation() {
				const apiSections = [
					{
						title: 'Authentication',
						description: 'SXAP authentication endpoints for user management',
						endpoints: [
							{ method: 'POST', path: '/api/auth/v2/auth', description: 'Authenticate user with username/password' },
							{ method: 'POST', path: '/api/auth/v2/register', description: 'Register new user account' },
							{ method: 'POST', path: '/api/auth/v2/2fa', description: 'Verify 2FA token' },
							{ method: 'POST', path: '/api/auth/v2/logout', description: 'Logout and invalidate session' }
						]
					},
					{
						title: 'File Management',
						description: 'Upload, manage, and retrieve files from the CDN with authentication',
						endpoints: [
							{ method: 'POST', path: '/api/upload/direct', description: 'Upload file directly to CDN with obfuscation' },
							{ method: 'POST', path: '/api/upload/database', description: 'Upload file with metadata to database' },
							{ method: 'GET', path: '/api/files/:id', description: 'Get detailed file information (auth required)' },
							{ method: 'PUT', path: '/api/files/:id', description: 'Update file metadata (auth required)' },
							{ method: 'DELETE', path: '/api/files/:id', description: 'Delete file from CDN (auth required)' },
							{ method: 'GET', path: '/api/user/uploads', description: 'List user uploads with pagination' }
						]
					},
					{
						title: 'User Management',
						description: 'User profile and quota management endpoints',
						endpoints: [
							{ method: 'GET', path: '/api/user/profile', description: 'Get user profile information' },
							{ method: 'GET', path: '/api/user/quota', description: 'Get user quota and usage' },
							{ method: 'PUT', path: '/api/user/profile', description: 'Update user profile' }
						]
					},
					{
						title: 'System',
						description: 'System status and health check endpoints',
						endpoints: [
							{ method: 'GET', path: '/api/health', description: 'System health check' },
							{ method: 'GET', path: '/api/workers', description: 'Worker status information' },
							{ method: 'GET', path: '/api/stats', description: 'System statistics' }
						]
					}
				];

				this.apiSections.innerHTML = apiSections.map(section => `
					<div class="api-section">
						<div class="api-section-header">
							<div class="api-section-title">${section.title}</div>
							<div class="api-section-description">${section.description}</div>
						</div>
						<div class="api-endpoints">
							${section.endpoints.map(endpoint => `
								<div class="api-endpoint">
									<div class="api-endpoint-info">
										<div class="api-method ${endpoint.method.toLowerCase()}">${endpoint.method}</div>
										<div class="api-endpoint-details">
											<div class="api-endpoint-path">${endpoint.path}</div>
											<div class="api-endpoint-description">${endpoint.description}</div>
										</div>
									</div>
									<div class="api-endpoint-actions">
										<button class="api-try-btn" onclick="window.open('${endpoint.path}', '_blank')">Try</button>
										<button class="api-copy-btn" onclick="navigator.clipboard.writeText('${window.location.origin}${endpoint.path}'); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy', 2000)">Copy</button>
									</div>
								</div>
							`).join('')}
						</div>
					</div>
				`).join('');
			}
		}

		// Dev Tools Modal Class
		class DevToolsModal {
			constructor() {
				this.modal = document.getElementById('devToolsModal');
				this.closeBtn = document.getElementById('devToolsClose');
				this.devToolsSections = document.getElementById('devToolsSections');
				this.consoleHistory = [];
				this.consoleIndex = -1;

				this.setupEventListeners();
			}

			setupEventListeners() {
				this.closeBtn.addEventListener('click', () => this.hide());
				this.modal.addEventListener('click', (e) => {
					if (e.target === this.modal) this.hide();
				});
			}

			async show() {
				// Copy background content
				const backgroundContent = document.querySelector('#devToolsModal .modal-background-content');
				const mainContent = document.querySelector('.container');
				if (backgroundContent && mainContent) {
					backgroundContent.innerHTML = mainContent.outerHTML;
				}

				this.renderDevToolsInterface();
				this.modal.classList.add('show');
			}

			hide() {
				this.modal.classList.remove('show');
			}

			renderDevToolsInterface() {
				this.devToolsSections.innerHTML = `
					<div class="devtools-section">
						<div class="devtools-section-header">
							<div class="devtools-section-title">Console</div>
							<div class="devtools-tabs">
								<button class="devtools-tab active" onclick="window.devToolsModal.switchTab('console')">Console</button>
								<button class="devtools-tab" onclick="window.devToolsModal.switchTab('network')">Network</button>
								<button class="devtools-tab" onclick="window.devToolsModal.switchTab('performance')">Performance</button>
								<button class="devtools-tab" onclick="window.devToolsModal.switchTab('storage')">Storage</button>
							</div>
						</div>
						<div class="devtools-content">
							<div id="devtools-console" class="devtools-panel active">
								<div class="console-output" id="consoleOutput">
									<div class="console-line console-info">
										<span class="console-timestamp">${new Date().toLocaleTimeString()}</span>
										<span class="console-message">Welcome to JWLimited CDN Developer Console</span>
									</div>
									<div class="console-line console-info">
										<span class="console-timestamp">${new Date().toLocaleTimeString()}</span>
										<span class="console-message">Type 'help' for available commands</span>
									</div>
								</div>
								<div class="console-input-container">
									<span class="console-prompt">></span>
									<input type="text" class="console-input" id="consoleInput" placeholder="Enter JavaScript or CDN commands..." />
								</div>
							</div>
							<div id="devtools-network" class="devtools-panel">
								<div class="network-requests" id="networkRequests">
									<div class="network-header">
										<div class="network-col">Name</div>
										<div class="network-col">Status</div>
										<div class="network-col">Type</div>
										<div class="network-col">Size</div>
										<div class="network-col">Time</div>
									</div>
									<div id="networkRequestsList"></div>
								</div>
							</div>
							<div id="devtools-performance" class="devtools-panel">
								<div class="performance-metrics" id="performanceMetrics">
									<!-- Performance metrics will be loaded here -->
								</div>
							</div>
							<div id="devtools-storage" class="devtools-panel">
								<div class="storage-sections" id="storageSections">
									<!-- Storage data will be loaded here -->
								</div>
							</div>
						</div>
					</div>
				`;

				this.setupConsole();
				this.loadNetworkRequests();
				this.loadPerformanceMetrics();
				this.loadStorageData();
			}

			setupConsole() {
				const consoleInput = document.getElementById('consoleInput');
				const consoleOutput = document.getElementById('consoleOutput');

				consoleInput.addEventListener('keydown', (e) => {
					if (e.key === 'Enter') {
						const command = consoleInput.value.trim();
						if (command) {
							this.executeCommand(command);
							this.consoleHistory.push(command);
							this.consoleIndex = this.consoleHistory.length;
							consoleInput.value = '';
						}
					} else if (e.key === 'ArrowUp') {
						e.preventDefault();
						if (this.consoleIndex > 0) {
							this.consoleIndex--;
							consoleInput.value = this.consoleHistory[this.consoleIndex];
						}
					} else if (e.key === 'ArrowDown') {
						e.preventDefault();
						if (this.consoleIndex < this.consoleHistory.length - 1) {
							this.consoleIndex++;
							consoleInput.value = this.consoleHistory[this.consoleIndex];
						} else {
							this.consoleIndex = this.consoleHistory.length;
							consoleInput.value = '';
						}
					}
				});

				// Intercept console methods
				this.originalConsole = {
					log: console.log,
					error: console.error,
					warn: console.warn,
					info: console.info
				};

				const self = this;
				console.log = function(...args) {
					self.originalConsole.log.apply(console, args);
					self.addConsoleMessage('log', args.join(' '));
				};
				console.error = function(...args) {
					self.originalConsole.error.apply(console, args);
					self.addConsoleMessage('error', args.join(' '));
				};
				console.warn = function(...args) {
					self.originalConsole.warn.apply(console, args);
					self.addConsoleMessage('warn', args.join(' '));
				};
				console.info = function(...args) {
					self.originalConsole.info.apply(console, args);
					self.addConsoleMessage('info', args.join(' '));
				};
			}

			executeCommand(command) {
				this.addConsoleMessage('command', `> ${command}`);

				try {
					// CDN-specific commands
					if (command.startsWith('cdn.')) {
						this.executeCDNCommand(command);
					} else if (command === 'help') {
						this.showHelp();
					} else if (command === 'clear') {
						document.getElementById('consoleOutput').innerHTML = '';
					} else if (command.startsWith('fetch ')) {
						this.executeFetchCommand(command.substring(6));
					} else {
						// Execute JavaScript
						const result = eval(command);
						this.addConsoleMessage('result', result);
					}
				} catch (error) {
					this.addConsoleMessage('error', error.message);
				}
			}

			executeCDNCommand(command) {
				const parts = command.split('.');
				const method = parts[1];

				switch (method) {
					case 'status':
						fetch('/api/health')
							.then(r => r.json())
							.then(data => this.addConsoleMessage('result', JSON.stringify(data, null, 2)));
						break;
					case 'uploads':
						if (window.assetSearch?.auth?.isAuthenticated()) {
							fetch('/api/user/uploads', {
								headers: window.assetSearch.auth.getAuthHeader()
							})
							.then(r => r.json())
							.then(data => this.addConsoleMessage('result', JSON.stringify(data, null, 2)));
						} else {
							this.addConsoleMessage('error', 'Authentication required');
						}
						break;
					case 'quota':
						if (window.assetSearch?.auth?.isAuthenticated()) {
							fetch('/api/user/quota', {
								headers: window.assetSearch.auth.getAuthHeader()
							})
							.then(r => r.json())
							.then(data => this.addConsoleMessage('result', JSON.stringify(data, null, 2)));
						} else {
							this.addConsoleMessage('error', 'Authentication required');
						}
						break;
					default:
						this.addConsoleMessage('error', `Unknown CDN command: ${method}`);
				}
			}

			executeFetchCommand(url) {
				fetch(url)
					.then(response => {
						this.addConsoleMessage('info', `Response: ${response.status} ${response.statusText}`);
						return response.text();
					})
					.then(data => {
						try {
							const json = JSON.parse(data);
							this.addConsoleMessage('result', JSON.stringify(json, null, 2));
						} catch {
							this.addConsoleMessage('result', data);
						}
					})
					.catch(error => this.addConsoleMessage('error', error.message));
			}

			showHelp() {
				const helpText = `
Available Commands:
â€¢ help - Show this help message
â€¢ clear - Clear console output
â€¢ fetch <url> - Fetch data from URL
â€¢ cdn.status - Get CDN system status
â€¢ cdn.uploads - Get user uploads (requires auth)
â€¢ cdn.quota - Get user quota (requires auth)
â€¢ JavaScript expressions - Execute JavaScript code
				`;
				this.addConsoleMessage('info', helpText);
			}

			addConsoleMessage(type, message) {
				const consoleOutput = document.getElementById('consoleOutput');
				const timestamp = new Date().toLocaleTimeString();
				const line = document.createElement('div');
				line.className = `console-line console-${type}`;
				line.innerHTML = `
					<span class="console-timestamp">${timestamp}</span>
					<span class="console-message">${this.escapeHtml(message)}</span>
				`;
				consoleOutput.appendChild(line);
				consoleOutput.scrollTop = consoleOutput.scrollHeight;
			}

			escapeHtml(text) {
				const div = document.createElement('div');
				div.textContent = text;
				return div.innerHTML;
			}

			switchTab(tabName) {
				// Update tab buttons
				document.querySelectorAll('.devtools-tab').forEach(tab => {
					tab.classList.remove('active');
				});
				event.target.classList.add('active');

				// Update panels
				document.querySelectorAll('.devtools-panel').forEach(panel => {
					panel.classList.remove('active');
				});
				document.getElementById(`devtools-${tabName}`).classList.add('active');
			}

			loadNetworkRequests() {
				// Monitor network requests
				const requestsList = document.getElementById('networkRequestsList');

				// Override fetch to monitor requests
				const originalFetch = window.fetch;
				window.fetch = async function(...args) {
					const startTime = performance.now();
					const url = args[0];

					try {
						const response = await originalFetch.apply(this, args);
						const endTime = performance.now();
						const duration = Math.round(endTime - startTime);

						// Add to network panel
						const requestRow = document.createElement('div');
						requestRow.className = 'network-row';
						requestRow.innerHTML = `
							<div class="network-col">${url}</div>
							<div class="network-col network-status-${Math.floor(response.status / 100)}">${response.status}</div>
							<div class="network-col">${response.headers.get('content-type') || 'unknown'}</div>
							<div class="network-col">${response.headers.get('content-length') || 'unknown'}</div>
							<div class="network-col">${duration}ms</div>
						`;
						if (requestsList) requestsList.appendChild(requestRow);

						return response;
					} catch (error) {
						const endTime = performance.now();
						const duration = Math.round(endTime - startTime);

						const requestRow = document.createElement('div');
						requestRow.className = 'network-row';
						requestRow.innerHTML = `
							<div class="network-col">${url}</div>
							<div class="network-col network-status-error">Error</div>
							<div class="network-col">-</div>
							<div class="network-col">-</div>
							<div class="network-col">${duration}ms</div>
						`;
						if (requestsList) requestsList.appendChild(requestRow);

						throw error;
					}
				};
			}

			loadPerformanceMetrics() {
				const metrics = {
					'Memory Usage': `${(performance.memory?.usedJSHeapSize / 1024 / 1024).toFixed(2) || 'N/A'} MB`,
					'Total Memory': `${(performance.memory?.totalJSHeapSize / 1024 / 1024).toFixed(2) || 'N/A'} MB`,
					'Memory Limit': `${(performance.memory?.jsHeapSizeLimit / 1024 / 1024).toFixed(2) || 'N/A'} MB`,
					'Load Time': `${(performance.timing?.loadEventEnd - performance.timing?.navigationStart || 0)}ms`,
					'DOM Ready': `${(performance.timing?.domContentLoadedEventEnd - performance.timing?.navigationStart || 0)}ms`,
					'DOM Nodes': document.querySelectorAll('*').length,
					'Scripts': document.querySelectorAll('script').length,
					'Stylesheets': document.querySelectorAll('link[rel="stylesheet"], style').length
				};

				const metricsContainer = document.getElementById('performanceMetrics');
				if (metricsContainer) {
					metricsContainer.innerHTML = `
						<div class="devtools-grid">
							${Object.entries(metrics).map(([key, value]) => `
								<div class="devtools-metric">
									<div class="devtools-metric-title">${key}</div>
									<div class="devtools-metric-value">${value}</div>
								</div>
							`).join('')}
						</div>
					`;
				}
			}

			loadStorageData() {
				const storageContainer = document.getElementById('storageSections');

				const localStorageData = Object.keys(localStorage).map(key => ({
					key,
					value: localStorage.getItem(key),
					size: new Blob([localStorage.getItem(key)]).size
				}));

				const sessionStorageData = Object.keys(sessionStorage).map(key => ({
					key,
					value: sessionStorage.getItem(key),
					size: new Blob([sessionStorage.getItem(key)]).size
				}));

				storageContainer.innerHTML = `
					<div class="storage-section">
						<h3>Local Storage</h3>
						<div class="storage-table">
							<div class="storage-header">
								<div>Key</div>
								<div>Value</div>
								<div>Size</div>
							</div>
							${localStorageData.map(item => `
								<div class="storage-row">
									<div class="storage-key">${item.key}</div>
									<div class="storage-value">${item.value.substring(0, 100)}${item.value.length > 100 ? '...' : ''}</div>
									<div class="storage-size">${item.size} bytes</div>
								</div>
							`).join('')}
						</div>
					</div>
					<div class="storage-section">
						<h3>Session Storage</h3>
						<div class="storage-table">
							<div class="storage-header">
								<div>Key</div>
								<div>Value</div>
								<div>Size</div>
							</div>
							${sessionStorageData.map(item => `
								<div class="storage-row">
									<div class="storage-key">${item.key}</div>
									<div class="storage-value">${item.value.substring(0, 100)}${item.value.length > 100 ? '...' : ''}</div>
									<div class="storage-size">${item.size} bytes</div>
								</div>
							`).join('')}
						</div>
					</div>
				`;
			}
		}

		// Enhanced AssetSearch with authentication integration
		class AuthenticatedAssetSearch extends AssetSearch {
			constructor() {
				super();
				this.auth = cdnApp.auth;
			}

			// Override upload methods to include authentication
			async handleDirectUpload() {
				if (!this.auth.isAuthenticated()) {
					this.auth.showAuthModal(true);
					return;
				}

				const uploadPathHint = document.getElementById('uploadPath').value || '';
				const progressEl = document.getElementById('uploadProgress');
				const progressFill = document.getElementById('progressFill');
				const progressText = document.getElementById('progressText');

				progressEl.style.display = 'block';

				for (let i = 0; i < this.selectedFiles.length; i++) {
					const file = this.selectedFiles[i];
					const fileName = file.name;

					progressText.textContent = `Uploading ${fileName} with obfuscated naming (${i + 1}/${this.selectedFiles.length})`;

					const formData = new FormData();
					formData.append('file', file);
					formData.append('path', uploadPathHint);

					const response = await fetch('/api/upload/direct', {
						method: 'POST',
						headers: this.auth.getAuthHeader(),
						body: formData,
					});

					if (!response.ok) {
						if (response.status === 401) {
							this.auth.showAuthModal(true);
							return;
						}
						throw new Error(`Failed to upload ${fileName}: ${response.statusText}`);
					}

					const result = await response.json();
					this.lastUploadResult = {
						...result,
						method: 'Direct Upload (Authenticated)',
						fileName: fileName,
						obfuscatedPath: result.path,
						originalPathHint: result.originalPath || uploadPathHint,
					};

					const progress = ((i + 1) / this.selectedFiles.length) * 100;
					progressFill.style.width = `${progress}%`;
				}

				progressEl.style.display = 'none';
			}

			async handleDatabaseUpload() {
				if (!this.auth.isAuthenticated()) {
					this.auth.showAuthModal(true);
					return;
				}

				const assetName = document.getElementById('assetName').value;
				const category = document.getElementById('assetCategory').value;
				const description = document.getElementById('assetDescription').value;
				const tags = document.getElementById('assetTags').value;

				if (!assetName.trim()) {
					throw new Error('Asset name is required');
				}

				const progressEl = document.getElementById('uploadProgressDb');
				const progressFill = document.getElementById('progressFillDb');
				const progressText = document.getElementById('progressTextDb');

				progressEl.style.display = 'block';

				for (let i = 0; i < this.selectedFiles.length; i++) {
					const file = this.selectedFiles[i];

					progressText.textContent = `Uploading ${file.name} to database (${i + 1}/${this.selectedFiles.length})`;

					const formData = new FormData();
					formData.append('file', file);
					formData.append('name', assetName);
					formData.append('category', category);
					formData.append('description', description);
					formData.append('tags', tags);

					const response = await fetch('/api/upload/database', {
						method: 'POST',
						headers: this.auth.getAuthHeader(),
						body: formData,
					});

					if (!response.ok) {
						if (response.status === 401) {
							this.auth.showAuthModal(true);
							return;
						}
						throw new Error(`Failed to upload ${file.name}: ${response.statusText}`);
					}

					const result = await response.json();
					this.lastUploadResult = {
						...result,
						method: 'Database Storage (Authenticated)',
						fileName: file.name,
						obfuscatedPath: result.path,
						originalCategory: result.originalCategory,
					};

					const progress = ((i + 1) / this.selectedFiles.length) * 100;
					progressFill.style.width = `${progress}%`;
				}

				progressEl.style.display = 'none';
			}
		}

		// File Editor Modal Class
		class FileEditorModal {
			constructor() {
				this.modal = document.getElementById('fileEditorModal');
				this.closeBtn = document.getElementById('fileEditorClose');
				this.fileListContainer = document.getElementById('fileListContainer');
				this.fileSearchInput = document.getElementById('fileSearchInput');
				this.refreshFilesBtn = document.getElementById('refreshFilesBtn');
				this.currentFileSection = document.getElementById('currentFileSection');
				this.currentFileInfo = document.getElementById('currentFileInfo');
				this.saveActionsSection = document.getElementById('saveActionsSection');
				this.changeDescription = document.getElementById('changeDescription');
				this.saveChangesBtn = document.getElementById('saveChangesBtn');
				this.discardChangesBtn = document.getElementById('discardChangesBtn');
				this.viewVersionsBtn = document.getElementById('viewVersionsBtn');
				this.downloadFileBtn = document.getElementById('downloadFileBtn');

				// Editor elements
				this.editorTabs = document.getElementById('editorTabs');
				this.contentEditor = document.getElementById('contentEditor');
				this.infoArea = document.getElementById('infoArea');
				this.metadataEditor = document.getElementById('metadataEditor');
				this.previewArea = document.getElementById('previewArea');
				this.codeEditor = document.getElementById('codeEditor');
				this.lineNumbers = document.getElementById('lineNumbers');
				this.languageSelect = document.getElementById('languageSelect');
				this.cursorPosition = document.getElementById('cursorPosition');
				this.fileSize = document.getElementById('fileSize');
				this.changeStatus = document.getElementById('changeStatus');
				this.fileType = document.getElementById('fileType');

				// Info area elements
				this.infoFileName = document.getElementById('infoFileName');
				this.infoFileSize = document.getElementById('infoFileSize');
				this.infoMimeType = document.getElementById('infoMimeType');
				this.infoCreated = document.getElementById('infoCreated');
				this.infoModified = document.getElementById('infoModified');
				this.infoFileId = document.getElementById('infoFileId');
				this.versionsContainer = document.getElementById('versionsContainer');
				this.refreshVersionsBtn = document.getElementById('refreshVersionsBtn');

				// Metadata form elements
				this.metaFileName = document.getElementById('metaFileName');
				this.metaDescription = document.getElementById('metaDescription');
				this.metaCategory = document.getElementById('metaCategory');
				this.metaTags = document.getElementById('metaTags');
				this.tagsDisplay = document.getElementById('tagsDisplay');
				this.customFieldsContainer = document.getElementById('customFieldsContainer');
				this.addCustomFieldBtn = document.getElementById('addCustomFieldBtn');

				// Toolbar buttons
				this.undoBtn = document.getElementById('undoBtn');
				this.redoBtn = document.getElementById('redoBtn');
				this.formatBtn = document.getElementById('formatBtn');
				this.wrapBtn = document.getElementById('wrapBtn');

				// Preview container
				this.previewContainer = document.getElementById('previewContainer');

				// State
				this.currentFile = null;
				this.originalContent = null;
				this.originalMetadata = null;
				this.hasUnsavedChanges = false;
				this.files = [];
				this.filteredFiles = [];
				this.tags = [];
				this.customFields = [];
				this.undoStack = [];
				this.redoStack = [];
				this.maxUndoSteps = 50;

				this.setupEventListeners();
			}

			setupEventListeners() {
				// Modal controls
				this.closeBtn.addEventListener('click', () => this.hide());
				this.modal.addEventListener('click', (e) => {
					if (e.target === this.modal) this.hide();
				});

				// File management
				this.refreshFilesBtn.addEventListener('click', () => this.loadFiles());
				this.fileSearchInput.addEventListener('input', (e) => this.filterFiles(e.target.value));

				// Editor tabs
				this.editorTabs.addEventListener('click', (e) => {
					const tab = e.target.closest('.editor-tab');
					if (tab) this.switchTab(tab.dataset.tab);
				});

				// Content editor
				this.codeEditor.addEventListener('input', () => this.handleContentChange());
				this.codeEditor.addEventListener('scroll', () => this.syncLineNumbers());
				this.codeEditor.addEventListener('keyup', () => this.updateCursorPosition());
				this.codeEditor.addEventListener('click', () => this.updateCursorPosition());
				this.languageSelect.addEventListener('change', () => this.updateLanguage());

				// Toolbar buttons
				this.undoBtn.addEventListener('click', () => this.undo());
				this.redoBtn.addEventListener('click', () => this.redo());
				this.formatBtn.addEventListener('click', () => this.formatCode());
				this.wrapBtn.addEventListener('click', () => this.toggleWordWrap());

				// Metadata editor
				this.metaFileName.addEventListener('input', () => this.handleMetadataChange());
				this.metaDescription.addEventListener('input', () => this.handleMetadataChange());
				this.metaCategory.addEventListener('change', () => this.handleMetadataChange());
				this.metaTags.addEventListener('keydown', (e) => this.handleTagInput(e));
				this.addCustomFieldBtn.addEventListener('click', () => this.addCustomField());

				// Save actions
				this.saveChangesBtn.addEventListener('click', () => this.saveChanges());
				this.discardChangesBtn.addEventListener('click', () => this.discardChanges());
				this.viewVersionsBtn.addEventListener('click', () => this.viewVersionHistory());
				this.downloadFileBtn.addEventListener('click', () => this.downloadFile());

				// Info area
				this.refreshVersionsBtn.addEventListener('click', () => this.loadVersions());

				// Keyboard shortcuts
				document.addEventListener('keydown', (e) => this.handleKeyboardShortcuts(e));
			}

			async show() {
				if (!cdnApp.auth.isAuthenticated()) {
					cdnApp.auth.showAuthModal(true);
					return;
				}

				// Copy background content
				const backgroundContent = document.querySelector('#fileEditorModal .modal-background-content');
				const mainContent = document.querySelector('.container');
				if (backgroundContent && mainContent) {
					backgroundContent.innerHTML = mainContent.outerHTML;
				}

				await this.loadFiles();
				this.modal.classList.add('show');
			}

			hide() {
				if (this.hasUnsavedChanges) {
					if (!confirm('You have unsaved changes. Are you sure you want to close the editor?')) {
						return;
					}
				}
				this.modal.classList.remove('show');
				this.resetEditor();
			}

			async loadFiles() {
				this.showLoading();
				try {
					const response = await fetch('/api/user/uploads?limit=100', {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						if (response.status === 401) {
							cdnApp.auth.showAuthModal(true);
							return;
						}
						throw new Error('Failed to load files');
					}

					const result = await response.json();
					this.files = result.uploads || [];
					this.filteredFiles = [...this.files];
					for (let index = 0; index < this.files.length; index++) {
						const file = this.files[index];
						file.mimeType = file.mimeType ?? file.type ?? file.mime_type;
						this.files[index] = file;
					}
					this.renderFileList();

				} catch (error) {
					console.error('Load files error:', error);
					this.showError('Failed to load files: ' + error.message);
				}
			}

			showLoading() {
				this.fileListContainer.innerHTML = `
					<div class="loading-spinner">
						<div class="spinner"></div>
						<span>Loading files...</span>
					</div>
				`;
			}

			showError(message) {
				this.fileListContainer.innerHTML = `
					<div class="loading-spinner">
						<span style="color: hsl(var(--destructive));">${message}</span>
					</div>
				`;
			}

			filterFiles(query) {
				if (!query.trim()) {
					this.filteredFiles = [...this.files];
				} else {
					const searchTerm = query.toLowerCase();
					this.filteredFiles = this.files.filter(file =>
						file.name.toLowerCase().includes(searchTerm) ||
						file.originalName.toLowerCase().includes(searchTerm) ||
						(file.category && file.category.toLowerCase().includes(searchTerm)) ||
						(file.tags && file.tags.some(tag => tag.toLowerCase().includes(searchTerm)))
					);
				}
				this.renderFileList();
			}

			renderFileList() {
				if (this.filteredFiles.length === 0) {
					this.fileListContainer.innerHTML = `
						<div class="loading-spinner">
							<span>No files found</span>
						</div>
					`;
					return;
				}

				this.fileListContainer.innerHTML = this.filteredFiles.map(file => `
					<div class="file-item" data-file-id="${file.id}">
						<div class="file-item-icon">
							${this.getFileIcon(file.mimeType || file.type)}
						</div>
						<div class="file-item-info">
							<div class="file-item-name">${file.name}</div>
							<div class="file-item-meta">
								<span>${this.formatFileSize(file.size)}</span>
								<span>${file.category || 'No category'}</span>
								<span>${new Date(file.uploadedAt).toLocaleDateString()}</span>
							</div>
						</div>
					</div>
				`).join('');

				// Add click listeners
				this.fileListContainer.querySelectorAll('.file-item').forEach(item => {
					item.addEventListener('click', () => {
						const fileId = item.dataset.fileId;
						this.selectFile(fileId);
					});
				});
			}

			getFileIcon(mimeType) {
				if (mimeType == undefined || mimeType == null || mimeType == ''){
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
						<polyline points="14,2 14,8 20,8"/>
					</svg>`;
				}
				if(mimeType.startsWith('application/')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
						<polyline points="14,2 14,8 20,8"/>
					</svg>`;
				}
				if (mimeType.startsWith('image/')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
						<circle cx="9" cy="9" r="2"/>
						<path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
					</svg>`;
				} else if (mimeType.startsWith('video/')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polygon points="23 7 16 12 23 17 23 7"/>
						<rect width="15" height="14" x="1" y="5" rx="2" ry="2"/>
					</svg>`;
				} else if (mimeType.startsWith('audio/')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M9 18V5l12-2v13"/>
						<circle cx="6" cy="18" r="3"/>
						<circle cx="18" cy="16" r="3"/>
					</svg>`;
				} else if (mimeType.includes('javascript') || mimeType.includes('json')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<polyline points="16,18 22,12 16,6"/>
						<polyline points="8,6 2,12 8,18"/>
					</svg>`;
				} else if (mimeType.includes('html') || mimeType.includes('css')) {
					return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
						<polyline points="14,2 14,8 20,8"/>
						<line x1="16" y1="13" x2="8" y2="13"/>
						<line x1="16" y1="17" x2="8" y2="17"/>
						<polyline points="10,9 9,9 8,9"/>
					</svg>`;
				}
				return `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
					<polyline points="14,2 14,8 20,8"/>
				</svg>`;
			}

			async selectFileById(fileId) {
				// Open the file editor and select the file
				await this.show();
				await this.selectFile(fileId);
			}

			async selectFile(fileId) {
				const file = this.files.find(f => f.id === fileId);
				if (!file) return;

				// Check for unsaved changes
				if (this.hasUnsavedChanges) {
					if (!confirm('You have unsaved changes. Do you want to discard them and select a new file?')) {
						return;
					}
				}

				try {
					// Load file details and content
					const response = await fetch(`/api/file-editor/${fileId}/info`, {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						throw new Error('Failed to load file details');
					}

					const result = await response.json();
					this.currentFile = result.file;
					this.originalContent = result.content;
					this.originalMetadata = {
						name: this.currentFile.name,
						description: this.currentFile.description || '',
						category: this.currentFile.category || '',
						tags: [...(this.currentFile.tags || [])],
						customFields: {...(this.currentFile.customFields || {})}
					};

					// Update UI
					this.updateFileSelection(fileId);
					this.populateEditor();
					this.showCurrentFileInfo();
					this.updatePreview();
					this.resetChangeTracking();

				} catch (error) {
					console.error('Select file error:', error);
					alert('Failed to load file: ' + error.message);
				}
			}

			updateFileSelection(selectedId) {
				this.fileListContainer.querySelectorAll('.file-item').forEach(item => {
					item.classList.toggle('selected', item.dataset.fileId === selectedId);
				});
			}

			populateEditor() {
				if (!this.currentFile) return;

				// Populate content editor
				this.codeEditor.value = this.originalContent || '';
				this.updateLineNumbers();
				this.updateCursorPosition();
				this.updateFileSize();
				this.detectLanguage();

				// Populate metadata editor
				this.metaFileName.value = this.originalMetadata.name;
				this.metaDescription.value = this.originalMetadata.description;
				this.metaCategory.value = this.originalMetadata.category;
				this.populateTags();
				this.populateCustomFields();
			}

			populateTags() {
				this.tags = [...this.originalMetadata.tags];
				this.renderTags();
			}

			renderTags() {
				this.tagsDisplay.innerHTML = this.tags.map(tag => `
					<div class="tag-item">
						<span>${tag}</span>
						<button class="tag-remove" onclick="window.cdnApp.fileEditor.removeTag('${tag}')">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="18" y1="6" x2="6" y2="18"/>
								<line x1="6" y1="6" x2="18" y2="18"/>
							</svg>
						</button>
					</div>
				`).join('');
			}

			populateCustomFields() {
				this.customFields = Object.entries(this.originalMetadata.customFields).map(([key, value]) => ({ key, value }));
				this.renderCustomFields();
			}

			renderCustomFields() {
				const fieldsHtml = this.customFields.map((field, index) => `
					<div class="custom-field">
						<div class="form-group">
							<label class="form-label">Field Name</label>
							<input type="text" class="form-input" value="${field.key}" onchange="window.cdnApp.fileEditor.updateCustomField(${index}, 'key', this.value)" />
						</div>
						<div class="form-group">
							<label class="form-label">Field Value</label>
							<input type="text" class="form-input" value="${field.value}" onchange="window.cdnApp.fileEditor.updateCustomField(${index}, 'value', this.value)" />
						</div>
						<button class="remove-field-btn" onclick="window.cdnApp.fileEditor.removeCustomField(${index})">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<line x1="18" y1="6" x2="6" y2="18"/>
								<line x1="6" y1="6" x2="18" y2="18"/>
							</svg>
						</button>
					</div>
				`).join('');

				this.customFieldsContainer.innerHTML = fieldsHtml + `
					<button class="add-field-btn" onclick="window.cdnApp.fileEditor.addCustomField()">
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<line x1="12" y1="5" x2="12" y2="19"/>
							<line x1="5" y1="12" x2="19" y2="12"/>
						</svg>
						Add Custom Field
					</button>
				`;
			}

			showCurrentFileInfo() {
				if (!this.currentFile) return;

				this.currentFileInfo.innerHTML = `
					<div class="current-file-detail">
						<span class="current-file-label">Name</span>
						<span class="current-file-value">${this.currentFile.name}</span>
					</div>
					<div class="current-file-detail">
						<span class="current-file-label">Size</span>
						<span class="current-file-value">${this.formatFileSize(this.currentFile.size)}</span>
					</div>
					<div class="current-file-detail">
						<span class="current-file-label">Type</span>
						<span class="current-file-value">${this.currentFile.mimeType}</span>
					</div>
					<div class="current-file-detail">
						<span class="current-file-label">Modified</span>
						<span class="current-file-value">${new Date(this.currentFile.uploadedAt).toLocaleString()}</span>
					</div>
				`;

				this.currentFileSection.style.display = 'block';
			}

			switchTab(tabName) {
				// Update tab buttons
				this.editorTabs.querySelectorAll('.editor-tab').forEach(tab => {
					tab.classList.toggle('active', tab.dataset.tab === tabName);
				});

				// Update content areas
				document.querySelectorAll('.editor-area').forEach(area => {
					area.classList.toggle('active', area.id === tabName + 'Editor' || area.id === tabName + 'Area');
				});

				// Handle specific tab actions
				if (tabName === 'preview') {
					this.updatePreview();
				} else if (tabName === 'info') {
					this.populateInfoArea();
					this.loadVersions();
				}
			}

			handleContentChange() {
				this.addToUndoStack();
				this.updateLineNumbers();
				this.updateFileSize();
				this.markAsChanged();
				this.updatePreview();
			}

			handleMetadataChange() {
				this.markAsChanged();
			}

			handleTagInput(e) {
				if (e.key === 'Enter' && e.target.value.trim()) {
					e.preventDefault();
					const tag = e.target.value.trim();
					if (!this.tags.includes(tag)) {
						this.tags.push(tag);
						this.renderTags();
						this.handleMetadataChange();
					}
					e.target.value = '';
				}
			}

			addCustomField() {
				this.customFields.push({ key: '', value: '' });
				this.renderCustomFields();
				this.handleMetadataChange();
			}

			removeCustomField(index) {
				this.customFields.splice(index, 1);
				this.renderCustomFields();
				this.handleMetadataChange();
			}

			updateCustomField(index, property, value) {
				if (this.customFields[index]) {
					this.customFields[index][property] = value;
					this.handleMetadataChange();
				}
			}

			removeTag(tag) {
				this.tags = this.tags.filter(t => t !== tag);
				this.renderTags();
				this.handleMetadataChange();
			}

			populateInfoArea() {
				if (!this.currentFile) return;

				this.infoFileName.textContent = this.currentFile.name;
				this.infoFileSize.textContent = this.formatFileSize(this.currentFile.size);
				this.infoMimeType.textContent = this.currentFile.mimeType || 'Unknown';
				this.infoCreated.textContent = new Date(this.currentFile.uploadedAt).toLocaleString();
				this.infoModified.textContent = new Date(this.currentFile.uploadedAt).toLocaleString();
				this.infoFileId.textContent = this.currentFile.id;
			}

			async loadVersions() {
				if (!this.currentFile) return;

				this.versionsContainer.innerHTML = `
					<div class="versions-loading">
						<div class="spinner"></div>
						<span>Loading versions...</span>
					</div>
				`;

				try {
					const response = await fetch(`/api/versions/${this.currentFile.id}`, {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						throw new Error('Failed to load versions');
					}

					const result = await response.json();
					this.renderVersions(result.versions || []);

				} catch (error) {
					console.error('Load versions error:', error);
					this.versionsContainer.innerHTML = `
						<div class="versions-empty">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<circle cx="12" cy="12" r="10"/>
								<line x1="12" y1="8" x2="12" y2="12"/>
								<line x1="12" y1="16" x2="12.01" y2="16"/>
							</svg>
							<p>Failed to load versions</p>
							<small>${error.message}</small>
						</div>
					`;
				}
			}

			renderVersions(versions) {
				if (versions.length === 0) {
					this.versionsContainer.innerHTML = `
						<div class="versions-empty">
							<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/>
								<polyline points="14,2 14,8 20,8"/>
							</svg>
							<p>No versions found</p>
							<small>This file has no version history</small>
						</div>
					`;
					return;
				}

				this.versionsContainer.innerHTML = versions.map((version, index) => `
					<div class="version-item ${index === 0 ? 'current' : ''}" data-version-id="${version.version}">
						<div class="version-info">
							<div class="version-number">
								${index === 0 ? 'Current Version' : `Version ${versions.length - index}`}
								${version.description ? ` - ${version.description}` : ''}
							</div>
							<div class="version-date">${new Date(version.timestamp).toLocaleString()}</div>
						</div>
						<div class="version-size">${this.formatFileSize(version.changes.contentSize || 0)}</div>
						<div class="version-size">${this.formatFileSize(version.changes.contentHash || 0)}</div>
						<div class="version-actions">
							${index === 0 ? '' : `
								<button class="version-action-btn" title="View this version" onclick="window.fileEditor.viewVersion('${version.version}')">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/>
										<circle cx="12" cy="12" r="3"/>
									</svg>
								</button>
								<button class="version-action-btn primary" title="Restore this version" onclick="window.fileEditor.restoreVersion('${version.version}')">
									<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
										<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
										<path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
									</svg>
								</button>
							`}
						</div>
					</div>
				`).join('');
			}

			async viewVersion(versionId) {
				try {
					const response = await fetch(`/api/versions/${versionId}/content`, {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						throw new Error('Failed to load version content');
					}

					const result = await response.json();
					
					// Open in a new modal or tab for comparison
					const newWindow = window.open('', '_blank');
					newWindow.document.write(`
						<html>
							<head>
								<title>Version ${versionId} - ${this.currentFile.name}</title>
								<style>
									body { font-family: monospace; padding: 20px; background: #1a1a1a; color: #ffffff; }
									pre { white-space: pre-wrap; word-wrap: break-word; }
								</style>
							</head>
							<body>
								<h2>Version ${versionId} - ${this.currentFile.name}</h2>
								<pre>${this.escapeHtml(result.content)}</pre>
							</body>
						</html>
					`);

				} catch (error) {
					console.error('View version error:', error);
					alert('Failed to load version: ' + error.message);
				}
			}

			async restoreVersion(versionId) {
				if (!confirm('Are you sure you want to restore this version? This will replace the current content.')) {
					return;
				}

				try {
					const response = await fetch(`/api/file-editor/version/${versionId}/content`, {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						throw new Error('Failed to load version content');
					}

					const result = await response.json();
					
					// Update the editor with the version content
					this.codeEditor.value = result.content;
					this.updateLineNumbers();
					this.updateFileSize();
					this.updatePreview();
					this.markAsChanged();

					// Switch to content tab to show the restored content
					this.switchTab('content');

				} catch (error) {
					console.error('Restore version error:', error);
					alert('Failed to restore version: ' + error.message);
				}
			}

			markAsChanged() {
				this.hasUnsavedChanges = true;
				this.changeStatus.textContent = 'Unsaved changes';
				this.changeStatus.style.color = 'hsl(var(--destructive))';
				this.saveActionsSection.style.display = 'block';
			}

			resetChangeTracking() {
				this.hasUnsavedChanges = false;
				this.changeStatus.textContent = 'No changes';
				this.changeStatus.style.color = 'hsl(var(--muted-foreground))';
				this.saveActionsSection.style.display = 'none';
				this.undoStack = [];
				this.redoStack = [];
			}

			updateLineNumbers() {
				const lines = this.codeEditor.value.split('\n');
				const lineNumbers = lines.map((_, i) => i + 1).join('\n');
				this.lineNumbers.textContent = lineNumbers;
			}

			syncLineNumbers() {
				this.lineNumbers.scrollTop = this.codeEditor.scrollTop;
			}

			updateCursorPosition() {
				const textarea = this.codeEditor;
				const lines = textarea.value.substr(0, textarea.selectionStart).split('\n');
				const line = lines.length;
				const column = lines[lines.length - 1].length + 1;
				this.cursorPosition.textContent = `Line ${line}, Column ${column}`;
			}

			updateFileSize() {
				const size = new Blob([this.codeEditor.value]).size;
				this.fileSize.textContent = this.formatFileSize(size);
			}

			detectLanguage() {
				if (!this.currentFile) return;

				const extension = this.currentFile.name.split('.').pop()?.toLowerCase();
				const mimeType = this.currentFile.mimeType;

				let language = 'text';
				if (extension === 'js' || mimeType.includes('javascript')) language = 'javascript';
				else if (extension === 'ts' || mimeType.includes('typescript')) language = 'typescript';
				else if (extension === 'html' || mimeType.includes('html')) language = 'html';
				else if (extension === 'css' || mimeType.includes('css')) language = 'css';
				else if (extension === 'json' || mimeType.includes('json')) language = 'json';
				else if (extension === 'md' || extension === 'markdown') language = 'markdown';

				this.languageSelect.value = language;
				this.fileType.textContent = language.charAt(0).toUpperCase() + language.slice(1);
			}

			updateLanguage() {
				const language = this.languageSelect.value;
				this.fileType.textContent = language.charAt(0).toUpperCase() + language.slice(1);
			}

			updatePreview() {
				if (!this.currentFile) return;

				const content = this.codeEditor.value;
				const mimeType = this.currentFile.mimeType;

				if (mimeType.startsWith('image/')) {
					this.previewContainer.innerHTML = `
						<div class="preview-content">
							<img src="${this.currentFile.path}" alt="${this.currentFile.name}" class="preview-image" />
						</div>
					`;
				} else if (mimeType.startsWith('video/')) {
					this.previewContainer.innerHTML = `
						<div class="preview-content">
							<video src="${this.currentFile.path}" controls class="preview-video"></video>
						</div>
					`;
				} else if (mimeType.startsWith('audio/')) {
					this.previewContainer.innerHTML = `
						<div class="preview-content">
							<audio src="${this.currentFile.path}" controls class="preview-audio"></audio>
						</div>
					`;
				} else if (mimeType.includes('html')) {
					this.previewContainer.innerHTML = `
						<div class="preview-content">
							<iframe srcdoc="${content.replace(/"/g, '&quot;')}" style="width: 100%; height: 400px; border: 1px solid hsl(var(--border)); border-radius: var(--radius);"></iframe>
						</div>
					`;
				} else {
					this.previewContainer.innerHTML = `
						<div class="preview-content">
							<pre class="preview-code">${this.escapeHtml(content)}</pre>
						</div>
					`;
				}
			}

			addToUndoStack() {
				this.undoStack.push(this.codeEditor.value);
				if (this.undoStack.length > this.maxUndoSteps) {
					this.undoStack.shift();
				}
				this.redoStack = [];
			}

			undo() {
				if (this.undoStack.length > 0) {
					this.redoStack.push(this.codeEditor.value);
					this.codeEditor.value = this.undoStack.pop();
					this.updateLineNumbers();
					this.updateFileSize();
					this.updatePreview();
				}
			}

			redo() {
				if (this.redoStack.length > 0) {
					this.undoStack.push(this.codeEditor.value);
					this.codeEditor.value = this.redoStack.pop();
					this.updateLineNumbers();
					this.updateFileSize();
					this.updatePreview();
				}
			}

			formatCode() {
				try {
					const language = this.languageSelect.value;
					let formatted = this.codeEditor.value;

					if (language === 'json') {
						formatted = JSON.stringify(JSON.parse(formatted), null, 2);
					} else if (language === 'html') {
						// Basic HTML formatting
						formatted = formatted.replace(/></g, '>\n<');
					}

					this.addToUndoStack();
					this.codeEditor.value = formatted;
					this.updateLineNumbers();
					this.updateFileSize();
					this.markAsChanged();
				} catch (error) {
					alert('Failed to format code: ' + error.message);
				}
			}

			toggleWordWrap() {
				const isWrapped = this.codeEditor.style.whiteSpace === 'pre-wrap';
				this.codeEditor.style.whiteSpace = isWrapped ? 'pre' : 'pre-wrap';
				this.wrapBtn.classList.toggle('active', !isWrapped);
			}

			async saveChanges() {
				if (!this.currentFile || !this.hasUnsavedChanges) return;

				const description = this.changeDescription.value.trim() || 'File updated via editor';

				try {
					this.saveChangesBtn.disabled = true;
					this.saveChangesBtn.innerHTML = `
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/>
							<path d="M3 3v5h5"/>
						</svg>
						Saving...
					`;

					// Save content if changed
					const contentChanged = this.codeEditor.value !== this.originalContent;
					if (contentChanged) {
						const contentResponse = await fetch(`/api/file-editor/${this.currentFile.id}/content`, {
							method: 'PUT',
							headers: {
								'Content-Type': 'application/json',
								...cdnApp.auth.getAuthHeader()
							},
							body: JSON.stringify({
								content: this.codeEditor.value,
								description: description
							})
						});

						if (!contentResponse.ok) {
							throw new Error('Failed to save content');
						}
					}

					// Save metadata if changed
					const metadataChanged = this.hasMetadataChanged();
					if (metadataChanged) {
						const customFieldsObj = {};
						this.customFields.forEach(field => {
							if (field.key && field.value) {
								customFieldsObj[field.key] = field.value;
							}
						});

						const metadataResponse = await fetch(`/api/file-editor/${this.currentFile.id}/metadata`, {
							method: 'PUT',
							headers: {
								'Content-Type': 'application/json',
								...cdnApp.auth.getAuthHeader()
							},
							body: JSON.stringify({
								name: this.metaFileName.value,
								description: this.metaDescription.value,
								category: this.metaCategory.value,
								tags: this.tags,
								customFields: customFieldsObj,
								changeDescription: description
							})
						});

						if (!metadataResponse.ok) {
							throw new Error('Failed to save metadata');
						}
					}

					// Update original values
					this.originalContent = this.codeEditor.value;
					this.originalMetadata = {
						name: this.metaFileName.value,
						description: this.metaDescription.value,
						category: this.metaCategory.value,
						tags: [...this.tags],
						customFields: {...this.getCustomFieldsObject()}
					};

					this.resetChangeTracking();
					this.changeDescription.value = '';
					alert('Changes saved successfully!');

				} catch (error) {
					console.error('Save error:', error);
					alert('Failed to save changes: ' + error.message);
				} finally {
					this.saveChangesBtn.disabled = false;
					this.saveChangesBtn.innerHTML = `
						<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"/>
							<polyline points="17,21 17,13 7,13 7,21"/>
							<polyline points="7,3 7,8 15,8"/>
						</svg>
						Save Changes
					`;
				}
			}

			hasMetadataChanged() {
				return (
					this.metaFileName.value !== this.originalMetadata.name ||
					this.metaDescription.value !== this.originalMetadata.description ||
					this.metaCategory.value !== this.originalMetadata.category ||
					JSON.stringify(this.tags) !== JSON.stringify(this.originalMetadata.tags) ||
					JSON.stringify(this.getCustomFieldsObject()) !== JSON.stringify(this.originalMetadata.customFields)
				);
			}

			getCustomFieldsObject() {
				const obj = {};
				this.customFields.forEach(field => {
					if (field.key && field.value) {
						obj[field.key] = field.value;
					}
				});
				return obj;
			}

			discardChanges() {
				if (!confirm('Are you sure you want to discard all changes?')) return;

				this.populateEditor();
				this.resetChangeTracking();
				this.changeDescription.value = '';
			}

			async viewVersionHistory() {
				if (!this.currentFile) return;

				try {
					const response = await fetch(`/api/versions/${this.currentFile.id}`, {
						headers: cdnApp.auth.getAuthHeader()
					});

					if (!response.ok) {
						throw new Error('Failed to load version history');
					}

					const result = await response.json();
					this.showVersionHistoryModal(result.versions);

				} catch (error) {
					console.error('Version history error:', error);
					alert('Failed to load version history: ' + error.message);
				}
			}

			showVersionHistoryModal(versions) {
				const modal = document.createElement('div');
				modal.className = 'version-history-modal';
				modal.innerHTML = `
					<div class="modal-backdrop"></div>
					<div class="modal-content" style="max-width: 800px; max-height: 80vh; overflow-y: auto;">
						<div class="modal-header">
							<h3>Version History - ${this.currentFile.name}</h3>
							<button class="modal-close" onclick="this.closest('.version-history-modal').remove()">
								<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
									<line x1="18" y1="6" x2="6" y2="18"/>
									<line x1="6" y1="6" x2="18" y2="18"/>
								</svg>
							</button>
						</div>
						<div class="modal-body">
							<div class="version-list">
								${versions.map((version, index) => `
									<div class="version-item">
										<div class="version-header">
											<div class="version-info">
												<strong>Version ${version.version}</strong>
												<span class="version-date">${new Date(version.timestamp).toLocaleString()}</span>
											</div>
											<div class="version-actions">
												<button class="btn btn-secondary btn-sm" onclick="window.cdnApp.fileEditor.restoreVersion('${version.id}')">
													Restore
												</button>
											</div>
										</div>
										<div class="version-details">
											<div><strong>Author:</strong> ${version.author}</div>
											<div><strong>Changes:</strong> ${version.changeType}</div>
											${version.description ? `<div><strong>Description:</strong> ${version.description}</div>` : ''}
										</div>
									</div>
								`).join('')}
							</div>
						</div>
					</div>
				`;

				document.body.appendChild(modal);
				modal.classList.add('show');

				// Close on backdrop click
				modal.querySelector('.modal-backdrop').addEventListener('click', () => {
					modal.remove();
				});
			}

			async restoreVersion(versionId) {
				if (!confirm('Are you sure you want to restore this version? This will overwrite the current content.')) {
					return;
				}

				try {
					const response = await fetch(`/api/versions/${this.currentFile.id}/restore`, {
						method: 'POST',
						headers: {
							'Content-Type': 'application/json',
							...cdnApp.auth.getAuthHeader()
						},
						body: JSON.stringify({ versionId })
					});

					if (!response.ok) {
						throw new Error('Failed to restore version');
					}

					// Close version history modal
					document.querySelector('.version-history-modal')?.remove();

					// Reload the file
					await this.selectFile(this.currentFile.id);
					alert('Version restored successfully!');

				} catch (error) {
					console.error('Restore version error:', error);
					alert('Failed to restore version: ' + error.message);
				}
			}

			downloadFile() {
				if (!this.currentFile) return;
				window.open(this.currentFile.path, '_blank');
			}

			handleKeyboardShortcuts(e) {
				if (!this.modal.classList.contains('show')) return;

				if (e.ctrlKey || e.metaKey) {
					switch (e.key) {
						case 's':
							e.preventDefault();
							this.saveChanges();
							break;
						case 'z':
							if (e.shiftKey) {
								e.preventDefault();
								this.redo();
							} else {
								e.preventDefault();
								this.undo();
							}
							break;
						case 'y':
							e.preventDefault();
							this.redo();
							break;
						case 'f':
							if (e.shiftKey) {
								e.preventDefault();
								this.formatCode();
							}
							break;
					}
				}
			}

			resetEditor() {
				this.currentFile = null;
				this.originalContent = null;
				this.originalMetadata = null;
				this.hasUnsavedChanges = false;
				this.tags = [];
				this.customFields = [];
				this.codeEditor.value = '';
				this.changeDescription.value = '';
				this.currentFileSection.style.display = 'none';
				this.saveActionsSection.style.display = 'none';
				this.resetChangeTracking();
			}

			formatFileSize(bytes) {
				if (bytes === 0) return '0 Bytes';
				const k = 1024;
				const sizes = ['Bytes', 'KB', 'MB', 'GB'];
				const i = Math.floor(Math.log(bytes) / Math.log(k));
				return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
			}

			escapeHtml(text) {
				const div = document.createElement('div');
				div.textContent = text;
				return div.innerHTML;
			}
		}

		// Create CDN Application object
		window.cdnApp = {
			auth: null,
			statusModal: null,
			apiModal: null,
			devToolsModal: null,
			assetSearch: null,
			fileEditor: null
		};

		// Initialize authenticated search when DOM is loaded
		document.addEventListener('DOMContentLoaded', () => {
			// Initialize authentication first
			cdnApp.auth = new SXAPAuth();

			// Initialize asset search with authentication
			cdnApp.assetSearch = new AuthenticatedAssetSearch();

			// Initialize modals
			cdnApp.statusModal = new StatusModal();
			cdnApp.apiModal = new APIModal();
			cdnApp.devToolsModal = new DevToolsModal();
			cdnApp.fileEditor = new FileEditorModal();

			// Setup footer link event listeners
			document.getElementById('statusLink').addEventListener('click', (e) => {
				e.preventDefault();
				cdnApp.statusModal.show();
			});

			document.getElementById('apiLink').addEventListener('click', (e) => {
				e.preventDefault();
				cdnApp.apiModal.show();
			});

			document.getElementById('devToolsLink').addEventListener('click', (e) => {
				e.preventDefault();
				cdnApp.devToolsModal.show();
			});

			// Add file editor button to the main interface
			const uploadBtn = document.querySelector('.upload-btn');
			if (uploadBtn) {
				const editorBtn = document.createElement('button');
				editorBtn.className = 'document-btn';
				editorBtn.title = 'File Editor';
				editorBtn.innerHTML = `
					<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
						<path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" />
						<polyline points="14,2 14,8 20,8" />
					</svg>
				`;
				editorBtn.addEventListener('click', (e) => {
					e.preventDefault();
					cdnApp.fileEditor.show();
				});
				uploadBtn.parentNode.insertBefore(editorBtn, uploadBtn.nextSibling);
			}
		});

		// Loading Animation System
		class LoadingManager {
			constructor() {
				this.overlay = null;
				this.bar = null;
				this.pulse = null;
				this.isLoading = false;
				this.loadingQueue = new Set();
				this.activeOperations = new Map();
				this.init();
			}

			init() {
				// Create loading elements
				this.createElements();
				
				// Bind to existing heavy operations
				this.bindToExistingOperations();
				
				// Setup event listeners for dynamic operations
				this.setupEventListeners();
			}

			createElements() {
				// Create overlay
				this.overlay = document.createElement('div');
				this.overlay.className = 'loading-overlay';
				document.body.appendChild(this.overlay);

				// Create progress bar
				this.bar = document.createElement('div');
				this.bar.className = 'loading-bar';
				document.body.appendChild(this.bar);

				// Create pulse effect
				this.pulse = document.createElement('div');
				this.pulse.className = 'loading-pulse';
				document.body.appendChild(this.pulse);
			}

			start(operationId = 'default', options = {}) {
				const operation = {
					id: operationId,
					startTime: Date.now(),
					options: {
						showOverlay: true,
						dimContent: true,
						...options
					}
				};

				this.activeOperations.set(operationId, operation);
				this.loadingQueue.add(operationId);

				if (!this.isLoading) {
					this.show();
				}

				return operationId;
			}

			stop(operationId = 'default') {
				this.activeOperations.delete(operationId);
				this.loadingQueue.delete(operationId);

				if (this.loadingQueue.size === 0) {
					this.hide();
				}
			}

			show() {
				this.isLoading = true;
				
				// Show overlay with subtle backdrop
				if (this.overlay) {
					this.overlay.classList.add('active');
				}

				// Show progress bar
				if (this.bar) {
					this.bar.classList.add('active');
				}

				// Show pulse effect
				if (this.pulse) {
					this.pulse.classList.add('active');
				}

				// Dim content
				const mainContent = document.querySelector('.container');
				if (mainContent) {
					mainContent.classList.add('content-loading', 'dimmed');
				}

				// Add breathing effect to main elements
				const header = document.querySelector('.header');
				if (header) {
					header.classList.add('loading-breathe');
				}
			}

			hide() {
				// Complete the progress bar animation
				if (this.bar) {
					this.bar.classList.remove('active');
					this.bar.classList.add('complete');
				}

				// Wait for completion animation then hide everything
				setTimeout(() => {
					this.isLoading = false;

					// Hide overlay
					if (this.overlay) {
						this.overlay.classList.remove('active');
					}

					// Reset progress bar
					if (this.bar) {
						this.bar.classList.remove('complete');
					}

					// Hide pulse
					if (this.pulse) {
						this.pulse.classList.remove('active');
					}

					// Restore content
					const mainContent = document.querySelector('.container');
					if (mainContent) {
						mainContent.classList.remove('content-loading', 'dimmed');
					}

					// Remove breathing effect
					const header = document.querySelector('.header');
					if (header) {
						header.classList.remove('loading-breathe');
					}
				}, 300);
			}

			bindToExistingOperations() {
				// Bind to asset search operations
				const originalSearch = window.cdnApp?.assetSearch?.performSearch;
				if (originalSearch) {
					window.cdnApp.assetSearch.performSearch = async function(...args) {
						const loadingId = window.cdnApp.loading.start('asset-search');
						try {
							const result = await originalSearch.apply(this, args);
							return result;
						} finally {
							window.cdnApp.loading.stop(loadingId);
						}
					};
				}

				// Bind to file operations
				this.bindToFileOperations();
				
				// Bind to API calls
				this.bindToApiCalls();
			}

			bindToFileOperations() {
				if (window.cdnApp?.fileEditor) {
					const originalSave = window.cdnApp.fileEditor.saveChanges;
					if (originalSave) {
						window.cdnApp.fileEditor.saveChanges = async function(...args) {
							const loadingId = window.cdnApp.loading.start('file-save');
							try {
								const result = await originalSave.apply(this, args);
								return result;
							} finally {
								window.cdnApp.loading.stop(loadingId);
							}
						};
					}
				}
			}

			bindToApiCalls() {
				// Intercept fetch requests for heavy operations
				const originalFetch = window.fetch;
				window.fetch = async function(url, options = {}) {
					// Only show loading for certain endpoints
					const heavyEndpoints = ['/api/', '/upload', '/process', '/convert'];
					const isHeavyOperation = heavyEndpoints.some(endpoint => 
						typeof url === 'string' && url.includes(endpoint)
					);

					if (isHeavyOperation && !options.skipLoading) {
						const loadingId = window.cdnApp.loading.start('api-call');
						try {
							const result = await originalFetch(url, options);
							return result;
						} finally {
							window.cdnApp.loading.stop(loadingId);
						}
					}

					return originalFetch(url, options);
				};
			}

			setupEventListeners() {
				// Listen for custom loading events
				document.addEventListener('loading:start', (e) => {
					this.start(e.detail?.id || 'custom', e.detail?.options);
				});

				document.addEventListener('loading:stop', (e) => {
					this.stop(e.detail?.id || 'custom');
				});

				// Listen for page visibility changes
				document.addEventListener('visibilitychange', () => {
					if (document.hidden && this.isLoading) {
						// Pause animations when page is hidden for performance
						this.bar?.style.setProperty('animation-play-state', 'paused');
						this.pulse?.style.setProperty('animation-play-state', 'paused');
					} else if (!document.hidden && this.isLoading) {
						// Resume animations when page is visible
						this.bar?.style.setProperty('animation-play-state', 'running');
						this.pulse?.style.setProperty('animation-play-state', 'running');
					}
				});
			}

			// Utility methods for manual control
			async withLoading(operation, operationId = 'manual', options = {}) {
				const id = this.start(operationId, options);
				try {
					const result = await operation();
					return result;
				} finally {
					this.stop(id);
				}
			}

			// Simulate heavy operation (for demo purposes)
			simulateHeavyOperation(duration = 3000) {
				return new Promise(resolve => {
					const id = this.start('demo-operation');
					setTimeout(() => {
						this.stop(id);
						resolve();
					}, duration);
				});
			}
		}

		// Initialize loading manager after DOM is ready
		document.addEventListener('DOMContentLoaded', () => {
			// Wait for other systems to initialize first
			setTimeout(() => {
				window.cdnApp.loading = new LoadingManager();
				
				// Add demo button for testing (remove in production)
				if (window.location.search.includes('debug=1')) {
					const demoBtn = document.createElement('button');
					demoBtn.textContent = 'Test Loading';
					demoBtn.className = 'btn btn-secondary';
					demoBtn.style.cssText = 'position: fixed; top: 20px; right: 20px; z-index: 9999;';
					demoBtn.onclick = () => window.cdnApp.loading.simulateHeavyOperation();
					document.body.appendChild(demoBtn);
				}
			}, 100);
		});
		</script>
	</body>
</html>
